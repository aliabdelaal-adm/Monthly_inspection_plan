# دليل تحميل وتصدير المحلات من وإلى Excel
## Excel Import/Export Guide for Shop Management

## 📋 نظرة عامة / Overview

تم تفعيل أزرار تحميل وتصدير Excel بشكل حقيقي وذكي وفوري بنسبة 100% في نظام إدارة المحلات الكاملة في Smart Planner.

The Excel import and export buttons have been fully activated with intelligent, real-time functionality at 100% capability in the Complete Shop Management system in Smart Planner.

---

## ✨ الميزات الجديدة / New Features

### 1. 📥 تحميل من Excel (Import from Excel)

**الوظيفة الأساسية:**
- تحميل بيانات محلات جديدة من ملفات Excel خارجية
- دمجها مع جميع المحلات الموجودة حاليًا في النظام
- خيارات دمج متعددة: إضافة فقط، تحديث، أو استبدال كامل

**Basic Functionality:**
- Load new shop data from external Excel files
- Merge with all existing shops in the system
- Multiple merge options: Add only, Update, or Complete replacement

#### خيارات الدمج / Merge Options

##### 1. إضافة فقط (Add Only)
- إضافة المحلات الجديدة فقط
- تجاهل المحلات الموجودة مسبقًا (لا يتم تكرارها)
- الأمثل عند إضافة محلات جديدة دون تعديل البيانات الحالية

##### 2. تحديث الموجود (Update Existing)
- تحديث بيانات المحلات الموجودة بالبيانات الجديدة من Excel
- إضافة المحلات غير الموجودة
- الأمثل لتحديث معلومات المحلات الحالية

##### 3. استبدال كامل (Complete Replacement)
- حذف جميع المحلات الحالية
- استبدالها بالكامل بالبيانات الجديدة من Excel
- ⚠️ تحذير: هذا الخيار يحذف جميع البيانات الحالية

---

### 2. 📊 تصدير إلى Excel (Export to Excel)

**الوظيفة الأساسية:**
- تصدير جميع المحلات الحالية إلى ملف Excel
- تنسيق جاهز للتعديل وإعادة الاستيراد
- أعمدة منظمة مع عرض مناسب

**Basic Functionality:**
- Export all current shops to an Excel file
- Ready-to-edit format for re-importing
- Organized columns with appropriate widths

---

## 📄 هيكل ملف Excel المطلوب / Required Excel File Structure

### الأعمدة الإلزامية / Required Columns

| اسم العمود | Column Name | الوصف | Description |
|-----------|-------------|-------|-------------|
| اسم المحل | Shop Name | اسم المحل بالعربية | Shop name in Arabic |
| المنطقة | Area | المنطقة أو الموقع | Area or location |

### الأعمدة الاختيارية / Optional Columns

| اسم العمود | Column Name | الوصف | Description |
|-----------|-------------|-------|-------------|
| رقم الترخيص | License Number | رقم الترخيص التجاري | Trade license number |
| رقم التعريف | ID Number | رقم التعريف ADM | ADM identification number |
| العنوان | Address | العنوان التفصيلي | Detailed address |
| جهة الاتصال | Contact | رقم الهاتف أو البريد | Phone or email contact |
| النشاط | Activity | نوع النشاط التجاري | Type of business activity |

### أسماء بديلة للأعمدة / Alternative Column Names

النظام يدعم أسماء بديلة متعددة للأعمدة:

**اسم المحل:** `اسم المحل`, `name`, `shopName`, `الاسم`
**المنطقة:** `المنطقة`, `area`
**رقم الترخيص:** `رقم الترخيص`, `license`, `licenseNo`
**رقم التعريف:** `رقم التعريف`, `admCode`, `ADM`

---

## 🚀 كيفية الاستخدام / How to Use

### تحميل من Excel / Import from Excel

1. **فتح نظام Smart Planner**
   - افتح صفحة `smart-planner.html`
   - انتقل إلى تبويب "إدارة المحلات الكاملة"

2. **تسجيل الدخول**
   - يجب تسجيل الدخول بحساب المطور أولاً
   - الزر متاح فقط للمستخدمين المصرح لهم

3. **الضغط على زر "📥 تحميل من Excel"**
   - سيفتح نافذة اختيار الملف
   - اختر ملف Excel (.xlsx أو .xls)

4. **اختيار خيارات الدمج**
   - ستظهر نافذة مع خيارات الدمج الثلاثة
   - اقرأ وصف كل خيار بعناية
   - اختر الخيار المناسب لاحتياجاتك

5. **تأكيد التحميل**
   - اضغط على "✅ بدء التحميل"
   - انتظر حتى تظهر رسالة النجاح
   - ستحتوي الرسالة على تفاصيل العملية:
     - عدد المحلات المعالجة
     - عدد المحلات المضافة
     - عدد المحلات المحدثة
     - عدد المحلات المتجاهلة

6. **مراجعة النتائج**
   - سيتم تحديث قائمة المحلات تلقائيًا
   - راجع المحلات الجديدة في الجدول

### تصدير إلى Excel / Export to Excel

1. **فتح نظام Smart Planner**
   - افتح صفحة `smart-planner.html`
   - انتقل إلى تبويب "إدارة المحلات الكاملة"

2. **الضغط على زر "📊 تصدير Excel"**
   - لا حاجة لتسجيل الدخول للتصدير
   - سيتم تصدير جميع المحلات الحالية

3. **حفظ الملف**
   - سيتم تنزيل ملف Excel تلقائيًا
   - اسم الملف: `محلات_YYYY-MM-DD.xlsx`
   - يمكنك فتحه وتعديله في Excel أو Google Sheets

---

## 💡 أمثلة عملية / Practical Examples

### مثال 1: إضافة محلات جديدة

**السيناريو:** لديك ملف Excel يحتوي على 50 محل جديد تريد إضافتها

**الخطوات:**
1. جهز ملف Excel مع الأعمدة المطلوبة
2. افتح Smart Planner وسجل الدخول
3. اضغط على "📥 تحميل من Excel"
4. اختر الملف
5. اختر خيار "إضافة فقط"
6. اضغط "بدء التحميل"

**النتيجة:** سيتم إضافة 50 محل جديد دون التأثير على المحلات الحالية

---

### مثال 2: تحديث بيانات محلات موجودة

**السيناريو:** تريد تحديث أرقام الاتصال لمحلات موجودة

**الخطوات:**
1. صدّر المحلات الحالية إلى Excel
2. افتح الملف وعدل أرقام الاتصال
3. احفظ التعديلات
4. سجل الدخول في Smart Planner
5. اضغط على "📥 تحميل من Excel"
6. اختر الملف المعدل
7. اختر خيار "تحديث الموجود"
8. اضغط "بدء التحميل"

**النتيجة:** سيتم تحديث أرقام الاتصال للمحلات الموجودة

---

### مثال 3: تصدير وإعادة استيراد

**السيناريو:** تريد تعديل كمية كبيرة من البيانات في Excel

**الخطوات:**
1. اضغط على "📊 تصدير Excel"
2. افتح الملف في Excel
3. قم بجميع التعديلات المطلوبة
4. احفظ الملف
5. سجل الدخول في Smart Planner
6. اضغط على "📥 تحميل من Excel"
7. اختر الملف المعدل
8. اختر خيار "استبدال كامل"
9. اضغط "بدء التحميل"

**النتيجة:** جميع البيانات القديمة ستستبدل بالبيانات الجديدة من Excel

---

## ⚠️ ملاحظات مهمة / Important Notes

### للمطورين / For Developers

1. **تسجيل الدخول مطلوب للاستيراد فقط**
   - التصدير متاح للجميع
   - الاستيراد يتطلب صلاحيات المطور

2. **الحفظ التلقائي**
   - بعد الاستيراد الناجح، يتم حفظ البيانات تلقائيًا في GitHub
   - لا حاجة لحفظ يدوي إضافي

3. **معالجة الأخطاء**
   - النظام يتحقق من صحة البيانات قبل الاستيراد
   - رسائل خطأ واضحة في حالة وجود مشاكل

### للمستخدمين / For Users

1. **تحضير الملف**
   - تأكد من وجود الأعمدة الإلزامية
   - تأكد من عدم وجود صفوف فارغة
   - الصف الأول يجب أن يحتوي على العناوين

2. **النسخ الاحتياطي**
   - قبل استخدام "استبدال كامل"، صدّر البيانات الحالية كنسخة احتياطية
   - احتفظ بنسخ من الملفات المهمة

3. **التحقق من النتائج**
   - بعد الاستيراد، راجع قائمة المحلات
   - تأكد من صحة البيانات المستوردة

---

## 🔧 التقنيات المستخدمة / Technologies Used

- **SheetJS (xlsx):** مكتبة JavaScript لقراءة وكتابة ملفات Excel
- **File API:** لقراءة الملفات من جهاز المستخدم
- **Blob API:** لإنشاء ملفات Excel للتنزيل
- **Async/Await:** لمعالجة العمليات غير المتزامنة

---

## 📝 التحديثات المستقبلية / Future Updates

- [ ] دعم تنسيقات ملفات إضافية (CSV)
- [ ] معاينة البيانات قبل الاستيراد
- [ ] تصدير انتقائي (تصدير محلات محددة فقط)
- [ ] دعم القوالب (Templates)
- [ ] استيراد/تصدير الصور والملفات المرفقة

---

## 🆘 المساعدة والدعم / Help and Support

إذا واجهت أي مشاكل:

1. تأكد من أن ملف Excel يحتوي على الأعمدة الصحيحة
2. تحقق من رسالة الخطأ للحصول على تفاصيل
3. جرب التصدير أولاً لرؤية التنسيق الصحيح
4. راجع هذا الدليل للتعليمات التفصيلية

---

## ✅ قائمة التحقق السريعة / Quick Checklist

### قبل الاستيراد / Before Import:
- [ ] ملف Excel جاهز مع الأعمدة المطلوبة
- [ ] تم تسجيل الدخول كمطور
- [ ] تم إنشاء نسخة احتياطية (إذا لزم الأمر)
- [ ] تم اختيار خيار الدمج المناسب

### بعد الاستيراد / After Import:
- [ ] رسالة النجاح ظهرت
- [ ] تم مراجعة البيانات الجديدة
- [ ] البيانات المستوردة صحيحة
- [ ] تم الحفظ في النظام

---

**آخر تحديث:** 2025-10-19
**الإصدار:** 1.0.0

🎉 الميزة مفعلة بالكامل وجاهزة للاستخدام! / Feature fully activated and ready to use!

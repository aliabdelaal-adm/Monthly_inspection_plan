<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙˆØª - Audio Fix Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 700px;
            text-align: center;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            text-align: right;
        }
        
        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 20px 0;
            text-align: right;
        }
        
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 20px 0;
            text-align: right;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.2s;
        }
        
        button:hover {
            transform: scale(1.05);
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .log {
            background: #f5f5f5;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            text-align: right;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .maintenance-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }
        
        .maintenance-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
        }
        
        .maintenance-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }
        
        .close-btn {
            background: #f44336;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙˆØª</h1>
        <p class="subtitle">Audio Fix Test - Maintenance Mode Music</p>
        
        <div class="info-box">
            <strong>ğŸ“‹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©:</strong><br>
            âœ… Ø¥Ø²Ø§Ù„Ø© <code>autoplay muted</code> Ù…Ù† Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØª<br>
            âœ… Ø§Ù„ØµÙˆØª ÙŠØ¨Ø¯Ø£ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©<br>
            âœ… Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª: 15% (Ù‡Ø§Ø¯Ø¦ Ø¬Ø¯Ø§Ù‹)<br>
            âœ… Ù…Ø¯Ø© Ø§Ù„ØµÙˆØª: 20 Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ø¹ ØªÙ†ÙˆÙŠØ¹Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
        </div>
        
        <div class="success-box">
            <strong>âœ¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</strong><br>
            Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŒ ÙŠØ¬Ø¨ Ø£Ù†:<br>
            1ï¸âƒ£ ØªØ¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©<br>
            2ï¸âƒ£ ÙŠØ¨Ø¯Ø£ Ø§Ù„ØµÙˆØª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (Ø¨ØµÙˆØª Ù‡Ø§Ø¯Ø¦ Ø¬Ø¯Ø§Ù‹)<br>
            3ï¸âƒ£ Ø¥Ø°Ø§ Ù…Ù†Ø¹ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ÙŠØ¨Ø¯Ø£ Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø©
        </div>
        
        <button onclick="testMaintenanceMode()">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ø¹ Ø§Ù„ØµÙˆØª</button>
        <button onclick="checkAudioState()">ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØª</button>
        <button onclick="clearLog()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
        
        <div class="log" id="log"></div>
    </div>
    
    <!-- Maintenance Overlay -->
    <div class="maintenance-overlay" id="maintenanceOverlay">
        <div class="maintenance-content">
            <div class="maintenance-icon">ğŸ”§</div>
            <h2>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...</h2>
            <p>ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù†. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.</p>
            <p style="color: #666; font-size: 14px; margin-top: 20px;">
                ğŸµ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© (ØµÙˆØª Ù‡Ø§Ø¯Ø¦ Ø¬Ø¯Ø§Ù‹ - 15%)
            </p>
            <button class="close-btn" onclick="hideMaintenanceMode()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        </div>
    </div>
    
    <!-- Audio Element (same as in index.html after fix) -->
    <audio id="maintenanceAudio" loop preload="auto" style="display:none;">
        <source src="music.mp3" type="audio/mpeg">
        Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØµÙˆØªÙŠØ©.
    </audio>
    
    <script>
        let logEntries = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = `[${timestamp}] ${message}`;
            logEntries.push(entry);
            
            const logDiv = document.getElementById('log');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'log-entry';
            entryDiv.textContent = entry;
            logDiv.appendChild(entryDiv);
            logDiv.scrollTop = logDiv.scrollHeight;
            
            console.log(entry);
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
            logEntries = [];
            log('ğŸ—‘ï¸ Log cleared');
        }
        
        function testMaintenanceMode() {
            log('ğŸ”§ Starting maintenance mode test...');
            const overlay = document.getElementById('maintenanceOverlay');
            const audio = document.getElementById('maintenanceAudio');
            
            if (!overlay) {
                log('âŒ Overlay element not found!');
                return;
            }
            
            if (!audio) {
                log('âŒ Audio element not found!');
                return;
            }
            
            // Show overlay
            overlay.style.display = 'flex';
            log('âœ… Maintenance overlay displayed');
            
            // Reset audio to start from beginning
            audio.currentTime = 0;
            log('ğŸ”„ Audio reset to beginning');
            
            // Set volume to very quiet level (15%)
            audio.volume = 0.15;
            audio.muted = false;
            log('ğŸ”Š Volume set to 15% (very quiet)');
            
            // Ensure audio plays with enhanced error handling
            audio.play().then(() => {
                log('âœ… Audio playing successfully!');
                log('ğŸµ Volume: ' + audio.volume);
                log('ğŸµ Duration: ' + Math.floor(audio.duration / 60) + ' minutes');
            }).catch(err => {
                log('âš ï¸ Audio autoplay prevented by browser: ' + err.message);
                log('ğŸ”„ Trying alternative method...');
                
                // Alternative: Start muted, then unmute after a tiny delay
                audio.muted = true;
                audio.volume = 0.15;
                audio.play().then(() => {
                    log('âœ… Audio started (muted)');
                    // Successfully started muted, now unmute
                    setTimeout(() => {
                        audio.muted = false;
                        log('âœ… Audio unmuted! Playing at 15% volume');
                    }, 100);
                }).catch(e => {
                    log('âŒ Audio play failed even when muted: ' + e.message);
                    
                    // Check if audio file exists
                    fetch('music.mp3', { method: 'HEAD' })
                        .then(response => {
                            if (!response.ok) {
                                log('âŒ Audio file not found or inaccessible');
                            } else {
                                log('âœ… Audio file exists and is accessible');
                            }
                        })
                        .catch(fetchErr => log('âŒ Error checking audio file: ' + fetchErr.message));
                    
                    // Last resort: play on first user interaction
                    log('ğŸ“Œ Click anywhere to start audio playback');
                    const playOnInteraction = () => {
                        audio.muted = false;
                        audio.volume = 0.15;
                        audio.currentTime = 0;
                        audio.play()
                            .then(() => log('âœ… Audio started on user interaction'))
                            .catch(err2 => log('âŒ Audio play failed on interaction: ' + err2.message));
                        document.removeEventListener('click', playOnInteraction);
                        document.removeEventListener('touchstart', playOnInteraction);
                    };
                    document.addEventListener('click', playOnInteraction, { once: true });
                    document.addEventListener('touchstart', playOnInteraction, { once: true });
                });
            });
        }
        
        function hideMaintenanceMode() {
            log('ğŸ”§ Hiding maintenance mode...');
            const overlay = document.getElementById('maintenanceOverlay');
            const audio = document.getElementById('maintenanceAudio');
            
            if (overlay) {
                overlay.style.display = 'none';
                log('âœ… Maintenance overlay hidden');
            }
            
            // Stop and reset audio
            if (audio) {
                audio.pause();
                audio.currentTime = 0;
                log('â¸ï¸ Audio stopped and reset');
            }
        }
        
        function checkAudioState() {
            log('ğŸ” Checking audio state...');
            const audio = document.getElementById('maintenanceAudio');
            
            if (!audio) {
                log('âŒ Audio element not found!');
                return;
            }
            
            log('--- Audio State ---');
            log('ğŸ“Š Muted: ' + audio.muted);
            log('ğŸ“Š Volume: ' + audio.volume);
            log('ğŸ“Š Current Time: ' + audio.currentTime.toFixed(2) + 's');
            log('ğŸ“Š Duration: ' + (audio.duration ? (audio.duration / 60).toFixed(2) + ' minutes' : 'Unknown'));
            log('ğŸ“Š Paused: ' + audio.paused);
            log('ğŸ“Š ReadyState: ' + audio.readyState);
            log('ğŸ“Š NetworkState: ' + audio.networkState);
            log('ğŸ“Š Loop: ' + audio.loop);
            log('--- End State ---');
        }
        
        // Auto-log on page load
        window.addEventListener('load', () => {
            log('âœ… Page loaded successfully');
            log('â„¹ï¸ Audio element ready for testing');
            checkAudioState();
        });
    </script>
</body>
</html>

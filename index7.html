<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙØªØ´: Ø¯. Ø­ØµØ© Ø§Ù„Ø¹Ù„ÙŠ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Cache Prevention -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            direction: rtl;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: white;
            color: #667eea;
        }
        
        .search-section {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }
        
        .search-box {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-box input,
        .search-box select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            flex: 1;
            min-width: 200px;
        }
        
        .search-box button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .search-box button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .content {
            padding: 30px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
            opacity: 0.95;
        }
        
        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .stat-card.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stat-card.success {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .stat-card.info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stat-card.warning {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .stat-card.danger {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .stat-card.dark {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }
        
        .stat-card.light {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #234085;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: #e0e6f0;
            color: #234085;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .tab-btn:hover {
            background: #d0d6e0;
        }
        
        .tab-btn.active {
            background: #234085;
            color: white;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .report-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
        }
        
        .report-section h3 {
            color: #234085;
            margin-bottom: 15px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .report-filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .report-filters select,
        .report-filters input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 0.95em;
        }
        
        .report-filters button {
            padding: 10px 20px;
            background: #234085;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .report-filters button:hover {
            background: #1a2f60;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th,
        table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #dee2e6;
        }
        
        table th {
            background: #234085;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        table td {
            color: #333;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.1em;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .chart-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .chart-card h4 {
            color: #234085;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .chart-placeholder {
            height: 300px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1.1em;
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .export-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-btn.excel {
            background: #217346;
            color: white;
        }
        
        .export-btn.pdf {
            background: #dc3545;
            color: white;
        }
        
        .export-btn.print {
            background: #6c757d;
            color: white;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        @media print {
            .back-btn, .search-section, .export-buttons, .tabs {
                display: none;
            }
            
            .container {
                box-shadow: none;
            }
            
            .tab-content {
                display: block !important;
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .back-btn {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <h1>ğŸ‘¤ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙØªØ´: Ø¯. Ø­ØµØ© Ø§Ù„Ø¹Ù„ÙŠ</h1>
            <p>Ø¹Ø±Ø¶ Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</p>
        </div>
        
        <!-- Search Section -->
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="searchShop" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ù…Ø­Ù„...">
                <input type="date" id="searchDateFrom" placeholder="Ù…Ù† ØªØ§Ø±ÙŠØ®">
                <input type="date" id="searchDateTo" placeholder="Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®">
                <select id="searchArea">
                    <option value="">-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ --</option>
                </select>
                <button onclick="performSearch()">Ø¨Ø­Ø«</button>
                <button onclick="clearSearch()" style="background: #6c757d;">Ù…Ø³Ø­</button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="content">
            <!-- Statistics Cards -->
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card primary">
                    <h3>ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª</h3>
                    <div class="value" id="totalInspections">0</div>
                </div>
                
                <div class="stat-card success">
                    <h3>âœ… Ø§Ù„ØªÙØªÙŠØ´Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
                    <div class="value" id="pastInspections">0</div>
                </div>
                
                <div class="stat-card info">
                    <h3>ğŸ“… ØªÙØªÙŠØ´Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h3>
                    <div class="value" id="todayInspections">0</div>
                </div>
                
                <div class="stat-card warning">
                    <h3>ğŸ”œ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                    <div class="value" id="futureInspections">0</div>
                </div>
                
                <div class="stat-card danger">
                    <h3>ğŸª Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ù„Ø§Øª (Ù…ÙƒØ±Ø±Ø© + Ù…Ø®ØªÙ„ÙØ©)</h3>
                    <div class="value" id="totalShops">0</div>
                </div>
                
                <div class="stat-card dark">
                    <h3>ğŸª Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©</h3>
                    <div class="value" id="uniqueShops">0</div>
                </div>
                
                <div class="stat-card light">
                    <h3>ğŸ“ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØºØ·Ø§Ø©</h3>
                    <div class="value" id="coveredAreas">0</div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('reports')">ğŸ“‹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
                <button class="tab-btn" onclick="showTab('statistics')">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</button>
                <button class="tab-btn" onclick="showTab('smart')">ğŸ§  Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠØ©</button>
                <button class="tab-btn" onclick="showTab('analytics')">ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</button>
                <button class="tab-btn" onclick="showTab('shopDetails')">ğŸª ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø­Ù„Ø§Øª</button>
            </div>
            
            <!-- Reports Tab -->
            <div id="reportsTab" class="tab-content active">
                <div class="export-buttons">
                    <button class="export-btn excel" onclick="exportToExcel()">ğŸ“Š ØªØµØ¯ÙŠØ± Excel</button>
                    <button class="export-btn pdf" onclick="exportToPDF()">ğŸ“„ ØªØµØ¯ÙŠØ± PDF</button>
                    <button class="export-btn print" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
                    <div class="report-filters">
                        <input type="date" id="dailyReportDate">
                        <button onclick="generateDailyReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    </div>
                    <div id="dailyReportContent" class="table-container"></div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
                    <div class="report-filters">
                        <input type="week" id="weeklyReportWeek">
                        <button onclick="generateWeeklyReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    </div>
                    <div id="weeklyReportContent" class="table-container"></div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“† Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ</h3>
                    <div class="report-filters">
                        <input type="month" id="monthlyReportMonth">
                        <button onclick="generateMonthlyReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    </div>
                    <div id="monthlyReportContent" class="table-container"></div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“ˆ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</h3>
                    <div class="report-filters">
                        <select id="quarterReportYear">
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                        </select>
                        <select id="quarterReportQuarter">
                            <option value="1">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„ (ÙŠÙ†Ø§ÙŠØ± - Ù…Ø§Ø±Ø³)</option>
                            <option value="2">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø£Ø¨Ø±ÙŠÙ„ - ÙŠÙˆÙ†ÙŠÙˆ)</option>
                            <option value="3">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø« (ÙŠÙˆÙ„ÙŠÙˆ - Ø³Ø¨ØªÙ…Ø¨Ø±)</option>
                            <option value="4">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ (Ø£ÙƒØªÙˆØ¨Ø± - Ø¯ÙŠØ³Ù…Ø¨Ø±)</option>
                        </select>
                        <button onclick="generateQuarterlyReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    </div>
                    <div id="quarterlyReportContent" class="table-container"></div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ</h3>
                    <div class="report-filters">
                        <select id="annualReportYear">
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                        </select>
                        <button onclick="generateAnnualReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    </div>
                    <div id="annualReportContent" class="table-container"></div>
                </div>
            </div>
            
            <!-- Statistics Tab -->
            <div id="statisticsTab" class="tab-content">
                <div class="chart-container">
                    <h3>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</h3>
                    <div id="monthlyStatsChart" class="chart-placeholder">
                        Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù‡Ù†Ø§
                    </div>
                </div>
                
                <div class="table-container">
                    <h3 style="margin-bottom: 15px;">ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h3>
                    <div id="monthlyStatsTable"></div>
                </div>
            </div>
            
            <!-- Smart Statistics Tab -->
            <div id="smartTab" class="tab-content">
                <div class="analytics-grid">
                    <div class="chart-card">
                        <h4>ğŸ¯ Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºØ·ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</h4>
                        <div id="areaCoverageChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºØ·ÙŠØ©
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>ğŸ“Š ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…</h4>
                        <div id="dailyDistributionChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙŠÙˆÙ…ÙŠ
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>ğŸ† Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø­Ù„Ø§Øª ØªÙØªÙŠØ´Ø§Ù‹</h4>
                        <div id="topShopsChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± ØªÙØªÙŠØ´Ø§Ù‹
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>â±ï¸ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø©</h4>
                        <div id="shiftDistributionChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„ÙØªØ±Ø§Øª
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Analytics Tab -->
            <div id="analyticsTab" class="tab-content">
                <div class="analytics-grid">
                    <div class="chart-card">
                        <h4>ğŸ“ˆ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠ</h4>
                        <div id="monthlyTrendChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø´Ù‡Ø±ÙŠ
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>ğŸ”„ Ù…Ø¹Ø¯Ù„ ØªÙƒØ±Ø§Ø± Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ø­Ù„Ø§Øª</h4>
                        <div id="revisitRateChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø±
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>ğŸ¯ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ù‡Ø±ÙŠ</h4>
                        <div id="performanceChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø£Ø¯Ø§Ø¡
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø¹ Ø§Ù„Ø³Ù†ÙˆÙŠØ©</h4>
                        <div id="quarterComparisonChart" class="chart-placeholder">
                            Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                        </div>
                    </div>
                </div>
                
                <div class="table-container" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">ğŸ“‹ ØªØ­Ù„ÙŠÙ„ ØªÙØµÙŠÙ„ÙŠ Ù„ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø©</h3>
                    <div id="areaAnalysisTable"></div>
                </div>
            </div>
            
            <!-- Shop Details Tab -->
            <div id="shopDetailsTab" class="tab-content">
                <div class="report-section">
                    <h3>ğŸª ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø­Ù„Ø§Øª ÙˆØ¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØªÙØªÙŠØ´</h3>
                    <div class="report-filters">
                        <select id="shopDetailsPeriod" onchange="updateShopDetails()">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØªØ±Ø§Øª</option>
                            <option value="week">Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                            <option value="month">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</option>
                            <option value="q1">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„</option>
                            <option value="q2">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                            <option value="q3">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                            <option value="q4">Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <div id="shopDetailsTable"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Inspector name
        const INSPECTOR_NAME = 'Ø¯. Ø­ØµØ© Ø§Ù„Ø¹Ù„ÙŠ';
        
        // Global data
        let inspectionData = [];
        let filteredData = [];
        
        // Load data on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadInspectionData();
        });
        
        // Load inspection data from plan-data.json
        async function loadInspectionData() {
            try {
                const response = await fetch('plan-data.json');
                const data = await response.json();
                const allData = data.inspectionData || data;
                inspectionData = allData.filter(item => item.inspector === INSPECTOR_NAME);
                filteredData = inspectionData;
                
                // Populate areas dropdown
                populateAreas();
                
                // Calculate and display statistics
                updateStatistics();
                
                // Set default dates
                setDefaultDates();
                
                // Generate initial reports
                generateMonthlyReport();
                updateShopDetails();
            } catch (error) {
                console.error('Error loading inspection data:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }
        
        // Populate areas dropdown
        function populateAreas() {
            const areas = [...new Set(inspectionData.map(item => item.area))].sort();
            const areaSelect = document.getElementById('searchArea');
            
            areas.forEach(area => {
                const option = document.createElement('option');
                option.value = area;
                option.textContent = area;
                areaSelect.appendChild(option);
            });
        }
        
        // Set default dates
        function setDefaultDates() {
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            
            document.getElementById('dailyReportDate').value = todayStr;
            document.getElementById('monthlyReportMonth').value = today.toISOString().slice(0, 7);
            document.getElementById('quarterReportYear').value = today.getFullYear();
            document.getElementById('annualReportYear').value = today.getFullYear();
            
            // Set quarter based on current month
            const month = today.getMonth() + 1;
            const quarter = Math.ceil(month / 3);
            document.getElementById('quarterReportQuarter').value = quarter;
        }
        
        // Update statistics
        function updateStatistics() {
            const data = filteredData;
            const today = new Date().toISOString().split('T')[0];
            
            // Total inspections
            document.getElementById('totalInspections').textContent = data.length;
            
            // Past, today, and future inspections
            const past = data.filter(item => item.day < today).length;
            const todayCount = data.filter(item => item.day === today).length;
            const future = data.filter(item => item.day > today).length;
            
            document.getElementById('pastInspections').textContent = past;
            document.getElementById('todayInspections').textContent = todayCount;
            document.getElementById('futureInspections').textContent = future;
            
            // Total shops and unique shops
            let totalShopsCount = 0;
            const uniqueShopsSet = new Set();
            
            data.forEach(item => {
                if (item.shops && Array.isArray(item.shops)) {
                    totalShopsCount += item.shops.length;
                    item.shops.forEach(shop => uniqueShopsSet.add(shop));
                }
            });
            
            document.getElementById('totalShops').textContent = totalShopsCount;
            document.getElementById('uniqueShops').textContent = uniqueShopsSet.size;
            
            // Covered areas
            const areasSet = new Set(data.map(item => item.area));
            document.getElementById('coveredAreas').textContent = areasSet.size;
        }
        
        // Show tab
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            const tabMap = {
                'reports': 'reportsTab',
                'statistics': 'statisticsTab',
                'smart': 'smartTab',
                'analytics': 'analyticsTab',
                'shopDetails': 'shopDetailsTab'
            };
            
            document.getElementById(tabMap[tabName]).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
        
        // Perform search
        function performSearch() {
            const shopSearch = document.getElementById('searchShop').value.toLowerCase();
            const dateFrom = document.getElementById('searchDateFrom').value;
            const dateTo = document.getElementById('searchDateTo').value;
            const area = document.getElementById('searchArea').value;
            
            filteredData = inspectionData.filter(item => {
                // Shop name filter
                const shopMatch = !shopSearch || (item.shops && item.shops.some(shop => 
                    shop.toLowerCase().includes(shopSearch)
                ));
                
                // Date range filter
                const dateMatch = (!dateFrom || item.day >= dateFrom) && 
                                 (!dateTo || item.day <= dateTo);
                
                // Area filter
                const areaMatch = !area || item.area === area;
                
                return shopMatch && dateMatch && areaMatch;
            });
            
            updateStatistics();
            
            // Refresh current tab
            const activeTab = document.querySelector('.tab-btn.active');
            if (activeTab) {
                activeTab.click();
            }
        }
        
        // Clear search
        function clearSearch() {
            document.getElementById('searchShop').value = '';
            document.getElementById('searchDateFrom').value = '';
            document.getElementById('searchDateTo').value = '';
            document.getElementById('searchArea').value = '';
            
            filteredData = inspectionData;
            updateStatistics();
        }
        
        // Generate daily report
        function generateDailyReport() {
            const date = document.getElementById('dailyReportDate').value;
            if (!date) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®');
                return;
            }
            
            const dayData = filteredData.filter(item => item.day === date);
            
            if (dayData.length === 0) {
                document.getElementById('dailyReportContent').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØªÙŠØ´Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</div>';
                return;
            }
            
            let html = '<table><thead><tr><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th><th>Ø§Ù„Ù…Ø­Ù„Ø§Øª</th></tr></thead><tbody>';
            
            dayData.forEach(item => {
                const shops = item.shops && item.shops.length > 0 ? item.shops.join('ØŒ ') : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ù„Ø§Øª';
                html += `<tr>
                    <td>${item.shift}</td>
                    <td>${item.area}</td>
                    <td>${shops}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('dailyReportContent').innerHTML = html;
        }
        
        // Generate weekly report
        function generateWeeklyReport() {
            const weekInput = document.getElementById('weeklyReportWeek').value;
            if (!weekInput) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹');
                return;
            }
            
            // Parse week input (format: YYYY-Www)
            const [year, week] = weekInput.split('-W');
            const startDate = getDateOfISOWeek(parseInt(week), parseInt(year));
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + 6);
            
            const weekData = filteredData.filter(item => {
                const itemDate = new Date(item.day);
                return itemDate >= startDate && itemDate <= endDate;
            });
            
            if (weekData.length === 0) {
                document.getElementById('weeklyReportContent').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØªÙŠØ´Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>';
                return;
            }
            
            let html = '<table><thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª</th></tr></thead><tbody>';
            
            weekData.forEach(item => {
                const shopsCount = item.shops ? item.shops.length : 0;
                html += `<tr>
                    <td>${item.day}</td>
                    <td>${item.shift}</td>
                    <td>${item.area}</td>
                    <td>${shopsCount}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('weeklyReportContent').innerHTML = html;
        }
        
        // Generate monthly report
        function generateMonthlyReport() {
            const monthInput = document.getElementById('monthlyReportMonth').value;
            if (!monthInput) {
                return;
            }
            
            const [year, month] = monthInput.split('-');
            const monthData = filteredData.filter(item => {
                const itemDate = new Date(item.day);
                return itemDate.getFullYear() == year && (itemDate.getMonth() + 1) == month;
            });
            
            if (monthData.length === 0) {
                document.getElementById('monthlyReportContent').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØªÙŠØ´Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>';
                return;
            }
            
            // Group by date
            const groupedByDate = {};
            monthData.forEach(item => {
                if (!groupedByDate[item.day]) {
                    groupedByDate[item.day] = [];
                }
                groupedByDate[item.day].push(item);
            });
            
            let html = '<table><thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª</th><th>Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ù„Ø§Øª</th></tr></thead><tbody>';
            
            Object.keys(groupedByDate).sort().forEach(date => {
                const items = groupedByDate[date];
                const areas = [...new Set(items.map(i => i.area))].join('ØŒ ');
                let shopsCount = 0;
                items.forEach(i => {
                    if (i.shops) shopsCount += i.shops.length;
                });
                
                html += `<tr>
                    <td>${date}</td>
                    <td>${items.length}</td>
                    <td>${areas}</td>
                    <td>${shopsCount}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('monthlyReportContent').innerHTML = html;
        }
        
        // Generate quarterly report
        function generateQuarterlyReport() {
            const year = document.getElementById('quarterReportYear').value;
            const quarter = parseInt(document.getElementById('quarterReportQuarter').value);
            
            const startMonth = (quarter - 1) * 3 + 1;
            const endMonth = startMonth + 2;
            
            const quarterData = filteredData.filter(item => {
                const itemDate = new Date(item.day);
                const itemMonth = itemDate.getMonth() + 1;
                return itemDate.getFullYear() == year && itemMonth >= startMonth && itemMonth <= endMonth;
            });
            
            if (quarterData.length === 0) {
                document.getElementById('quarterlyReportContent').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØªÙŠØ´Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¨Ø¹</div>';
                return;
            }
            
            // Group by month
            const groupedByMonth = {};
            quarterData.forEach(item => {
                const month = new Date(item.day).getMonth() + 1;
                if (!groupedByMonth[month]) {
                    groupedByMonth[month] = [];
                }
                groupedByMonth[month].push(item);
            });
            
            let html = '<table><thead><tr><th>Ø§Ù„Ø´Ù‡Ø±</th><th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</th></tr></thead><tbody>';
            
            const monthNames = ['', 'ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
            
            Object.keys(groupedByMonth).sort().forEach(month => {
                const items = groupedByMonth[month];
                const areas = new Set(items.map(i => i.area)).size;
                let shopsCount = 0;
                items.forEach(i => {
                    if (i.shops) shopsCount += i.shops.length;
                });
                
                html += `<tr>
                    <td>${monthNames[month]}</td>
                    <td>${items.length}</td>
                    <td>${shopsCount}</td>
                    <td>${areas}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('quarterlyReportContent').innerHTML = html;
        }
        
        // Generate annual report
        function generateAnnualReport() {
            const year = document.getElementById('annualReportYear').value;
            
            const yearData = filteredData.filter(item => {
                const itemDate = new Date(item.day);
                return itemDate.getFullYear() == year;
            });
            
            if (yearData.length === 0) {
                document.getElementById('annualReportContent').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØªÙŠØ´Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…</div>';
                return;
            }
            
            // Group by quarter
            const groupedByQuarter = {1: [], 2: [], 3: [], 4: []};
            yearData.forEach(item => {
                const month = new Date(item.day).getMonth() + 1;
                const quarter = Math.ceil(month / 3);
                groupedByQuarter[quarter].push(item);
            });
            
            let html = '<table><thead><tr><th>Ø§Ù„Ø±Ø¨Ø¹</th><th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØªÙŠØ´Ø§Øª</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</th></tr></thead><tbody>';
            
            const quarterNames = {1: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„', 2: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ', 3: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«', 4: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹'};
            
            [1, 2, 3, 4].forEach(quarter => {
                const items = groupedByQuarter[quarter];
                const areas = new Set(items.map(i => i.area)).size;
                let shopsCount = 0;
                items.forEach(i => {
                    if (i.shops) shopsCount += i.shops.length;
                });
                
                html += `<tr>
                    <td>${quarterNames[quarter]}</td>
                    <td>${items.length}</td>
                    <td>${shopsCount}</td>
                    <td>${areas}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('annualReportContent').innerHTML = html;
        }
        
        // Update shop details
        function updateShopDetails() {
            const period = document.getElementById('shopDetailsPeriod').value;
            let data = filteredData;
            
            // Filter by period
            if (period !== 'all') {
                const today = new Date();
                let startDate, endDate;
                
                if (period === 'week') {
                    startDate = new Date(today);
                    startDate.setDate(today.getDate() - today.getDay());
                    endDate = new Date(startDate);
                    endDate.setDate(startDate.getDate() + 6);
                } else if (period === 'month') {
                    startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                } else if (period.startsWith('q')) {
                    const quarter = parseInt(period.slice(1));
                    const startMonth = (quarter - 1) * 3;
                    startDate = new Date(today.getFullYear(), startMonth, 1);
                    endDate = new Date(today.getFullYear(), startMonth + 3, 0);
                }
                
                if (startDate && endDate) {
                    data = data.filter(item => {
                        const itemDate = new Date(item.day);
                        return itemDate >= startDate && itemDate <= endDate;
                    });
                }
            }
            
            // Count inspections per shop
            const shopCounts = {};
            data.forEach(item => {
                if (item.shops && Array.isArray(item.shops)) {
                    item.shops.forEach(shop => {
                        if (!shopCounts[shop]) {
                            shopCounts[shop] = {
                                count: 0,
                                areas: new Set(),
                                dates: []
                            };
                        }
                        shopCounts[shop].count++;
                        shopCounts[shop].areas.add(item.area);
                        shopCounts[shop].dates.push(item.day);
                    });
                }
            });
            
            // Sort by count
            const sortedShops = Object.entries(shopCounts)
                .sort((a, b) => b[1].count - a[1].count);
            
            if (sortedShops.length === 0) {
                document.getElementById('shopDetailsTable').innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</div>';
                return;
            }
            
            let html = '<table><thead><tr><th>Ø§Ù„Ù…Ø­Ù„</th><th>Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØªÙØªÙŠØ´</th><th>Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</th><th>Ø¢Ø®Ø± ØªÙØªÙŠØ´</th></tr></thead><tbody>';
            
            sortedShops.forEach(([shop, info]) => {
                const areas = Array.from(info.areas).join('ØŒ ');
                const lastDate = info.dates.sort().reverse()[0];
                
                html += `<tr>
                    <td>${shop}</td>
                    <td>${info.count}</td>
                    <td>${areas}</td>
                    <td>${lastDate}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('shopDetailsTable').innerHTML = html;
        }
        
        // Helper function to get date from ISO week
        function getDateOfISOWeek(week, year) {
            const simple = new Date(year, 0, 1 + (week - 1) * 7);
            const dow = simple.getDay();
            const ISOweekStart = simple;
            if (dow <= 4)
                ISOweekStart.setDate(simple.getDate() - simple.getDay() + 1);
            else
                ISOweekStart.setDate(simple.getDate() + 8 - simple.getDay());
            return ISOweekStart;
        }
        
        // Export functions (placeholders - would need additional libraries for full implementation)
        function exportToExcel() {
            alert('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }
        
        function exportToPDF() {
            alert('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }
    </script>
</body>
</html>

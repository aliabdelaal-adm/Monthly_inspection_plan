# 📋 دليل إدارة المحلات الذكية الشامل

## نظرة عامة
تم تطوير نظام إدارة المحلات الذكية ليوفر واجهة شاملة واحترافية لإدارة جميع جوانب بيانات المحلات في نظام التفتيش الشهري. يتضمن النظام مجموعة كاملة من الأدوات الذكية التي تسهل عمليات الإضافة، التعديل، الحذف، والمزامنة مع GitHub.

---

## 🎯 كيفية الوصول

1. افتح صفحة **Smart Planner** (`smart-planner.html`)
2. انتقل إلى تبويب **"المحلات"**
3. اضغط على زر **"📋 قائمة المحلات الذكية"**

---

## ⚙️ الأزرار والوظائف

### 🔷 المجموعة الأولى: الإدارة الأساسية

#### 1. ➕ إضافة محل جديد
**الوظيفة:** فتح نموذج إضافة محل جديد مباشرة

**الاستخدام:**
1. اضغط على الزر
2. سيتم إغلاق نافذة القائمة الذكية تلقائياً
3. سيتم الانتقال إلى تبويب المحلات
4. سيفتح نموذج الإضافة تلقائياً

**الحقول المطلوبة:**
- اسم المحل (عربي) ✓
- المنطقة ✓
- الاسم بالإنجليزية
- رقم الترخيص
- العنوان
- رقم الهاتف
- البريد الإلكتروني
- موقع خرائط جوجل
- النشاط
- كود ADM

---

#### 2. ✏️ تعديل محلات متعددة
**الوظيفة:** تعديل جماعي لعدة محلات في نفس الوقت

**الاستخدام:**
1. حدد المحلات المراد تعديلها (باستخدام خانات الاختيار)
2. اضغط على الزر
3. اختر نوع التعديل:
   - **تحديث المنطقة لجميع المحلات**
   - **تحديث النشاط لجميع المحلات**
   - **إضافة نفس العنوان لجميع المحلات**
   - **تحديث رقم الترخيص بشكل جماعي**
   - **إضافة موقع خرائط جوجل لجميع المحلات**

**مثال عملي - ترقيم التراخيص:**
```
إدخال: CN كبادئة
إدخال: 1000 كرقم بداية
النتيجة: 
  محل 1 → CN-1000
  محل 2 → CN-1001
  محل 3 → CN-1002
```

**تحذير:** ⚠️ لا تنسَ المزامنة مع GitHub بعد التعديل!

---

#### 3. 🗑️ حذف محلات متعددة
**الوظيفة:** حذف عدة محلات دفعة واحدة

**الاستخدام:**
1. حدد المحلات المراد حذفها
2. اضغط على الزر
3. **تأكيد أول:** مراجعة قائمة المحلات
4. **تأكيد ثاني:** تأكيد نهائي قبل الحذف

**ملاحظات مهمة:**
- ⚠️ هذا الإجراء **لا يمكن التراجع عنه**
- يتم الحذف الفوري من الذاكرة
- يجب المزامنة مع GitHub لحفظ التغيير نهائياً

---

#### 4. 📥 استيراد من Excel
**الوظيفة:** استيراد بيانات المحلات من ملف Excel

**تنسيق الملف المطلوب:**
يجب أن يحتوي ملف Excel على الأعمدة التالية:

| العمود | اسم الحقل بالإنجليزية | مطلوب؟ |
|--------|---------------------|--------|
| اسم المحل | nameAr | ✓ |
| الاسم بالإنجليزية | nameEn | - |
| المنطقة | area | - |
| رقم الترخيص | licenseNo | - |
| العنوان | address | - |
| الهاتف | contact | - |
| النشاط | activity | - |
| كود ADM | admCode | - |
| موقع الخريطة | locationMap | - |

**خطوات الاستيراد:**
1. قم بتحضير ملف Excel بالأعمدة أعلاه
2. احفظ الملف بصيغة `.xlsx` أو `.xls`
3. اضغط على زر "📥 استيراد من Excel"
4. اختر الملف من جهازك
5. سيتم عرض نتائج الاستيراد:
   - ✅ عدد المحلات المستوردة
   - ⚠️ عدد المحلات المتجاهلة (مكررة أو غير صالحة)

**معالجة التكرارات:**
- إذا كان المحل موجوداً: سيطلب النظام التأكيد لاستبدال البيانات
- إذا رفضت الاستبدال: سيتم تجاهل المحل

---

### 🔷 المجموعة الثانية: الإدارة المتقدمة

#### 5. 🔄 دمج المحلات المكررة
**الوظيفة:** اكتشاف وإزالة التكرارات تلقائياً

**كيف يعمل؟**
1. يبحث النظام عن محلات متطابقة في الاسم
2. يقارن الأسماء بدون تحسس لحالة الأحرف والمسافات
3. يعرض قائمة بالتكرارات المكتشفة

**عملية الدمج:**
```
المحل الأصلي: محل الحيوانات الأليفة
المحل المكرر: محل الحيوانات الاليفة (بدون همزة)

النتيجة بعد الدمج:
- يتم الاحتفاظ بالمحل الأصلي
- يتم دمج البيانات الناقصة من المكرر
- يتم حذف المحل المكرر
```

**مثال عملي:**
```
قبل الدمج:
  محل 1: اسم = "محل السعادة"، ترخيص = "CN-123"، عنوان = ""
  محل 2: اسم = "محل السعاده"، ترخيص = ""، عنوان = "شارع الملك"

بعد الدمج:
  محل واحد: اسم = "محل السعادة"، ترخيص = "CN-123"، عنوان = "شارع الملك"
```

---

#### 6. ☁️ مزامنة مع GitHub
**الوظيفة:** حفظ جميع التغييرات في GitHub فوراً

**الاستخدام:**
1. اضغط على الزر
2. تأكيد المزامنة
3. انتظر حتى ينتهي الحفظ

**ما يتم حفظه؟**
- جميع بيانات المحلات في `shops_details.json`
- التغييرات تظهر فوراً على GitHub
- يمكن لجميع المستخدمين رؤية التحديثات

**رسالة الـ Commit:**
```
تحديث قائمة المحلات - [التاريخ والوقت]
```

**⚠️ متطلبات:**
- يجب تسجيل الدخول بـ GitHub Token أولاً
- التأكد من وجود صلاحيات الكتابة

---

#### 7. 🔄 تحديث البيانات
**الوظيفة:** إعادة تحميل أحدث نسخة من البيانات

**متى تستخدمه؟**
- بعد قيام مستخدم آخر بإجراء تحديثات
- عند الشك في عدم تطابق البيانات
- للتأكد من وجود أحدث نسخة

**ما يتم تحميله؟**
- `shops_details.json` - بيانات المحلات
- `plan-data.json` - بيانات الخطة والمناطق

**ملاحظة:** ⚠️ التحديث سيستبدل أي تعديلات غير محفوظة!

---

#### 8. 🔍 بحث متقدم
**الوظيفة:** بحث قوي متعدد المعايير

**أنواع البحث المتاحة:**
1. **البحث بالاسم** (عربي/إنجليزي)
2. **البحث برقم الترخيص**
3. **البحث بكود ADM**
4. **البحث بالنشاط**
5. **البحث بالعنوان**
6. **البحث برقم الهاتف**

**مثال استخدام:**
```
نوع البحث: النشاط
كلمة البحث: "حيوانات أليفة"

النتائج:
✅ تم العثور على 15 نتيجة:
• محل الحيوانات الأليفة
• محل السعادة للحيوانات
• متجر الحيوانات الأليفة
...
```

**حد النتائج:**
- يعرض أول 20 نتيجة
- إذا كان هناك المزيد، يعرض العدد الإجمالي

---

### 🔷 المجموعة الثالثة: النسخ والتصدير

#### 9. 💾 نسخة احتياطية
**الوظيفة:** إنشاء نسخة احتياطية كاملة JSON

**الاستخدام:**
1. اضغط على الزر
2. سيتم تنزيل ملف تلقائياً

**اسم الملف:**
```
shops_backup_2025-10-22T10-30-45.json
```

**محتويات النسخة:**
- جميع بيانات المحلات
- بصيغة JSON منسقة
- يمكن استخدامها لاستعادة البيانات لاحقاً

**استعادة البيانات:**
يمكنك استخدام ميزة "استيراد من Excel" بعد تحويل JSON إلى Excel

---

#### 10. 📊 تصدير Excel
**الوظيفة:** تصدير القائمة الحالية إلى ملف Excel

**ما يتم تصديره؟**
- جميع المحلات المعروضة حالياً (بعد تطبيق الفلاتر)
- الأعمدة:
  - الرقم
  - اسم المحل
  - الاسم بالإنجليزية
  - المنطقة
  - رقم الترخيص
  - كود ADM
  - العنوان
  - جهة الاتصال
  - النشاط
  - التقييم
  - آخر تفتيش
  - عدد التفتيشات

**اسم الملف:**
```
قائمة_المحلات_الذكية_2025-10-22.xlsx
```

**مميزات:**
- ✅ تنسيق احترافي
- ✅ عرض أعمدة مناسب
- ✅ يدعم العربية بشكل كامل

---

#### 11. 📄 تصدير PDF
**الوظيفة:** تصدير القائمة إلى ملف PDF للطباعة

**محتويات PDF:**
- عنوان التقرير
- تاريخ التصدير
- جدول المحلات
- إحصائيات (إجمالي المحلات)
- تذييل احترافي

**اسم الملف:**
```
Smart_Shop_List_2025-10-22.pdf
```

**مميزات:**
- ✅ جاهز للطباعة
- ✅ تنسيق أفقي (Landscape)
- ✅ دعم الأسماء العربية والإنجليزية

---

#### 12. 💾 تصدير JSON
**الوظيفة:** تصدير البيانات بصيغة JSON الخام

**الاستخدام:**
- للمطورين
- للنسخ الاحتياطي
- للتكامل مع أنظمة أخرى

**اسم الملف:**
```
smart-shop-list-2025-10-22.json
```

---

#### 13. 🖨️ طباعة
**الوظيفة:** طباعة القائمة مباشرة

**ما يتم طباعته؟**
- العنوان
- تاريخ ووقت الطباعة
- القائمة الكاملة بالتنسيق الحالي
- تذييل النظام

**مميزات:**
- ✅ معاينة قبل الطباعة
- ✅ تنسيق جاهز للطباعة
- ✅ يحترم إعدادات الطابعة

---

### 🔷 المجموعة الرابعة: العمليات الجماعية

#### 14. ☑️ تحديد الكل
**الوظيفة:** تحديد جميع المحلات في القائمة

**الاستخدام:**
1. اضغط على الزر
2. سيتم تحديد جميع المحلات تلقائياً
3. ستظهر رسالة تأكيد بالعدد

**متى تستخدمه؟**
- قبل عملية جماعية على كل المحلات
- لتصدير جميع المحلات
- لحساب إحصائيات شاملة

---

#### 15. ⬜ إلغاء التحديد
**الوظيفة:** إلغاء تحديد جميع المحلات

**الاستخدام:**
1. اضغط على الزر
2. سيتم إلغاء جميع التحديدات

**متى تستخدمه؟**
- للبدء من جديد في التحديد
- بعد إنهاء عملية جماعية

---

#### 16. ⭐ تحديد الأولوية العالية
**الوظيفة:** تحديد تلقائي للمحلات ذات الأولوية العالية

**معيار التحديد:**
- المحلات بتقييم أقل من 70%
- المحلات التي تحتاج تفتيش عاجل
- المحلات ذات بيانات ناقصة

**الاستخدام:**
1. اضغط على الزر
2. سيتم تحديد المحلات تلقائياً
3. يمكنك بعدها تطبيق عملية جماعية عليها

---

#### 17. 📤 تصدير المحدد
**الوظيفة:** تصدير المحلات المحددة فقط

**الاستخدام:**
1. حدد المحلات المطلوبة
2. اضغط على الزر
3. سيتم تنزيل ملف JSON

**اسم الملف:**
```
selected_shops_2025-10-22.json
```

**محتويات الملف:**
- فقط المحلات المحددة
- جميع البيانات كاملة

---

#### 18. ⚙️ عملية جماعية
**الوظيفة:** قائمة بعمليات إضافية متقدمة

**العمليات المتاحة:**

##### 1. تصدير المحدد إلى Excel
- ✅ تصدير المحلات المحددة فقط
- ✅ بتنسيق Excel احترافي

##### 2. طباعة قائمة المحدد
- ✅ طباعة المحلات المحددة فقط
- ✅ بتنسيق مبسط للطباعة

##### 3. نسخ أسماء المحدد
- ✅ نسخ أسماء المحلات إلى الحافظة
- ✅ كل محل في سطر منفصل
- ✅ يمكن لصقها في أي برنامج

##### 4. حساب إحصائيات المحدد
**الإحصائيات المعروضة:**
```
📊 إحصائيات المحلات المحددة

📈 إجمالي المحلات: 25
🔖 لديها ترخيص: 20
🔢 لديها كود ADM: 18
📞 لديها هاتف: 22
💼 لديها نشاط محدد: 24
🗺️ لديها موقع خرائط: 15
⭐ متوسط التقييم: 75.5%

📝 نسبة الاكتمال:
• الترخيص: 80.0%
• كود ADM: 72.0%
• الهاتف: 88.0%
• النشاط: 96.0%
• الموقع: 60.0%
```

##### 5. تطبيق تعديل جماعي
- ✅ نفس وظيفة زر "تعديل محلات متعددة"

---

## 📊 مؤشر المحلات المحددة

### العرض
يظهر صندوق إحصائي أخضر اللون عند تحديد أي محل:

```
┌──────────────────┐
│       25         │ ← عدد المحلات المحددة
│  محلات محددة     │
└──────────────────┘
```

### التحديث التلقائي
- يتحدث الصندوق تلقائياً مع كل تحديد/إلغاء تحديد
- يختفي الصندوق عند إلغاء جميع التحديدات

---

## 🎨 الإجراءات السريعة لكل محل

### في الجدول الرئيسي

كل محل في الجدول يحتوي على:

#### 1. خانة اختيار ☑️
- للتحديد/إلغاء التحديد
- تظهر بوضوح في أول عمود

#### 2. زر عرض التفاصيل 👁️
**الوظيفة:** عرض تفاصيل التقييم والبيانات الكاملة

**ما يعرضه؟**
```
📊 تفاصيل التقييم: محل الحيوانات الأليفة
==================================================

📈 التقييم الإجمالي: 85/100

تفاصيل المحاور:
• الالتزام: 25/30
• آخر تفتيش: 20/25
• تكرار التفتيش: 18/20
• اكتمال البيانات: 14/15
• أولوية النشاط: 8/10

📅 آخر تفتيش: 15/10/2025 (منذ 7 أيام)
🔢 عدد التفتيشات الكلية: 12

📍 معلومات المحل:
• رقم الرخصة: CN-1234
• كود ADM: ADM0001
• العنوان: شارع الملك فهد، حي الورود
• الهاتف: 0501234567
```

#### 3. زر تعديل ✏️
**الوظيفة:** تعديل بيانات المحل المحدد

**واجهة التعديل:**
```
📝 تعديل محل: محل الحيوانات الأليفة

1. الاسم بالعربية: محل الحيوانات الأليفة
2. الاسم بالإنجليزية: Animals Shop
3. المنطقة: الرياض
4. رقم الترخيص: CN-1234
5. كود ADM: ADM0001
6. العنوان: شارع الملك فهد
7. الهاتف: 0501234567
8. النشاط: بيع الحيوانات الأليفة
9. موقع الخرائط: موجود

أدخل رقم الحقل للتعديل (1-9) أو 0 للحفظ:
```

**ملاحظات:**
- ⚠️ لا يمكن تعديل الاسم الأساسي (يحتاج إضافة محل جديد)
- يمكن التعديل المتكرر حتى الانتهاء
- اضغط 0 للحفظ النهائي

#### 4. زر حذف 🗑️
**الوظيفة:** حذف المحل المحدد

**خطوات الحذف:**
1. عرض تفاصيل المحل للمراجعة
2. طلب تأكيد الحذف
3. الحذف الفوري

**رسالة التأكيد:**
```
⚠️ تأكيد حذف المحل

اسم المحل: محل الحيوانات الأليفة
المنطقة: الرياض
الترخيص: CN-1234

هذا الإجراء لا يمكن التراجع عنه!

هل أنت متأكد من الحذف؟
```

---

## 🎯 سيناريوهات الاستخدام العملية

### سيناريو 1: إضافة محلات جديدة من Excel

**الخطوات:**
1. قم بتحضير ملف Excel بالبيانات
2. افتح قائمة المحلات الذكية
3. اضغط على "📥 استيراد من Excel"
4. اختر الملف
5. راجع نتائج الاستيراد
6. اضغط على "☁️ مزامنة مع GitHub"

**النتيجة:**
✅ تم إضافة جميع المحلات وحفظها في GitHub

---

### سيناريو 2: تحديث المنطقة لمجموعة محلات

**الخطوات:**
1. افتح قائمة المحلات الذكية
2. حدد المحلات المطلوبة (أو استخدم "تحديد الكل")
3. اضغط على "✏️ تعديل محلات متعددة"
4. اختر "1" (تحديث المنطقة)
5. اختر المنطقة الجديدة من القائمة
6. تأكيد التحديث
7. اضغط على "☁️ مزامنة مع GitHub"

**النتيجة:**
✅ تم تحديث المنطقة لجميع المحلات المحددة

---

### سيناريو 3: البحث عن محل معين

**الخطوات:**
1. افتح قائمة المحلات الذكية
2. اضغط على "🔍 بحث متقدم"
3. اختر نوع البحث (مثلاً: الاسم)
4. أدخل كلمة البحث
5. راجع النتائج

**النتيجة:**
✅ عرض جميع المحلات المطابقة

---

### سيناريو 4: إزالة التكرارات

**الخطوات:**
1. افتح قائمة المحلات الذكية
2. اضغط على "🔄 دمج المحلات المكررة"
3. راجع قائمة التكرارات
4. تأكيد الدمج
5. اضغط على "☁️ مزامنة مع GitHub"

**النتيجة:**
✅ تم دمج جميع المحلات المكررة وحفظ التغييرات

---

### سيناريو 5: إنشاء تقرير لمحلات منطقة معينة

**الخطوات:**
1. افتح قائمة المحلات الذكية
2. استخدم فلتر "المنطقة" لاختيار منطقة محددة
3. اضغط على "📊 تصدير Excel"
4. احفظ الملف

**النتيجة:**
✅ ملف Excel يحتوي فقط على محلات المنطقة المحددة

---

### سيناريو 6: ترقيم تراخيص المحلات تلقائياً

**الخطوات:**
1. حدد المحلات التي تحتاج أرقام تراخيص
2. اضغط على "✏️ تعديل محلات متعددة"
3. اختر "4" (تحديث رقم الترخيص)
4. أدخل البادئة (مثلاً: CN)
5. أدخل رقم البداية (مثلاً: 1000)
6. تأكيد الترقيم
7. اضغط على "☁️ مزامنة مع GitHub"

**النتيجة:**
```
محل 1 → CN-1000
محل 2 → CN-1001
محل 3 → CN-1002
...
```

---

### سيناريو 7: حساب إحصائيات المحلات ذات الأولوية العالية

**الخطوات:**
1. اضغط على "⭐ تحديد الأولوية العالية"
2. اضغط على "⚙️ عملية جماعية"
3. اختر "4" (حساب إحصائيات المحدد)
4. راجع التقرير

**النتيجة:**
✅ تقرير مفصل بإحصائيات المحلات ذات الأولوية العالية

---

## ⚠️ تحذيرات وملاحظات مهمة

### 🔴 تحذيرات الحذف
1. **الحذف نهائي:** لا يمكن استرجاع المحلات المحذوفة
2. **النسخ الاحتياطي:** قم بإنشاء نسخة احتياطية قبل الحذف الجماعي
3. **المزامنة:** يجب المزامنة مع GitHub لحفظ الحذف نهائياً

### 🟡 تحذيرات التعديل
1. **المزامنة مطلوبة:** جميع التعديلات محلية حتى المزامنة
2. **عدم الاستبدال:** التعديل الجماعي يستبدل البيانات بدون رجعة
3. **المراجعة:** راجع التعديلات قبل الحفظ

### 🟢 نصائح عامة
1. **النسخ الاحتياطي المنتظم:** قم بإنشاء نسخ احتياطية بانتظام
2. **المزامنة الفورية:** زامن مع GitHub بعد كل تعديل مهم
3. **التحديث المنتظم:** حدّث البيانات قبل البدء بالعمل
4. **الفلترة الذكية:** استخدم الفلاتر لتضييق نطاق العمليات

---

## 🆘 حل المشاكل الشائعة

### مشكلة: "يجب تسجيل الدخول أولاً"
**الحل:**
1. انتقل إلى قسم تسجيل الدخول
2. أدخل GitHub Token
3. اضغط على "تسجيل الدخول"

### مشكلة: "فشل في المزامنة مع GitHub"
**الحل:**
1. تأكد من صحة GitHub Token
2. تأكد من وجود صلاحيات الكتابة
3. تحقق من اتصال الإنترنت
4. حاول مرة أخرى

### مشكلة: "لم يتم العثور على محلات"
**الحل:**
1. اضغط على "🔄 تحديث البيانات"
2. تحقق من الفلاتر المطبقة
3. تأكد من وجود بيانات في الملفات

### مشكلة: "خطأ في استيراد Excel"
**الحل:**
1. تأكد من تنسيق الملف (.xlsx أو .xls)
2. تحقق من أسماء الأعمدة
3. تأكد من وجود بيانات في الصفحة الأولى
4. تحقق من صحة الترميز (UTF-8)

---

## 📝 الخلاصة

نظام إدارة المحلات الذكية يوفر:

✅ **18 زراً ذكياً** لجميع العمليات المطلوبة
✅ **عمليات جماعية** لتوفير الوقت والجهد
✅ **مزامنة فورية** مع GitHub
✅ **واجهة احترافية** سهلة الاستخدام
✅ **تصدير متعدد** (Excel, PDF, JSON, طباعة)
✅ **بحث متقدم** متعدد المعايير
✅ **إحصائيات ذكية** وتقارير مفصلة
✅ **حماية من الأخطاء** بتأكيدات متعددة
✅ **دعم كامل للعربية** والإنجليزية

---

## 📞 الدعم

للحصول على مساعدة إضافية أو الإبلاغ عن مشاكل:
- افتح Issue في GitHub
- راجع الوثائق الأخرى في المستودع
- تواصل مع فريق التطوير

---

**تم التطوير بواسطة:** GitHub Copilot + د. علي عبدالعال
**آخر تحديث:** 2025-10-22
**الإصدار:** 1.0.0

---

## 🎓 فيديوهات تعليمية (قريباً)

سيتم إضافة فيديوهات تعليمية توضح:
- كيفية استخدام كل زر
- أمثلة عملية للعمليات الجماعية
- نصائح وحيل لتحسين الإنتاجية

---

**استمتع بإدارة محلاتك بطريقة ذكية واحترافية! 🎯**

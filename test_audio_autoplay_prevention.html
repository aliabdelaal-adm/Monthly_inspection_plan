<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار منع حجب الصوت التلقائي - Test Audio Autoplay Prevention</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        h2 {
            color: #764ba2;
            text-align: center;
            margin-bottom: 30px;
            font-size: 20px;
            font-weight: normal;
        }
        
        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h3 {
            color: #495057;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-indicator.playing {
            background: #28a745;
            animation: pulse 1.5s infinite;
        }
        
        .status-indicator.stopped {
            background: #dc3545;
        }
        
        .status-indicator.muted {
            background: #ffc107;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .audio-info {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .audio-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .audio-info-row:last-child {
            border-bottom: none;
        }
        
        .audio-info-label {
            font-weight: bold;
            color: #495057;
        }
        
        .audio-info-value {
            color: #6c757d;
        }
        
        /* Maintenance Overlay Simulation */
        #maintenanceOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(35, 54, 160, 0.95) 0%, rgba(21, 101, 192, 0.95) 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.5s ease;
        }
        
        #maintenanceOverlay.show {
            display: flex;
        }
        
        .maintenance-content {
            text-align: center;
            color: white;
            padding: 40px;
            max-width: 600px;
        }
        
        .maintenance-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        .maintenance-title {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .maintenance-subtitle {
            font-size: 24px;
            margin: 10px 0;
        }
        
        .maintenance-details {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 16px;
            line-height: 1.8;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .log {
            background: #2d3748;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .log-entry {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .log-entry.success {
            color: #00ff00;
        }
        
        .log-entry.error {
            color: #ff4444;
        }
        
        .log-entry.info {
            color: #00ffff;
        }
        
        .log-entry.warning {
            color: #ffaa00;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎵 اختبار منع حجب الصوت التلقائي</h1>
        <h2>Test Audio Autoplay Prevention</h2>
        
        <div class="info-box">
            <strong>الغرض من الاختبار / Test Purpose:</strong><br>
            التحقق من أن الصوت يبدأ تلقائياً عند ظهور رسالة الصيانة بدون حجب من المتصفح<br>
            Verify that audio starts automatically when maintenance message appears without browser blocking
        </div>
        
        <div class="test-section">
            <h3>
                <span class="status-indicator" id="audioStatus"></span>
                حالة الصوت الحالية / Current Audio Status
            </h3>
            <div class="audio-info">
                <div class="audio-info-row">
                    <span class="audio-info-label">حالة التشغيل / Playing:</span>
                    <span class="audio-info-value" id="playingStatus">--</span>
                </div>
                <div class="audio-info-row">
                    <span class="audio-info-label">حالة الكتم / Muted:</span>
                    <span class="audio-info-value" id="mutedStatus">--</span>
                </div>
                <div class="audio-info-row">
                    <span class="audio-info-label">مستوى الصوت / Volume:</span>
                    <span class="audio-info-value" id="volumeStatus">--</span>
                </div>
                <div class="audio-info-row">
                    <span class="audio-info-label">الوقت الحالي / Current Time:</span>
                    <span class="audio-info-value" id="timeStatus">--</span>
                </div>
                <div class="audio-info-row">
                    <span class="audio-info-label">الخاصية autoplay:</span>
                    <span class="audio-info-value" id="autoplayStatus">--</span>
                </div>
                <div class="audio-info-row">
                    <span class="audio-info-label">الخاصية loop:</span>
                    <span class="audio-info-value" id="loopStatus">--</span>
                </div>
            </div>
        </div>
        
        <div class="button-group">
            <button onclick="showMaintenance()">🚨 عرض رسالة الصيانة / Show Maintenance</button>
            <button onclick="hideMaintenance()">✅ إخفاء رسالة الصيانة / Hide Maintenance</button>
            <button onclick="checkAudioStatus()">🔍 فحص حالة الصوت / Check Audio Status</button>
        </div>
        
        <div class="success-box" id="successMessage" style="display: none;">
            ✅ نجح! الصوت يعمل تلقائياً بدون حجب من المتصفح<br>
            ✅ Success! Audio works automatically without browser blocking
        </div>
        
        <div class="warning-box" id="warningMessage" style="display: none;">
            ⚠️ تحذير: الصوت مكتوم أو لم يبدأ التشغيل<br>
            ⚠️ Warning: Audio is muted or hasn't started playing
        </div>
        
        <div class="log" id="logContainer">
            <div class="log-entry info">📝 سجل الأحداث / Event Log</div>
        </div>
    </div>
    
    <!-- Maintenance Overlay -->
    <div id="maintenanceOverlay">
        <div class="maintenance-content">
            <div class="maintenance-icon">🔧</div>
            <div class="maintenance-title">جاري التحديث</div>
            <div class="maintenance-subtitle">Update in Progress</div>
            <div class="maintenance-details">
                <strong>تفاصيل التحديث:</strong><br>
                جاري فحص البيانات والتأكد من سلامتها...<br>
                <br>
                يجب أن تسمع الموسيقى تلقائياً!<br>
                You should hear the music automatically!
            </div>
        </div>
    </div>
    
    <!-- Audio Element with autoplay, muted, and loop attributes -->
    <audio id="maintenanceAudio" autoplay muted loop preload="auto" style="display:none;">
        <source src="Classical-Music-for-Relaxation-Mozart-Bach-Tchaikovsky...-128Kbps-44KHz(mp3)1الجزء(4).mp3" type="audio/mpeg">
        متصفحك لا يدعم تشغيل الملفات الصوتية.
    </audio>
    
    <script>
        const audio = document.getElementById('maintenanceAudio');
        const overlay = document.getElementById('maintenanceOverlay');
        const logContainer = document.getElementById('logContainer');
        
        // Log function
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        // Update audio status display
        function updateAudioDisplay() {
            document.getElementById('playingStatus').textContent = audio.paused ? '❌ متوقف / Paused' : '▶️ يعمل / Playing';
            document.getElementById('mutedStatus').textContent = audio.muted ? '🔇 مكتوم / Muted' : '🔊 غير مكتوم / Unmuted';
            document.getElementById('volumeStatus').textContent = `${Math.round(audio.volume * 100)}%`;
            document.getElementById('timeStatus').textContent = `${audio.currentTime.toFixed(2)}s`;
            document.getElementById('autoplayStatus').textContent = audio.hasAttribute('autoplay') ? '✅ نعم / Yes' : '❌ لا / No';
            document.getElementById('loopStatus').textContent = audio.hasAttribute('loop') ? '✅ نعم / Yes' : '❌ لا / No';
            
            const statusIndicator = document.getElementById('audioStatus');
            if (!audio.paused && !audio.muted) {
                statusIndicator.className = 'status-indicator playing';
            } else if (!audio.paused && audio.muted) {
                statusIndicator.className = 'status-indicator muted';
            } else {
                statusIndicator.className = 'status-indicator stopped';
            }
        }
        
        // Check audio status
        function checkAudioStatus() {
            updateAudioDisplay();
            
            const successMsg = document.getElementById('successMessage');
            const warningMsg = document.getElementById('warningMessage');
            
            if (!audio.paused && !audio.muted && audio.volume > 0) {
                successMsg.style.display = 'block';
                warningMsg.style.display = 'none';
                log('✅ الصوت يعمل تلقائياً بشكل صحيح! / Audio is working automatically!', 'success');
            } else {
                successMsg.style.display = 'none';
                warningMsg.style.display = 'block';
                log('⚠️ الصوت لم يبدأ أو مكتوم / Audio not started or muted', 'warning');
            }
        }
        
        // Show maintenance mode
        function showMaintenance() {
            log('🚨 عرض رسالة الصيانة / Showing maintenance message', 'info');
            overlay.classList.add('show');
            
            // Unmute and adjust volume (audio is already autoplaying)
            if (audio) {
                audio.muted = false;
                audio.volume = 0.15;
                audio.currentTime = 0;
                
                log('🎵 إلغاء كتم الصوت وضبط مستوى الصوت / Unmuting audio and setting volume', 'success');
                
                setTimeout(() => {
                    updateAudioDisplay();
                    checkAudioStatus();
                }, 500);
            }
        }
        
        // Hide maintenance mode
        function hideMaintenance() {
            log('✅ إخفاء رسالة الصيانة / Hiding maintenance message', 'info');
            overlay.classList.remove('show');
            
            // Stop and mute audio
            if (audio) {
                audio.pause();
                audio.currentTime = 0;
                audio.muted = true;
                
                log('🔇 إيقاف وكتم الصوت / Stopping and muting audio', 'info');
                updateAudioDisplay();
            }
        }
        
        // Monitor audio events
        audio.addEventListener('play', () => {
            log('▶️ حدث: بدأ تشغيل الصوت / Event: Audio started playing', 'success');
            updateAudioDisplay();
        });
        
        audio.addEventListener('pause', () => {
            log('⏸️ حدث: توقف الصوت / Event: Audio paused', 'info');
            updateAudioDisplay();
        });
        
        audio.addEventListener('volumechange', () => {
            log(`🔊 حدث: تغير مستوى الصوت / Event: Volume changed to ${Math.round(audio.volume * 100)}%`, 'info');
            updateAudioDisplay();
        });
        
        // Initial status check
        window.addEventListener('load', () => {
            log('✅ تم تحميل الصفحة / Page loaded', 'success');
            log('🎵 الصوت يحتوي على الخصائص: autoplay, muted, loop', 'info');
            log('Audio has attributes: autoplay, muted, loop', 'info');
            
            setTimeout(() => {
                updateAudioDisplay();
                
                if (audio.hasAttribute('autoplay') && audio.hasAttribute('muted') && audio.hasAttribute('loop')) {
                    log('✅ الصوت مُعد بشكل صحيح لمنع الحجب / Audio is correctly configured to prevent blocking', 'success');
                } else {
                    log('❌ الصوت لا يحتوي على الخصائص المطلوبة / Audio missing required attributes', 'error');
                }
            }, 1000);
        });
        
        // Update display every second
        setInterval(updateAudioDisplay, 1000);
    </script>
</body>
</html>

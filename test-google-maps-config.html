<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒÙˆÙŠÙ† Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„ - Google Maps Configuration Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }
        
        .status-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .status-icon {
            font-size: 2em;
            margin-left: 15px;
            width: 50px;
            text-align: center;
        }
        
        .status-text {
            flex: 1;
        }
        
        .status-label {
            font-weight: bold;
            color: #2c3e50;
            display: block;
            margin-bottom: 5px;
        }
        
        .status-value {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .success {
            border-left-color: #27ae60;
        }
        
        .success .status-icon {
            color: #27ae60;
        }
        
        .error {
            border-left-color: #e74c3c;
        }
        
        .error .status-icon {
            color: #e74c3c;
        }
        
        .warning {
            border-left-color: #f39c12;
        }
        
        .warning .status-icon {
            color: #f39c12;
        }
        
        .map-container {
            height: 400px;
            margin: 20px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        #testMap {
            width: 100%;
            height: 100%;
        }
        
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .instructions h3 {
            color: #856404;
            margin-top: 0;
        }
        
        .instructions ol {
            margin: 10px 0;
            padding-right: 20px;
        }
        
        .instructions li {
            margin: 8px 0;
            color: #856404;
        }
        
        .console-log {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
        }
        
        .log-entry.success {
            color: #4ec9b0;
        }
        
        .log-entry.error {
            color: #f48771;
        }
        
        .log-entry.warning {
            color: #dcdcaa;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒÙˆÙŠÙ† Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„</h1>
        <h2 style="text-align: center; color: #7f8c8d; font-size: 1.2em;">Google Maps Configuration Test</h2>
        
        <div class="status-section">
            <h3 style="margin-top: 0;">ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„ØªÙƒÙˆÙŠÙ† / Configuration Status</h3>
            
            <div class="status-item" id="configLoadStatus">
                <div class="status-icon">â³</div>
                <div class="status-text">
                    <span class="status-label">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ† / Config File Load</span>
                    <span class="status-value">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... / Checking...</span>
                </div>
            </div>
            
            <div class="status-item" id="loaderStatus">
                <div class="status-icon">â³</div>
                <div class="status-text">
                    <span class="status-label">Ù…Ø­Ù…Ù„ Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„ / Google Maps Loader</span>
                    <span class="status-value">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... / Checking...</span>
                </div>
            </div>
            
            <div class="status-item" id="apiKeyStatus">
                <div class="status-icon">â³</div>
                <div class="status-text">
                    <span class="status-label">Ù…ÙØªØ§Ø­ API / API Key</span>
                    <span class="status-value">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... / Checking...</span>
                </div>
            </div>
            
            <div class="status-item" id="googleObjectStatus">
                <div class="status-icon">â³</div>
                <div class="status-text">
                    <span class="status-label">ÙƒØ§Ø¦Ù† Google Maps / Google Maps Object</span>
                    <span class="status-value">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... / Checking...</span>
                </div>
            </div>
            
            <div class="status-item" id="mapInitStatus">
                <div class="status-icon">â³</div>
                <div class="status-text">
                    <span class="status-label">ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© / Map Initialization</span>
                    <span class="status-value">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... / Checking...</span>
                </div>
            </div>
        </div>
        
        <div class="map-container">
            <div id="testMap"></div>
        </div>
        
        <div style="text-align: center;">
            <button class="btn" onclick="runTest()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± / Re-run Test</button>
            <button class="btn" onclick="location.reload()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© / Reload Page</button>
        </div>
        
        <div class="instructions">
            <h3>ğŸ“‹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions</h3>
            <p><strong>Ø¥Ø°Ø§ Ø±Ø£ÙŠØª Ø£Ø®Ø·Ø§Ø¡ØŒ Ø§ØªØ¨Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª:</strong></p>
            <p><strong>If you see errors, follow these steps:</strong></p>
            <ol>
                <li><strong>ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª:</strong>
                    <ul>
                        <li>google-maps-config.local.js</li>
                        <li>google-maps-config.js</li>
                        <li>google-maps-loader.js</li>
                    </ul>
                </li>
                <li><strong>Ø§ÙØªØ­ Ù…Ù„Ù google-maps-config.local.js ÙˆØ­Ø¯Ù‘Ø« Ù…ÙØªØ§Ø­ API</strong>
                    <br>Open google-maps-config.local.js and update the API key
                </li>
                <li><strong>Ø§Ø³ØªØ¨Ø¯Ù„ 'YOUR_NEW_API_KEY_FROM_GOOGLE_CLOUD' Ø¨Ù…ÙØªØ§Ø­ API Ø§Ù„ÙØ¹Ù„ÙŠ</strong>
                    <br>Replace 'YOUR_NEW_API_KEY_FROM_GOOGLE_CLOUD' with your actual API key
                </li>
                <li><strong>Ø§Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙˆØ­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø© (Ctrl+Shift+R)</strong>
                    <br>Save the file and hard refresh (Ctrl+Shift+R)
                </li>
            </ol>
        </div>
        
        <div class="console-log" id="consoleLog">
            <div class="log-entry">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… / System Log</div>
            <div class="log-entry">Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª... / Running tests...</div>
        </div>
    </div>
    
    <!-- Load Google Maps Configuration -->
    <script src="google-maps-config.local.js" onerror="logMessage('âš ï¸ No local Google Maps API key config found. Using default config.', 'warning')"></script>
    <script src="google-maps-config.js"></script>
    <script src="google-maps-loader.js"></script>
    
    <script>
        const logContainer = document.getElementById('consoleLog');
        
        function logMessage(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = message;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            if (type === 'success') {
                console.log('âœ…', message);
            } else if (type === 'error') {
                console.error('âŒ', message);
            } else if (type === 'warning') {
                console.warn('âš ï¸', message);
            } else {
                console.log('â„¹ï¸', message);
            }
        }
        
        function updateStatus(elementId, icon, text, type = 'success') {
            const element = document.getElementById(elementId);
            if (element) {
                element.className = `status-item ${type}`;
                element.querySelector('.status-icon').textContent = icon;
                element.querySelector('.status-value').textContent = text;
            }
        }
        
        function runTest() {
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
            logMessage('ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± / Starting test...', 'info');
            
            // Test 1: Check if GOOGLE_MAPS_CONFIG is loaded
            if (typeof GOOGLE_MAPS_CONFIG !== 'undefined') {
                updateStatus('configLoadStatus', 'âœ…', 'ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ / Loaded successfully', 'success');
                logMessage('âœ… GOOGLE_MAPS_CONFIG loaded successfully', 'success');
                logMessage('   API Key starts with: ' + (GOOGLE_MAPS_CONFIG.apiKey ? GOOGLE_MAPS_CONFIG.apiKey.substring(0, 10) + '...' : 'NOT SET'), 'info');
            } else {
                updateStatus('configLoadStatus', 'âŒ', 'ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ / Failed to load', 'error');
                logMessage('âŒ GOOGLE_MAPS_CONFIG not found!', 'error');
            }
            
            // Test 2: Check if googleMapsLoader is available
            if (typeof googleMapsLoader !== 'undefined' && typeof window.googleMapsLoader !== 'undefined') {
                updateStatus('loaderStatus', 'âœ…', 'Ù…ØªØ§Ø­ / Available', 'success');
                logMessage('âœ… googleMapsLoader is available', 'success');
                logMessage('   Loader status: ' + window.googleMapsLoader.getStatus(), 'info');
            } else {
                updateStatus('loaderStatus', 'âŒ', 'ØºÙŠØ± Ù…ØªØ§Ø­ / Not available', 'error');
                logMessage('âŒ googleMapsLoader not found!', 'error');
                logMessage('âš ï¸ Make sure google-maps-loader.js is loaded', 'warning');
            }
            
            // Test 3: Check API Key
            if (typeof GOOGLE_MAPS_CONFIG !== 'undefined' && GOOGLE_MAPS_CONFIG.apiKey) {
                const apiKey = GOOGLE_MAPS_CONFIG.apiKey;
                const placeholder = 'REPLACE_WITH_YOUR_GOOGLE_MAPS_API_KEY';
                const testPlaceholder = 'YOUR_NEW_API_KEY_FROM_GOOGLE_CLOUD';
                
                if (apiKey === placeholder || apiKey === testPlaceholder) {
                    updateStatus('apiKeyStatus', 'âš ï¸', 'ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­Ø¯ÙŠØ« / Needs update', 'warning');
                    logMessage('âš ï¸ API Key is still a placeholder!', 'warning');
                    logMessage('   Current value: [PLACEHOLDER - Please update]', 'warning');
                    logMessage('   Please update google-maps-config.local.js with your real API key', 'warning');
                } else if (apiKey.startsWith('AIza')) {
                    updateStatus('apiKeyStatus', 'âœ…', 'Ù…ÙÙƒÙˆÙ‘Ù† Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ / Configured', 'success');
                    logMessage('âœ… API Key format looks valid', 'success');
                    logMessage('   Key: ' + apiKey.substring(0, 6) + '***' + apiKey.substring(apiKey.length - 4), 'info');
                } else {
                    updateStatus('apiKeyStatus', 'âŒ', 'ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± ØµØ§Ù„Ø­ / Invalid format', 'error');
                    logMessage('âŒ API Key format appears invalid', 'error');
                    logMessage('   Google Maps API keys should start with "AIza"', 'error');
                }
            } else {
                updateStatus('apiKeyStatus', 'âŒ', 'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ / Not found', 'error');
                logMessage('âŒ API Key not found in configuration!', 'error');
            }
            
            // Test 4: Check if Google Maps object is available (with polling)
            let checkAttempts = 0;
            const maxCheckAttempts = 10;
            const checkInterval = 500; // Check every 500ms
            
            function checkGoogleMapsAvailability() {
                checkAttempts++;
                
                if (typeof google !== 'undefined' && typeof google.maps !== 'undefined') {
                    updateStatus('googleObjectStatus', 'âœ…', 'Ù…ØªØ§Ø­ / Available', 'success');
                    logMessage('âœ… Google Maps API loaded successfully!', 'success');
                    logMessage(`   Loaded after ${checkAttempts * checkInterval}ms`, 'info');
                    
                    // Test 5: Try to initialize map
                    try {
                        const mapElement = document.getElementById('testMap');
                        const map = new google.maps.Map(mapElement, {
                            center: { lat: 24.4539, lng: 54.3773 }, // Abu Dhabi
                            zoom: 12
                        });
                        
                        // Add marker
                        new google.maps.Marker({
                            position: { lat: 24.4539, lng: 54.3773 },
                            map: map,
                            title: 'Ø£Ø¨Ùˆ Ø¸Ø¨ÙŠ / Abu Dhabi'
                        });
                        
                        updateStatus('mapInitStatus', 'âœ…', 'Ù†Ø¬Ø­ / Success', 'success');
                        logMessage('âœ… Map initialized successfully!', 'success');
                        logMessage('âœ… Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!', 'success');
                        logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');
                        logMessage('ğŸ‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª! / All tests passed!', 'success');
                    } catch (error) {
                        updateStatus('mapInitStatus', 'âŒ', 'ÙØ´Ù„ / Failed', 'error');
                        logMessage('âŒ Failed to initialize map: ' + error.message, 'error');
                    }
                } else if (checkAttempts < maxCheckAttempts) {
                    // Continue polling
                    logMessage(`â³ Waiting for Google Maps API... (attempt ${checkAttempts}/${maxCheckAttempts})`, 'info');
                    setTimeout(checkGoogleMapsAvailability, checkInterval);
                } else {
                    // Max attempts reached
                    updateStatus('googleObjectStatus', 'âŒ', 'ØºÙŠØ± Ù…ØªØ§Ø­ / Not available', 'error');
                    updateStatus('mapInitStatus', 'âŒ', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± / Not tested', 'error');
                    logMessage('âŒ Google Maps API not loaded after ' + (maxCheckAttempts * checkInterval / 1000) + ' seconds!', 'error');
                    logMessage('âš ï¸ This could be due to:', 'warning');
                    logMessage('   1. Invalid API key', 'warning');
                    logMessage('   2. Billing not enabled in Google Cloud', 'warning');
                    logMessage('   3. Required APIs not enabled', 'warning');
                    logMessage('   4. Network connectivity issues', 'warning');
                }
            }
            
            // Start checking after initial delay
            setTimeout(checkGoogleMapsAvailability, checkInterval);
        }
        
        // Initialize Google Maps Loader on page load
        window.addEventListener('load', function() {
            logMessage('ğŸŒ Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø© / Page loaded', 'info');
            
            if (typeof window.googleMapsLoader !== 'undefined') {
                logMessage('ğŸ—ºï¸ Initializing Google Maps Loader...', 'info');
                window.googleMapsLoader.init()
                    .then(() => {
                        logMessage('âœ… Google Maps Loader initialized', 'success');
                        runTest();
                    })
                    .catch((error) => {
                        logMessage('âŒ Google Maps Loader failed: ' + error.message, 'error');
                        runTest();
                    });
            } else {
                logMessage('âš ï¸ Google Maps Loader not found, running basic test', 'warning');
                runTest();
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps API Key Tester | Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙØªØ§Ø­ Google Maps API</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .status-box {
            background: #f5f7fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
        }
        
        .status-box h2 {
            color: #2d3561;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: white;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .status-item:last-child {
            margin-bottom: 0;
        }
        
        .status-label {
            font-weight: 600;
            color: #555;
        }
        
        .status-value {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .status-value.loading {
            background: #fff3e0;
            color: #e65100;
        }
        
        .status-value.success {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .status-value.error {
            background: #ffebee;
            color: #c62828;
        }
        
        .status-value.warning {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .map-container {
            width: 100%;
            height: 400px;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #e0e0e0;
            margin-top: 20px;
        }
        
        #map {
            width: 100%;
            height: 100%;
        }
        
        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #1976d2;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #1565c0;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            padding-right: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            color: #424242;
        }
        
        .console-output {
            background: #263238;
            color: #4caf50;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .console-output div {
            margin-bottom: 5px;
        }
        
        .console-output .error {
            color: #f44336;
        }
        
        .console-output .warning {
            color: #ff9800;
        }
        
        .console-output .success {
            color: #4caf50;
        }
        
        .console-output .info {
            color: #2196f3;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .buttons {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ºï¸ Google Maps API Tester</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙØªØ§Ø­ Google Maps API</p>
        </div>
        
        <div class="content">
            <div class="status-box">
                <h2>ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</h2>
                <div class="status-item">
                    <span class="status-label">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ†</span>
                    <span id="configStatus" class="status-value loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">ØµØ­Ø© Ù…ÙØªØ§Ø­ API</span>
                    <span id="keyStatus" class="status-value loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">ØªØ­Ù…ÙŠÙ„ Google Maps</span>
                    <span id="mapsStatus" class="status-value loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</span>
                    <span id="displayStatus" class="status-value loading">â³ ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</span>
                </div>
            </div>
            
            <div class="instructions">
                <h3>ğŸ“ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</h3>
                <ul>
                    <li>Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø®Ø¶Ø±Ø§Ø¡ (âœ…)ØŒ ÙØ¥Ù† Ù…ÙØªØ§Ø­ API ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</li>
                    <li>Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ø£Ø®Ø·Ø§Ø¡ Ø­Ù…Ø±Ø§Ø¡ (âŒ)ØŒ Ø±Ø§Ø¬Ø¹ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø¬Ù„ Ø£Ø¯Ù†Ø§Ù‡</li>
                    <li>Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ APIØŒ Ø§ØªØ¨Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª ÙÙŠ Ù…Ù„Ù GOOGLE_MAPS_API_SETUP_GUIDE.md</li>
                    <li>ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙÙˆØªØ±Ø© ÙÙŠ Google Cloud Console</li>
                    <li>ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Maps JavaScript API Ùˆ Places API Ùˆ Geocoding API</li>
                </ul>
            </div>
            
            <div class="map-container">
                <div id="map"></div>
            </div>
            
            <div class="buttons">
                <button class="btn" onclick="retryTest()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
                <button class="btn" onclick="clearConsole()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
            </div>
            
            <div class="console-output" id="consoleOutput">
                <div class="info">ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>
            </div>
        </div>
    </div>
    
    <script src="google-maps-config.js"></script>
    <script src="google-maps-loader.js"></script>
    <script>
        const consoleOutput = document.getElementById('consoleOutput');
        let map = null;
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString('ar-SA')}] ${message}`;
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // Also log to browser console
            console.log(message);
        }
        
        function updateStatus(elementId, status, text) {
            const element = document.getElementById(elementId);
            element.className = 'status-value ' + status;
            element.textContent = text;
        }
        
        function clearConsole() {
            consoleOutput.innerHTML = '<div class="info">ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</div>';
        }
        
        function retryTest() {
            location.reload();
        }
        
        // Step 1: Check configuration file
        log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­', 'success');
        updateStatus('configStatus', 'success', 'âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„');
        
        // Step 2: Validate API key
        if (typeof GOOGLE_MAPS_CONFIG === 'undefined') {
            log('âŒ Ø®Ø·Ø£: Ù…Ù„Ù google-maps-config.js ØºÙŠØ± Ù…Ø­Ù…Ù„', 'error');
            updateStatus('keyStatus', 'error', 'âŒ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ† Ù…ÙÙ‚ÙˆØ¯');
        } else {
            const apiKey = GOOGLE_MAPS_CONFIG.apiKey;
            
            if (!apiKey || apiKey === 'YOUR_GOOGLE_MAPS_API_KEY_HERE') {
                log('âŒ Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ API', 'error');
                log('ğŸ“ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ« google-maps-config.js Ø¨Ù…ÙØªØ§Ø­ API ØµØ§Ù„Ø­', 'warning');
                log('ğŸ“– Ø±Ø§Ø¬Ø¹ GOOGLE_MAPS_API_SETUP_GUIDE.md Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª', 'info');
                updateStatus('keyStatus', 'error', 'âŒ Ù…ÙØªØ§Ø­ ØºÙŠØ± Ù…Ø¹ÙŠÙ†');
                updateStatus('mapsStatus', 'error', 'âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­Ù…ÙŠÙ„');
                updateStatus('displayStatus', 'error', 'âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø±Ø¶');
            } else {
                log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ API', 'success');
                updateStatus('keyStatus', 'success', 'âœ… Ù…ÙØªØ§Ø­ Ù…ÙˆØ¬ÙˆØ¯');
                
                // Step 3: Load Google Maps
                log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Google Maps API...', 'info');
                
                if (window.googleMapsLoader) {
                    googleMapsLoader.on('onLoad', () => {
                        log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Google Maps API Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                        updateStatus('mapsStatus', 'success', 'âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„');
                        
                        // Step 4: Create map
                        try {
                            log('ğŸ—ºï¸ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©...', 'info');
                            
                            map = new google.maps.Map(document.getElementById('map'), {
                                center: GOOGLE_MAPS_CONFIG.mapConfig.defaultCenter,
                                zoom: GOOGLE_MAPS_CONFIG.mapConfig.defaultZoom,
                                mapTypeControl: true,
                                streetViewControl: true,
                                zoomControl: true,
                                fullscreenControl: true
                            });
                            
                            // Add a marker
                            const marker = new google.maps.Marker({
                                position: GOOGLE_MAPS_CONFIG.mapConfig.defaultCenter,
                                map: map,
                                title: 'Abu Dhabi - Ø£Ø¨Ùˆ Ø¸Ø¨ÙŠ',
                                animation: google.maps.Animation.DROP
                            });
                            
                            // Add info window
                            const infoWindow = new google.maps.InfoWindow({
                                content: '<div style="text-align: center; padding: 10px;">' +
                                        '<h3>âœ… Ù†Ø¬Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</h3>' +
                                        '<p>Google Maps API ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</p>' +
                                        '</div>'
                            });
                            
                            marker.addListener('click', () => {
                                infoWindow.open(map, marker);
                            });
                            
                            // Auto-open info window
                            setTimeout(() => {
                                infoWindow.open(map, marker);
                            }, 500);
                            
                            log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                            updateStatus('displayStatus', 'success', 'âœ… ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                            
                            log('', 'success');
                            log('ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Google Maps API Ù…ÙƒÙˆÙ† Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'success');
                            log('âœ… ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®Ø±Ø§Ø¦Ø· ÙÙŠ Smart Planner', 'success');
                            
                        } catch (error) {
                            log('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©: ' + error.message, 'error');
                            updateStatus('displayStatus', 'error', 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶');
                        }
                    });
                    
                    googleMapsLoader.on('onError', (error) => {
                        log('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Google Maps API', 'error');
                        log('âŒ Ø§Ù„Ø®Ø·Ø£: ' + error.message, 'error');
                        updateStatus('mapsStatus', 'error', 'âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„');
                        updateStatus('displayStatus', 'error', 'âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø±Ø¶');
                        
                        if (error.message.includes('authentication') || error.message.includes('auth')) {
                            log('ğŸ’¡ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„: Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ù…ÙØªØ§Ø­ API', 'warning');
                            log('ğŸ“ ØªØ£ÙƒØ¯ Ù…Ù†:', 'info');
                            log('   1. Ù…ÙØªØ§Ø­ API ØµØ­ÙŠØ­ ÙˆØºÙŠØ± Ù…Ù†ØªÙ‡ÙŠ', 'info');
                            log('   2. ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙÙˆØªØ±Ø© ÙÙŠ Google Cloud', 'info');
                            log('   3. ØªÙ… ØªÙØ¹ÙŠÙ„ Maps JavaScript API', 'info');
                            log('   4. Ù‚ÙŠÙˆØ¯ Ø§Ù„Ù†Ø·Ø§Ù‚ ØªØ³Ù…Ø­ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'info');
                        }
                    });
                    
                    googleMapsLoader.on('onRetry', (data) => {
                        log(`ğŸ”„ Ù…Ø­Ø§ÙˆÙ„Ø© ${data.attempt}/${GOOGLE_MAPS_CONFIG.loading.maxRetryAttempts}...`, 'warning');
                        updateStatus('mapsStatus', 'warning', `â³ Ù…Ø­Ø§ÙˆÙ„Ø© ${data.attempt}...`);
                    });
                    
                    googleMapsLoader.init();
                } else {
                    log('âŒ Ø®Ø·Ø£: Google Maps Loader ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
                    updateStatus('mapsStatus', 'error', 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');
                }
            }
        }
    </script>
</body>
</html>

# دليل سريع - تحميل وتصدير Excel للمحلات
## Quick Guide - Shop Excel Import/Export

---

## 🎯 الوصول السريع / Quick Access

**الموقع:** صفحة Smart Planner → تبويب "إدارة المحلات الكاملة"

**الأزرار:**
- 📥 **تحميل من Excel** - استيراد محلات من ملف Excel
- 📊 **تصدير Excel** - تصدير المحلات إلى ملف Excel

---

## ⚡ استيراد سريع / Quick Import

### خطوات الاستيراد:
1. سجل الدخول ✓
2. اضغط "📥 تحميل من Excel"
3. اختر الملف
4. اختر خيار الدمج:
   - ✅ **إضافة فقط** - للمحلات الجديدة
   - 🔄 **تحديث الموجود** - لتحديث البيانات
   - ⚠️ **استبدال كامل** - لحذف واستبدال الكل
5. اضغط "بدء التحميل"

### متطلبات الملف:
- ✓ تنسيق: `.xlsx` أو `.xls`
- ✓ عمود "اسم المحل" (إلزامي)
- ✓ عمود "المنطقة" (إلزامي)
- ✓ أعمدة اختيارية: رقم الترخيص، رقم التعريف، العنوان، جهة الاتصال، النشاط

---

## ⚡ تصدير سريع / Quick Export

### خطوات التصدير:
1. اضغط "📊 تصدير Excel"
2. الملف سيتنزل تلقائيًا
3. اسم الملف: `محلات_YYYY-MM-DD.xlsx`

**ملاحظة:** لا حاجة لتسجيل الدخول للتصدير

---

## 📋 قالب Excel / Excel Template

### البنية المطلوبة:

| اسم المحل | المنطقة | رقم الترخيص | رقم التعريف | العنوان | جهة الاتصال | النشاط |
|-----------|---------|-------------|-------------|----------|-------------|---------|
| محل 1 | سوق الميناء | CN-12345 | ADM0001 | الميناء | 0501234567 | تجارة |
| محل 2 | الوثبة | CN-67890 | ADM0002 | الوثبة | 0509876543 | خدمات |

### أعمدة إلزامية:
- ✅ **اسم المحل**
- ✅ **المنطقة**

### أعمدة اختيارية:
- رقم الترخيص
- رقم التعريف
- العنوان
- جهة الاتصال
- النشاط

---

## 🎨 خيارات الدمج / Merge Options

### 1️⃣ إضافة فقط (Add Only)
```
الاستخدام: عند إضافة محلات جديدة
النتيجة: إضافة المحلات الجديدة + تجاهل المكرر
الأمان: ✅ آمن (لا يمس البيانات الحالية)
```

### 2️⃣ تحديث الموجود (Update Existing)
```
الاستخدام: عند تحديث معلومات محلات موجودة
النتيجة: تحديث المحلات الموجودة + إضافة الجديدة
الأمان: ⚠️ متوسط (يعدل البيانات الحالية)
```

### 3️⃣ استبدال كامل (Complete Replace)
```
الاستخدام: عند إعادة بناء قاعدة البيانات من الصفر
النتيجة: حذف الكل + استبدال بالبيانات الجديدة
الأمان: ⛔ حذر! (يحذف جميع البيانات الحالية)
```

---

## 💡 سيناريوهات شائعة / Common Scenarios

### 📝 السيناريو 1: إضافة محلات جديدة
```
1. جهز ملف Excel بالمحلات الجديدة
2. استخدم خيار "إضافة فقط"
3. النتيجة: محلات جديدة تضاف دون تكرار
```

### 🔄 السيناريو 2: تحديث أرقام الاتصال
```
1. صدّر المحلات الحالية
2. عدّل أرقام الاتصال في Excel
3. استورد مع خيار "تحديث الموجود"
4. النتيجة: أرقام الاتصال محدثة
```

### 🗂️ السيناريو 3: تنظيف وإعادة بناء
```
1. صدّر المحلات (نسخة احتياطية)
2. نظف وعدل البيانات في Excel
3. استورد مع خيار "استبدال كامل"
4. النتيجة: قاعدة بيانات نظيفة ومنظمة
```

---

## ⚠️ تحذيرات مهمة / Important Warnings

### 🔴 قبل استخدام "استبدال كامل":
```
1. ✓ تأكد من وجود نسخة احتياطية
2. ✓ راجع الملف مرتين قبل الاستيراد
3. ✓ تأكد أن الملف يحتوي على جميع المحلات المطلوبة
4. ✓ لا يمكن التراجع بعد الاستبدال
```

### 🟡 للحصول على أفضل النتائج:
```
1. ✓ استخدم قالب Excel المصدر من النظام
2. ✓ تأكد من عدم وجود صفوف فارغة
3. ✓ تحقق من صحة أسماء الأعمدة
4. ✓ جرب على عدد صغير من المحلات أولاً
```

---

## 🔧 استكشاف الأخطاء / Troubleshooting

### ❌ "الملف فارغ أو لا يحتوي على بيانات صالحة"
```
الحل:
- تأكد من وجود بيانات في الصفحة الأولى
- تأكد من وجود صف العناوين
- تحقق من صحة تنسيق الملف (.xlsx)
```

### ❌ "يرجى تسجيل الدخول أولاً"
```
الحل:
- سجل الدخول بحساب المطور
- تأكد من صلاحيات الوصول
- أعد تحميل الصفحة
```

### ❌ "خطأ في قراءة الملف"
```
الحل:
- تأكد من أن الملف غير تالف
- جرب حفظ الملف بتنسيق .xlsx مرة أخرى
- تأكد من عدم احتواء الملف على رموز غير صالحة
```

---

## 📊 إحصائيات ما بعد الاستيراد / Post-Import Statistics

بعد كل عملية استيراد، ستحصل على تقرير يحتوي على:

```
✅ المحلات المعالجة: XX
   (إجمالي الصفوف المقروءة من Excel)

➕ المحلات المضافة: XX
   (المحلات الجديدة التي تمت إضافتها)

🔄 المحلات المحدثة: XX
   (المحلات الموجودة التي تم تحديثها)

⏭️  المحلات المتجاهلة: XX
   (المحلات المكررة أو الصفوف الفارغة)
```

---

## 🎯 نصائح للكفاءة / Efficiency Tips

### ✨ للاستيراد الأمثل:
1. **استخدم التصدير كقالب**
   - صدّر المحلات الحالية
   - استخدم الملف كقالب للإضافات

2. **اختبر على عينة صغيرة**
   - جرب على 5-10 محلات أولاً
   - تأكد من النتائج قبل الاستيراد الكامل

3. **نظف البيانات قبل الاستيراد**
   - احذف الصفوف الفارغة
   - وحّد تنسيق المناطق
   - تأكد من عدم وجود مسافات زائدة

### ✨ للتصدير الأمثل:
1. **استخدم الفلاتر قبل التصدير**
   - اختر المحلات المطلوبة
   - صفّي حسب المنطقة إذا لزم الأمر

2. **اسم الملف تلقائي**
   - يحتوي على التاريخ
   - سهل التتبع والأرشفة

---

## 📞 للدعم / For Support

**الوثائق الكاملة:** راجع ملف `EXCEL_IMPORT_EXPORT_GUIDE.md`

**الأسئلة الشائعة:**
- ✓ هل يدعم النظام CSV؟ لا، حاليًا Excel فقط (.xlsx, .xls)
- ✓ هل يمكن التراجع عن الاستيراد؟ لا، لذا احتفظ بنسخة احتياطية
- ✓ ما الحد الأقصى لعدد المحلات؟ لا يوجد حد محدد
- ✓ هل يمكن استيراد الصور؟ لا، حاليًا نصوص فقط

---

## ✅ قائمة مراجعة سريعة / Quick Checklist

### قبل البدء:
- [ ] ملف Excel جاهز
- [ ] الأعمدة الإلزامية موجودة
- [ ] تم تسجيل الدخول (للاستيراد)
- [ ] نسخة احتياطية (إذا لزم الأمر)

### بعد الانتهاء:
- [ ] رسالة النجاح ظهرت
- [ ] مراجعة البيانات الجديدة
- [ ] التأكد من صحة البيانات
- [ ] الحفظ تم تلقائيًا

---

**🎉 الميزة مفعلة بالكامل وجاهزة للاستخدام!**

**آخر تحديث:** 2025-10-19  
**الإصدار:** 1.0.0

---

**للمزيد من التفاصيل، راجع:** `EXCEL_IMPORT_EXPORT_GUIDE.md`

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶ - ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #234085;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .test-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .test-title {
            font-size: 1.3em;
            color: #234085;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .test-item {
            padding: 12px;
            margin-bottom: 12px;
            background: white;
            border-radius: 6px;
        }
        
        .test-description {
            color: #666;
            font-size: 0.95em;
            margin-bottom: 10px;
        }
        
        .test-result {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 4px;
            background: #f0f0f0;
            margin-top: 8px;
        }
        
        .status-icon {
            font-size: 1.3em;
        }
        
        .pass {
            color: #28a745;
            background: #d4edda;
        }
        
        .fail {
            color: #dc3545;
            background: #f8d7da;
        }
        
        .info {
            color: #0056b3;
            background: #cce5ff;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Cairo', sans-serif;
            font-size: 1em;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102,126,234,0.3);
            transition: all 0.3s ease;
            margin-right: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .summary {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-radius: 10px;
            border: 2px solid #28a745;
        }
        
        .summary-title {
            font-size: 1.5em;
            color: #1b5e20;
            margin-bottom: 15px;
            text-align: center;
        }
        
        #groupReportsLoadingStatus {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶</h1>
        <p class="subtitle">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ - Group Inspection Reports</p>
        
        <div class="test-section">
            <div class="test-title">ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</div>
            <div class="test-item">
                <div class="test-description">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©:</div>
                <div id="environmentInfo"></div>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø§Ø¡ URL</div>
            <div class="test-item">
                <div class="test-description">Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø§Ø¡ URL Ù„Ù„Ù…Ù„Ù Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ¦Ø©:</div>
                <button class="btn" onclick="testUrlConstruction()">Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø§Ø¡ URL</button>
                <div id="urlTestResult"></div>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ‘ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶</div>
            <div class="test-item">
                <div class="test-description">
                    Ø§Ø®ØªØ¨Ø§Ø± ÙØªØ­ Ù…Ù„Ù PowerPoint Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Office Online Viewer:
                    <br><strong>Ø§Ù„Ù…Ù„Ù:</strong> emirate-zoo.pptx
                </div>
                <button class="btn" onclick="testViewReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (PowerPoint)</button>
                <button class="btn btn-secondary" onclick="testDirectOpen()">ÙØªØ­ Ù…Ø¨Ø§Ø´Ø±</button>
                <div id="groupReportsLoadingStatus"></div>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ†ÙÙŠØ°</div>
            <div class="test-item">
                <div class="test-description">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:</div>
                <div class="code-block" id="codePreview"></div>
            </div>
        </div>
        
        <div class="summary" style="display: none;" id="summarySection">
            <div class="summary-title">âœ… Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</div>
            <div id="summaryContent"></div>
        </div>
    </div>
    
    <script>
        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
        function displayEnvironmentInfo() {
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const info = `
                <div class="test-result info">
                    <strong>Hostname:</strong> ${window.location.hostname}<br>
                    <strong>Origin:</strong> ${window.location.origin}<br>
                    <strong>Pathname:</strong> ${window.location.pathname}<br>
                    <strong>Is Localhost:</strong> ${isLocalhost ? 'Ù†Ø¹Ù… (ØªØ·ÙˆÙŠØ± Ù…Ø­Ù„ÙŠ)' : 'Ù„Ø§ (Ø§Ø³ØªØ¶Ø§ÙØ©/GitHub Pages)'}
                </div>
            `;
            document.getElementById('environmentInfo').innerHTML = info;
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø§Ø¡ URL
        function testUrlConstruction() {
            const filePath = 'files/group_inspection_reports/emirate-zoo.pptx';
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            let fileUrl;
            if (isLocalhost) {
                fileUrl = `./${filePath}`;
            } else {
                const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '');
                fileUrl = `${baseUrl}/${filePath}`;
            }
            
            const viewerUrl = `https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(fileUrl)}`;
            
            const result = `
                <div class="test-result pass">
                    <span class="status-icon">âœ…</span>
                    <div>
                        <strong>Ù†Ø¬Ø­ Ø¨Ù†Ø§Ø¡ URL</strong><br>
                        <small><strong>File URL:</strong> ${fileUrl}</small><br>
                        <small><strong>Viewer URL:</strong> <a href="${viewerUrl}" target="_blank" style="color: #0056b3; text-decoration: underline;">Ø§Ù†Ù‚Ø± Ù‡Ù†Ø§ Ù„ÙØªØ­</a></small>
                    </div>
                </div>
            `;
            document.getElementById('urlTestResult').innerHTML = result;
        }
        
        // Ù†Ø³Ø® Ø¯Ø§Ù„Ø© viewGroupReport Ù…Ù† index.html Ø§Ù„Ù…Ø­Ø¯Ø«
        async function viewGroupReport(filePath, fileName, fileType) {
            const statusDiv = document.getElementById('groupReportsLoadingStatus');
            
            try {
                statusDiv.textContent = 'â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ø¹Ø±Ø¶...';
                statusDiv.style.color = '#666';
                statusDiv.style.background = '#f0f0f0';
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ÙˆÙØªØ­Ù‡ Ø¨Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                const lowerFileType = fileType.toLowerCase();
                
                // Ø¨Ù†Ø§Ø¡ URL Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ù„Ù
                let fileUrl;
                const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                
                if (isLocalhost) {
                    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø­Ù„ÙŠØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù†Ø³Ø¨ÙŠ
                    fileUrl = `./${filePath}`;
                } else {
                    // ÙÙŠ Ø­Ø§Ù„Ø© GitHub Pages Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©ØŒ Ø§Ø³ØªØ®Ø¯Ù… URL Ø§Ù„ÙƒØ§Ù…Ù„
                    const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '');
                    fileUrl = `${baseUrl}/${filePath}`;
                }
                
                if (lowerFileType === 'pdf') {
                    // ÙØªØ­ PDF ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯
                    window.open(fileUrl, '_blank', 'noopener,noreferrer');
                    statusDiv.textContent = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯';
                    statusDiv.style.color = '#28a745';
                    statusDiv.style.background = '#d4edda';
                } else if (['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(lowerFileType)) {
                    // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯
                    window.open(fileUrl, '_blank', 'noopener,noreferrer');
                    statusDiv.textContent = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯';
                    statusDiv.style.color = '#28a745';
                    statusDiv.style.background = '#d4edda';
                } else if (['xlsx', 'xls', 'docx', 'doc', 'pptx', 'ppt'].includes(lowerFileType)) {
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Office Online Viewer Ù„Ù…Ù„ÙØ§Øª Office
                    const viewerUrl = `https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(fileUrl)}`;
                    const newWindow = window.open(viewerUrl, '_blank', 'noopener,noreferrer');
                    
                    if (newWindow) {
                        statusDiv.textContent = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ Ø¹Ø§Ø±Ø¶ Office';
                        statusDiv.style.color = '#28a745';
                        statusDiv.style.background = '#d4edda';
                    } else {
                        // Ø¥Ø°Ø§ ÙØ´Ù„ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© (Ø¨Ø³Ø¨Ø¨ Ø­Ø¸Ø± Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©)
                        statusDiv.innerHTML = `âš ï¸ ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©. <a href="${viewerUrl}" target="_blank" style="color: #667eea; text-decoration: underline;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„ÙØªØ­ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</a>`;
                        statusDiv.style.color = '#ff9800';
                        statusDiv.style.background = '#fff3cd';
                    }
                } else {
                    // Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ØŒ Ø§ÙØªØ­Ù‡Ø§ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯
                    window.open(fileUrl, '_blank', 'noopener,noreferrer');
                    statusDiv.textContent = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù„Ù ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯';
                    statusDiv.style.color = '#28a745';
                    statusDiv.style.background = '#d4edda';
                }
                
                setTimeout(() => {
                    statusDiv.textContent = '';
                    statusDiv.style.background = '';
                }, 5000);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:', error);
                statusDiv.textContent = 'âŒ ÙØ´Ù„ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± - ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„';
                statusDiv.style.color = '#dc3545';
                statusDiv.style.background = '#f8d7da';
                
                setTimeout(() => {
                    statusDiv.textContent = '';
                    statusDiv.style.background = '';
                }, 5000);
            }
        }
        
        // Ø§Ø®ØªØ¨Ø§Ø± ÙØªØ­ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        function testViewReport() {
            const filePath = 'files/group_inspection_reports/emirate-zoo.pptx';
            const fileName = 'emirate-zoo.pptx';
            const fileType = 'pptx';
            
            viewGroupReport(filePath, fileName, fileType);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù„Ø®Øµ
            setTimeout(() => {
                showSummary();
            }, 1000);
        }
        
        // ÙØªØ­ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ù„Ù
        function testDirectOpen() {
            const filePath = 'files/group_inspection_reports/emirate-zoo.pptx';
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            let fileUrl;
            if (isLocalhost) {
                fileUrl = `./${filePath}`;
            } else {
                const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '');
                fileUrl = `${baseUrl}/${filePath}`;
            }
            
            window.open(fileUrl, '_blank', 'noopener,noreferrer');
            
            const statusDiv = document.getElementById('groupReportsLoadingStatus');
            statusDiv.textContent = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø© (Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡)';
            statusDiv.style.color = '#0056b3';
            statusDiv.style.background = '#cce5ff';
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ¯
        function displayCode() {
            const code = `async function viewGroupReport(filePath, fileName, fileType) {
    // Ø¨Ù†Ø§Ø¡ URL Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ù„Ù
    let fileUrl;
    const isLocalhost = window.location.hostname === 'localhost' 
                     || window.location.hostname === '127.0.0.1';
    
    if (isLocalhost) {
        fileUrl = \`./\${filePath}\`;
    } else {
        const baseUrl = window.location.origin 
                      + window.location.pathname.replace(/\\/[^\\/]*$/, '');
        fileUrl = \`\${baseUrl}/\${filePath}\`;
    }
    
    // Ù„Ù„Ù…Ù„ÙØ§Øª Office: Ø§Ø³ØªØ®Ø¯Ø§Ù… Office Online Viewer
    if (['xlsx', 'xls', 'docx', 'doc', 'pptx', 'ppt'].includes(fileType)) {
        const viewerUrl = 
            \`https://view.officeapps.live.com/op/view.aspx?src=\${encodeURIComponent(fileUrl)}\`;
        window.open(viewerUrl, '_blank', 'noopener,noreferrer');
    }
}`;
            document.getElementById('codePreview').textContent = code;
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø®Øµ
        function showSummary() {
            const summary = `
                <div class="test-item">
                    <strong>Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:</strong>
                    <ul style="margin: 10px 0; padding-right: 20px;">
                        <li>ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø¨Ù†Ø§Ø¡ URL Ù„ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø·Ù„Ù‚ ÙÙŠ GitHub Pages</li>
                        <li>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©</li>
                        <li>ØªÙ… ØªØ­Ø³ÙŠÙ† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…</li>
                    </ul>
                    <strong>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</strong>
                    <ul style="margin: 10px 0; padding-right: 20px;">
                        <li>âœ… Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶ ÙŠÙØªØ­ Ø§Ù„Ù…Ù„Ù ÙÙŠ Office Online Viewer Ø¨Ù†Ø¬Ø§Ø­</li>
                        <li>âœ… Ø¹Ø¯Ù… Ø¸Ù‡ÙˆØ± Ø±Ø³Ø§Ù„Ø© "Ù„Ø§ ÙŠÙ…ÙƒÙ† ÙØªØ­ Ø§Ù„ØµÙØ­Ø©"</li>
                        <li>âœ… ØªÙˆÙÙŠØ± Ø¨Ø¯ÙŠÙ„ ÙÙŠ Ø­Ø§Ù„Ø© Ø­Ø¸Ø± Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©</li>
                    </ul>
                </div>
            `;
            document.getElementById('summaryContent').innerHTML = summary;
            document.getElementById('summarySection').style.display = 'block';
        }
        
        // ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            displayEnvironmentInfo();
            displayCode();
        };
    </script>
</body>
</html>

<!DOCTYPE html>
<!-- Version 2.0.0 - Group Inspection Report with Visit Report Layout -->
<!-- Last Updated: 2025-11-21 -->
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ø¬Ù…Ø§Ø¹Ù‰</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Cache Prevention -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
        }
        
        .inspection-fullscreen-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-y: auto;
            overflow-x: hidden;
            direction: rtl;
        }
        
        .inspection-header {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            padding: 30px 40px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .return-home-btn {
            position: absolute;
            top: 50%;
            left: 30px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .return-home-btn:hover {
            background: white;
            color: #ff9800;
            transform: translateY(-50%) scale(1.05);
        }
        
        .inspection-title {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .inspection-subtitle {
            font-size: 1.2em;
            margin: 0;
            opacity: 0.9;
        }
        
        .inspection-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 30px;
        }
        
        .details-card,
        .form-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .details-card:hover,
        .form-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .section-header {
            color: #ff9800;
            font-size: 1.8em;
            margin: 0 0 25px 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 3px solid #ff9800;
            padding-bottom: 15px;
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-radius: 15px;
        }
        
        .details-grid > div {
            font-size: 1.1em;
        }
        
        .details-grid strong {
            color: #e65100;
            font-weight: 700;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #333;
            font-size: 1.1em;
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1em;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: #ff9800;
            background: white;
            box-shadow: 0 0 0 4px rgba(255, 152, 0, 0.1);
        }
        
        .form-input[readonly] {
            background: #f5f5f5;
            cursor: not-allowed;
        }
        
        .password-toggle-btn {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.3em;
            padding: 5px;
            transition: transform 0.2s ease;
        }
        
        .password-toggle-btn:hover {
            transform: translateY(-50%) scale(1.2);
        }
        
        .verify-password-btn {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }
        
        .verify-password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
        }
        
        .password-status-success {
            padding: 15px;
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
        }
        
        .password-status-error {
            padding: 15px;
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
        }
        
        .checklist-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }
        
        .checklist-item-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .checklist-item-card:hover {
            border-color: #ff9800;
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.2);
        }
        
        .checklist-item-header {
            font-weight: 700;
            color: #e65100;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px 12px;
            border-radius: 10px;
            background: white;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .radio-option:hover {
            border-color: #ff9800;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-left: 8px;
            cursor: pointer;
        }
        
        .radio-option input[type="radio"]:checked + .radio-label {
            font-weight: 700;
        }
        
        .radio-label {
            cursor: pointer;
            font-size: 1em;
        }
        
        .radio-label.fulfilled {
            color: #28a745;
        }
        
        .radio-label.unfulfilled {
            color: #dc3545;
        }
        
        .radio-label.not-inspected {
            color: #ff9800;
        }
        
        .radio-label.not-applicable {
            color: #6c757d;
        }
        
        .capture-photo-btn {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }
        
        .capture-photo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 152, 0, 0.4);
        }
        
        .photos-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .photos-preview-grid > div {
            position: relative;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .photos-preview-grid img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .photo-hint {
            margin-top: 15px;
            padding: 12px;
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            border-radius: 8px;
            color: #e65100;
            font-size: 0.95em;
        }
        
        .submit-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.4em;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }
        
        .info-note {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }
        
        .info-note > div {
            margin-bottom: 10px;
            font-size: 1em;
            color: #555;
        }
        
        .info-note > div:last-child {
            margin-bottom: 0;
        }
        
        @media (max-width: 768px) {
            .inspection-header {
                padding: 20px 15px;
            }
            
            .return-home-btn {
                position: static;
                transform: none;
                margin-bottom: 15px;
            }
            
            .inspection-title {
                font-size: 1.8em;
            }
            
            .inspection-subtitle {
                font-size: 1em;
            }
            
            .inspection-content {
                padding: 20px 15px;
            }
            
            .details-card,
            .form-card {
                padding: 20px;
            }
            
            .section-header {
                font-size: 1.4em;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .checklist-container {
                grid-template-columns: 1fr;
            }
            
            .radio-group {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="inspection-fullscreen-container">
        <!-- Header with Return Button -->
        <div class="inspection-header">
            <a href="index.html" class="return-home-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <h1 class="inspection-title">ğŸ“ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ø¬Ù…Ø§Ø¹Ù‰</h1>
            <p class="inspection-subtitle">Group Inspection Report</p>
        </div>
        
        <!-- Scrollable Content -->
        <div class="inspection-content">
            <!-- Inspection Details Card -->
            <div class="details-card">
                <h3 class="section-header">ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø©</h3>
                <div id="inspectionDetailsGrid" class="details-grid">
                    <!-- Will be filled dynamically -->
                </div>
            </div>
            
            <!-- Inspector Authentication Card -->
            <div class="form-card">
                <h3 class="section-header">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙØªØ´</h3>
                <p style="margin-bottom: 20px; color: #666; font-size: 1em;">
                    ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø£Ø­Ø¯ Ø§Ù„Ù…ÙØªØ´ÙŠÙ† Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡
                </p>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙØªØ´</label>
                        <select id="inspectorSelect" class="form-select">
                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙØªØ´ --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <div style="position: relative;">
                            <input type="password" id="inspectorPassword" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ">
                            <button onclick="togglePasswordVisibility()" class="password-toggle-btn" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">ğŸ‘ï¸</button>
                        </div>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; gap: 15px; flex-wrap: wrap;">
                    <button onclick="verifyPassword()" class="verify-password-btn">
                        âœ… Ø¯Ø®ÙˆÙ„
                    </button>
                </div>
                <div id="passwordVerificationStatus" style="margin-top: 15px; display: none;"></div>
            </div>
            
            <!-- Detailed Inspection Checklist -->
            <div class="form-card">
                <h3 class="section-header">âœ… Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</h3>
                <div class="checklist-container" id="checklistContainer">
                    <!-- Checklist items will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Additional Notes -->
            <div class="form-card">
                <h3 class="section-header">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</h3>
                <div class="form-group">
                    <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©</label>
                    <textarea id="generalNotes" class="form-textarea" rows="4" placeholder="Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ØµÙˆØ¯Ø©</label>
                    <textarea id="violations" class="form-textarea" rows="3" placeholder="Ù‚Ù… Ø¨Ø¥Ø¯Ø±Ø§Ø¬ Ø£ÙŠ Ù…Ø®Ø§Ù„ÙØ§Øª ØªÙ… Ø±ØµØ¯Ù‡Ø§..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙˆØ¹ÙŠØ©</label>
                    <textarea id="awarenessItems" class="form-textarea" rows="3" placeholder="Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø§Ù„ØªÙŠ ØªÙ… ØªÙ‚Ø¯ÙŠÙ…Ù‡Ø§..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ®Ø°Ø©</label>
                    <textarea id="actionsTaken" class="form-textarea" rows="3" placeholder="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙŠ ØªÙ… Ø§ØªØ®Ø§Ø°Ù‡Ø§..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„ØªÙˆØµÙŠØ§Øª</label>
                    <textarea id="recommendations" class="form-textarea" rows="3" placeholder="Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©..."></textarea>
                </div>
            </div>
            
            <!-- Photo Capture Section -->
            <div class="form-card">
                <h3 class="section-header">ğŸ“· ØµÙˆØ± Ø§Ù„ØªÙØªÙŠØ´</h3>
                <button onclick="capturePhoto()" class="capture-photo-btn">
                    <span style="font-size: 1.5em;">ğŸ“¸</span>
                    <span>Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</span>
                </button>
                <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;" onchange="handlePhotoCapture(event)" multiple>
                
                <div id="photosPreview" class="photos-preview-grid">
                    <!-- Photos will be displayed here -->
                </div>
                
                <div class="photo-hint">
                    ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙ‚Ø§Ø· Ø¹Ø¯Ø© ØµÙˆØ± Ù„Ù„ØªÙØªÙŠØ´
                </div>
            </div>
            
            <!-- Submit Section -->
            <div class="submit-section">
                <button onclick="submitInspectionReport()" class="submit-btn">
                    ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </button>
                
                <div class="info-note">
                    <div>âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</div>
                    <div>ğŸ“¸ Ø§Ù„ØµÙˆØ± Ø³ØªÙØ­ÙØ¸ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±</div>
                    <div>ğŸ’¾ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const inspectors = urlParams.get('inspectors') ? decodeURIComponent(urlParams.get('inspectors')).split(',') : [];
        const date = urlParams.get('date') || '';
        const shift = urlParams.get('shift') || '';
        const area = urlParams.get('area') || '';
        const shops = urlParams.get('shops') ? decodeURIComponent(urlParams.get('shops')).split(',') : [];
        
        // Inspection checklist items based on requirements
        const checklistItems = [
            { id: 'item_1', label: 'Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´Ø¢Øª ØºÙŠØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ©' },
            { id: 'item_2', label: 'Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ø¨ÙŠØ·Ø±ÙŠØ©' },
            { id: 'item_3', label: 'Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©' },
            { id: 'item_4', label: 'Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª' }
        ];
        
        // Storage for inspection photos
        let inspectionPhotos = [];
        
        // Initialize page
        function initializePage() {
            // Display inspection details
            displayInspectionDetails();
            
            // Populate inspector dropdown
            populateInspectorDropdown();
            
            // Generate checklist items
            generateChecklistItems();
        }
        
        function displayInspectionDetails() {
            const detailsGrid = document.getElementById('inspectionDetailsGrid');
            detailsGrid.innerHTML = `
                <div><strong>Ø§Ù„Ù…ÙØªØ´ÙŠÙ†:</strong> ${inspectors.join('ØŒ ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${date || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©:</strong> ${shift || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</strong> ${area || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª:</strong> ${shops.length || 0}</div>
                <div style="grid-column: span 2;"><strong>Ø§Ù„Ù…Ø­Ù„Ø§Øª:</strong> ${shops.join('ØŒ ') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
            `;
        }
        
        function populateInspectorDropdown() {
            const select = document.getElementById('inspectorSelect');
            inspectors.forEach(inspector => {
                const option = document.createElement('option');
                option.value = inspector;
                option.textContent = inspector;
                select.appendChild(option);
            });
        }
        
        function generateChecklistItems() {
            const container = document.getElementById('checklistContainer');
            let html = '';
            
            checklistItems.forEach((item) => {
                html += `
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">${item.label}</div>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="${item.id}" value="Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="${item.id}" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="${item.id}" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="${item.id}" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('inspectorPassword');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
            } else {
                passwordInput.type = 'password';
            }
        }
        
        // Generate default password from username
        function generateDefaultPassword(username) {
            return username.replace(/\s+/g, '').replace(/\./g, '').replace(/ØŒ/g, '');
        }
        
        // Check if password is valid for the given username
        function isValidPassword(password, username) {
            const expectedPassword = generateDefaultPassword(username);
            const passwordData = JSON.parse(localStorage.getItem('inspectorPasswords') || '{}');
            const storedPassword = passwordData[username];
            
            return password === expectedPassword || 
                   password === '12345' || 
                   (storedPassword && password === storedPassword);
        }
        
        // Verify password
        function verifyPassword() {
            const password = document.getElementById('inspectorPassword').value;
            const username = document.getElementById('inspectorSelect').value;
            const statusDiv = document.getElementById('passwordVerificationStatus');
            
            if (!username) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙØªØ´ Ø£ÙˆÙ„Ø§Ù‹';
                statusDiv.style.display = 'block';
                return;
            }
            
            if (!password) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
                statusDiv.style.display = 'block';
                return;
            }
            
            // Validate password using helper function
            if (isValidPassword(password, username)) {
                statusDiv.className = 'password-status-success';
                statusDiv.innerHTML = 'âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù…Ù„Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
                statusDiv.style.display = 'block';
            } else {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                statusDiv.style.display = 'block';
            }
        }
        
        function capturePhoto() {
            const input = document.getElementById('photoInput');
            if (input) {
                input.click();
            }
        }
        
        function handlePhotoCapture(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            Array.from(files).forEach(file => {
                if (!file.type.startsWith('image/')) {
                    alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„ÙØ§Øª ØµÙˆØ± ÙÙ‚Ø·');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoData = {
                        data: e.target.result,
                        name: file.name,
                        timestamp: new Date().toISOString()
                    };
                    
                    inspectionPhotos.push(photoData);
                    displayPhotos();
                };
                reader.readAsDataURL(file);
            });
            
            // Reset input to allow selecting the same file again
            event.target.value = '';
        }
        
        function displayPhotos() {
            const previewDiv = document.getElementById('photosPreview');
            if (!previewDiv) return;
            
            previewDiv.innerHTML = inspectionPhotos.map((photo, index) => `
                <div style="position: relative; border: 2px solid #e0e0e0; border-radius: 8px; overflow: hidden;">
                    <img src="${photo.data}" style="width: 100%; height: 150px; object-fit: cover;">
                    <button onclick="removePhoto(${index})" style="position: absolute; top: 5px; left: 5px; background: #dc3545; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3);" title="Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø©">Ã—</button>
                    <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 5px; font-size: 0.8em; text-align: center;">
                        ØµÙˆØ±Ø© ${index + 1}
                    </div>
                </div>
            `).join('');
        }
        
        function removePhoto(index) {
            inspectionPhotos.splice(index, 1);
            displayPhotos();
        }
        
        function submitInspectionReport() {
            // Validate password
            const password = document.getElementById('inspectorPassword').value.trim();
            const username = document.getElementById('inspectorSelect').value;
            
            if (!username) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙØªØ´ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            if (!password) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }
            
            // Validate password using helper function
            if (!isValidPassword(password, username)) {
                alert('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                return;
            }
            
            // Collect checklist data
            const checklistData = [];
            checklistItems.forEach(item => {
                const selected = document.querySelector(`input[name="${item.id}"]:checked`);
                checklistData.push({
                    id: item.id,
                    label: item.label,
                    value: selected ? selected.value : null
                });
            });
            
            // Create inspection report object
            const inspectionReport = {
                inspectors: inspectors,
                selectedInspector: username,
                date: date,
                shift: shift,
                area: area,
                shops: shops,
                checklist: checklistData,
                notes: {
                    generalNotes: document.getElementById('generalNotes').value,
                    violations: document.getElementById('violations').value,
                    awarenessItems: document.getElementById('awarenessItems').value,
                    actionsTaken: document.getElementById('actionsTaken').value,
                    recommendations: document.getElementById('recommendations').value
                },
                photos: inspectionPhotos,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            try {
                const savedReports = JSON.parse(localStorage.getItem('groupInspectionReports') || '[]');
                savedReports.push(inspectionReport);
                localStorage.setItem('groupInspectionReports', JSON.stringify(savedReports));
                
                // Show success message
                alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!');
                
                // Redirect back to main page
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error saving report:', error);
                if (error.name === 'QuotaExceededError') {
                    alert('âš ï¸ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ†ÙŠØ© Ù…Ù…ØªÙ„Ø¦Ø©. ÙŠØ±Ø¬Ù‰ Ø­Ø°Ù Ø¨Ø¹Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.');
                } else {
                    alert('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                }
            }
        }
        
        // Initialize page on load
        window.onload = initializePage;
    </script>
</body>
</html>

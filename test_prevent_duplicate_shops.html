<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø­Ù„Ø§Øª</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .test-case {
            background: #f7fafc;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 5px solid #4299e1;
        }
        .test-case.pass {
            border-left-color: #48bb78;
            background: #f0fff4;
        }
        .test-case.fail {
            border-left-color: #f56565;
            background: #fff5f5;
        }
        .test-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #2d3748;
        }
        .test-result {
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .pass .test-result {
            background: #c6f6d5;
            color: #22543d;
        }
        .fail .test-result {
            background: #fed7d7;
            color: #742a2a;
        }
        .test-details {
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            font-size: 0.9em;
            color: #4a5568;
        }
        .summary {
            background: #edf2f7;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            font-size: 1.2em;
        }
        .summary.all-pass {
            background: #c6f6d5;
            color: #22543d;
        }
        .code {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            direction: ltr;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø­Ù„Ø§Øª</h1>
        <p style="text-align: center; font-size: 1.1em; color: #4a5568; margin-bottom: 30px;">
            Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ù…Ù„ Ø¢Ù„ÙŠØ© Ù…Ù†Ø¹ ØªØ®ØµÙŠØµ Ù†ÙØ³ Ø§Ù„Ù…Ø­Ù„ Ù„Ø£ÙƒØ«Ø± Ù…Ù† Ù…ÙØªØ´ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
        </p>
        
        <div id="test-results"></div>
        <div id="summary"></div>
    </div>

    <script>
        // Simulate the planData structure
        const planData = {
            inspectionData: [
                {
                    inspector: "Ø¯. Ø¢Ù…Ù†Ù‡ Ø¨Ù† ØµØ±Ù…",
                    day: "2025-10-24",
                    shift: "ØµØ¨Ø§Ø­ÙŠØ©",
                    area: "Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ø§Øª",
                    shops: ["ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©", "Ø¨ÙŠØª ÙƒÙŠØ± Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©"]
                },
                {
                    inspector: "Ø¯. Ù‡Ø§Ø¬Ø± Ø§Ù„ØºØ§ÙØ±ÙŠ",
                    day: "2025-10-24",
                    shift: "Ù…Ø³Ø§Ø¦ÙŠØ©",
                    area: "Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ø§Øª",
                    shops: ["Ù…Ø­Ù„ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠ", "Ù…Ø­Ù„ Ø¨ÙŠØªØ³ Ø¨Ø§Ø±Ø§Ø¯Ø§ÙŠØ³"]
                },
                {
                    inspector: "Ø¯. Ø¢Ù…Ù†Ù‡ Ø¨Ù† ØµØ±Ù…",
                    day: "2025-10-25",
                    shift: "ØµØ¨Ø§Ø­ÙŠØ©",
                    area: "Ø³ÙˆÙ‚ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡",
                    shops: ["Ù…Ø­Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ Ù„Ù„Ø·ÙŠÙˆØ±", "Ù…Ø­Ù„ Ø§Ù„Ø³Ø­Ø± Ù„Ù„Ø·ÙŠÙˆØ±"]
                }
            ]
        };

        // The validation function from smart-planner.html
        function checkForDuplicateShops(inspector, date, selectedShops, currentIndex = -1) {
            const duplicateShops = [];
            
            for (let i = 0; i < planData.inspectionData.length; i++) {
                const inspection = planData.inspectionData[i];
                
                // Skip the current inspection being edited
                if (i === currentIndex) {
                    continue;
                }
                
                // Skip if it's the same inspector on same day (will be handled separately)
                if (inspection.inspector === inspector && inspection.day === date) {
                    continue;
                }
                
                // Check if it's the same day but different inspector
                if (inspection.day === date) {
                    const inspectionShops = inspection.shops || [];
                    for (const shop of selectedShops) {
                        if (inspectionShops.includes(shop)) {
                            duplicateShops.push({
                                shop: shop,
                                inspector: inspection.inspector
                            });
                        }
                    }
                }
            }
            
            return duplicateShops;
        }

        // Test cases
        const testCases = [
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 1: Ù…Ø­Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ØªÙ…Ø§Ù…Ø§Ù‹ - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†Ø¬Ø­",
                inspector: "Ø¯. ÙØ§ÙŠØ² Ø§Ù„Ù…Ø³Ø§Ù„Ù…Ø©",
                date: "2025-10-24",
                shops: ["Ù…Ø­Ù„ Ø¬Ø¯ÙŠØ¯ 1", "Ù…Ø­Ù„ Ø¬Ø¯ÙŠØ¯ 2"],
                expectedDuplicates: 0,
                shouldPass: true
            },
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 2: Ù…Ø­Ù„ Ù…ÙƒØ±Ø± Ù…Ø¹ Ù…ÙØªØ´ Ø¢Ø®Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ… - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ´Ù„",
                inspector: "Ø¯. ÙØ§ÙŠØ² Ø§Ù„Ù…Ø³Ø§Ù„Ù…Ø©",
                date: "2025-10-24",
                shops: ["ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©", "Ù…Ø­Ù„ Ø¬Ø¯ÙŠØ¯"],
                expectedDuplicates: 1,
                shouldPass: false
            },
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 3: Ù†ÙØ³ Ø§Ù„Ù…Ø­Ù„ Ù„ÙƒÙ† ÙÙŠ ÙŠÙˆÙ… Ù…Ø®ØªÙ„Ù - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†Ø¬Ø­",
                inspector: "Ø¯. ÙØ§ÙŠØ² Ø§Ù„Ù…Ø³Ø§Ù„Ù…Ø©",
                date: "2025-10-26",
                shops: ["ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©"],
                expectedDuplicates: 0,
                shouldPass: true
            },
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 4: Ø¹Ø¯Ø© Ù…Ø­Ù„Ø§Øª Ù…ÙƒØ±Ø±Ø© - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ´Ù„",
                inspector: "Ø¯. Ù…Ø­Ù…Ø¯ Ø³Ø¹ÙŠØ¯",
                date: "2025-10-24",
                shops: ["ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©", "Ø¨ÙŠØª ÙƒÙŠØ± Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©", "Ù…Ø­Ù„ Ø¨ÙŠØªØ³ Ø¨Ø§Ø±Ø§Ø¯Ø§ÙŠØ³"],
                expectedDuplicates: 3,
                shouldPass: false
            },
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 5: Ù†ÙØ³ Ø§Ù„Ù…ÙØªØ´ ÙˆÙ†ÙØ³ Ø§Ù„ÙŠÙˆÙ… - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†Ø¬Ø­ (ÙŠÙØ¹Ø§Ù„Ø¬ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰)",
                inspector: "Ø¯. Ø¢Ù…Ù†Ù‡ Ø¨Ù† ØµØ±Ù…",
                date: "2025-10-24",
                shops: ["ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©", "Ø¨ÙŠØª ÙƒÙŠØ± Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©"],
                expectedDuplicates: 0,
                shouldPass: true
            },
            {
                name: "Ø§Ø®ØªØ¨Ø§Ø± 6: ØªØ¹Ø¯ÙŠÙ„ ØªÙØªÙŠØ´ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ù„ Ù…ÙƒØ±Ø± - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ´Ù„",
                inspector: "Ø¯. Ù‡Ø§Ø¬Ø± Ø§Ù„ØºØ§ÙØ±ÙŠ",
                date: "2025-10-24",
                shops: ["Ù…Ø­Ù„ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠ", "ÙÙŠØ°ÙŠØ±Ø² Ø§Ù† ÙÙŠÙ†Ø³ Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ÙŠÙØ©"],
                expectedDuplicates: 1,
                shouldPass: false,
                editingIndex: 1
            }
        ];

        // Run tests
        const results = [];
        const resultsContainer = document.getElementById('test-results');
        
        testCases.forEach((test, index) => {
            const duplicates = checkForDuplicateShops(
                test.inspector, 
                test.date, 
                test.shops,
                test.editingIndex
            );
            
            const passed = (duplicates.length === test.expectedDuplicates) && 
                          ((duplicates.length === 0) === test.shouldPass);
            
            results.push(passed);
            
            const testDiv = document.createElement('div');
            testDiv.className = `test-case ${passed ? 'pass' : 'fail'}`;
            
            let detailsHTML = `
                <div class="test-details">
                    <strong>Ø§Ù„Ù…ÙØªØ´:</strong> ${test.inspector}<br>
                    <strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${test.date}<br>
                    <strong>Ø§Ù„Ù…Ø­Ù„Ø§Øª:</strong> ${test.shops.join(', ')}<br>
                    <strong>Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</strong> ${test.expectedDuplicates}<br>
                    <strong>Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©:</strong> ${duplicates.length}<br>
            `;
            
            if (duplicates.length > 0) {
                detailsHTML += '<strong>Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø©:</strong><br>';
                duplicates.forEach(dup => {
                    detailsHTML += `â€¢ ${dup.shop} (Ù…Ø®ØµØµ Ù„Ù€: ${dup.inspector})<br>`;
                });
            }
            
            detailsHTML += '</div>';
            
            testDiv.innerHTML = `
                <div class="test-title">${test.name}</div>
                ${detailsHTML}
                <div class="test-result">
                    ${passed ? 'âœ… Ù†Ø¬Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±' : 'âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±'}
                </div>
            `;
            
            resultsContainer.appendChild(testDiv);
        });

        // Display summary
        const passedCount = results.filter(r => r).length;
        const totalCount = results.length;
        const allPassed = passedCount === totalCount;
        
        const summaryDiv = document.getElementById('summary');
        summaryDiv.className = `summary ${allPassed ? 'all-pass' : ''}`;
        summaryDiv.innerHTML = `
            <h2>${allPassed ? 'ğŸ‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª!' : 'âš ï¸ Ø¨Ø¹Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙØ´Ù„Øª'}</h2>
            <p><strong>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</strong> ${passedCount} Ù…Ù† ${totalCount} Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª</p>
            ${allPassed ? 
                '<p>âœ… Ø¢Ù„ÙŠØ© Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!</p>' : 
                '<p>âŒ ÙŠÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø¢Ù„ÙŠØ© Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±</p>'}
        `;
        
        // Log results to console
        console.log('='.repeat(80));
        console.log('Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø­Ù„Ø§Øª');
        console.log('='.repeat(80));
        console.log(`Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${passedCount}/${totalCount} Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª`);
        console.log(`Ø§Ù„Ø­Ø§Ù„Ø©: ${allPassed ? 'Ù†Ø¬Ø­ âœ…' : 'ÙØ´Ù„ âŒ'}`);
        console.log('='.repeat(80));
    </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 24.8.1.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.27in 11.69in; margin: 0.79in }
		p { line-height: 115%; margin-bottom: 0.1in; background: transparent }
		pre { background: transparent }
		pre.western { font-family: "Liberation Mono", monospace; font-size: 10pt }
		pre.cjk { font-family: "NSimSun", monospace; font-size: 10pt }
		pre.ctl { font-family: "Liberation Mono", monospace; font-size: 10pt }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre class="western">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ar&quot; dir=&quot;rtl&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;<span lang="hi-IN">واجهة إدارة خطة التفتيش الشهرية</span>&lt;/title&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
    &lt;style&gt;
        body {
            font-family: 'Cairo', Tahoma, Arial, sans-serif;
            background: #f7f8fa;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1100px;
            margin: 40px auto 24px auto;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 4px 32px #0002;
            padding: 32px 24px 24px 24px;
            direction: rtl;
        }
        .main-title {
            background: #234093;
            color: #fff;
            border-radius: 10px;
            padding: 18px 0;
            text-align: center;
            font-size: 2em;
            margin-bottom: 24px;
            letter-spacing: 1px;
        }
        .top-bar {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 18px;
            gap: 1.5rem;
            direction: rtl;
        }
        .top-bar label, .top-bar .user-type-label {
            font-size: 1.1em;
            margin-left: 8px;
        }
        .top-bar select, .top-bar button {
            font-size: 1em;
            border-radius: 7px;
            border: 1px solid #ccc;
            padding: 8px 14px;
            margin-right: 8px;
        }
        .top-bar button {
            background: #234093;
            color: #fff;
            border: none;
            margin: 0 4px;
            cursor: pointer;
            transition: 0.2s;
        }
        .top-bar button:hover {
            background: #1a2c67;
        }
        .admin-panel {
            margin: 32px 0 32px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 28px;
        }
        .admin-section {
            background: #f3f6fe;
            border: 1px solid #e0e7f7;
            border-radius: 14px;
            padding: 24px 18px 18px 18px;
            box-shadow: 0px 1.5px 6px #23409311;
            margin-bottom: 24px;
        }
        .admin-section h3 {
            color: #1a2c67;
            margin-top: 0;
            font-size: 1.13em;
            margin-bottom: 18px;
        }
        .add-row-form {
            display: flex;
            gap: 8px;
            margin-bottom: 18px;
            align-items: center;
        }
        .add-row-form input[type=&quot;text&quot;] {
            flex: 1;
            font-size: 1em;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid #bbb;
        }
        .add-row-form button {
            background: #234093;
            color: #fff;
            border: none;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: 0.2s;
        }
        .admin-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .admin-list li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #fff;
            margin-bottom: 7px;
            border-radius: 7px;
            padding: 7px 10px;
            border: 1px solid #e3e6f0;
        }
        .admin-list .list-actions button {
            margin-right: 5px;
            font-size: 0.97em;
            padding: 4px 12px;
            border-radius: 5px;
        }
        .edit-btn {
            background: #efb400;
            color: #fff;
            border: none;
        }
        .edit-btn:hover {
            background: #b28a00;
        }
        .save-btn {
            background: #388e3c;
            color: #fff;
            border: none;
        }
        .delete-btn {
            background: #d32f2f;
            color: #fff;
            border: none;
        }
        .delete-btn:hover {
            background: #b71c1c;
        }
        .goal-section {
            background: #e5f7ef;
            border: 1px solid #81c6ae;
            border-radius: 14px;
            padding: 24px 18px 18px 18px;
            box-shadow: 0px 1.5px 6px #046a4433;
            margin-top: 30px;
        }
        .goal-section h3 {
            color: #046a44;
            margin-top: 0;
            font-size: 1.13em;
            margin-bottom: 18px;
        }
        .goal-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .goal-list li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #fff;
            margin-bottom: 7px;
            border-radius: 7px;
            padding: 7px 10px;
            border: 1px solid #b2dfdb;
        }
        .goal-list .list-actions button {
            margin-right: 5px;
            font-size: 0.97em;
            padding: 4px 12px;
            border-radius: 5px;
        }
        .goal-edit-btn {
            background: #009688;
            color: #fff;
        }
        .goal-save-btn {
            background: #388e3c;
            color: #fff;
        }
        .goal-delete-btn {
            background: #d32f2f;
            color: #fff;
        }
        .goal-delete-btn:hover {
            background: #b71c1c;
        }
        /* <span lang="hi-IN">توزيع المحلات </span>*/
        .shops-area-box {
            background: #e9ebf6;
            border-radius: 10px;
            padding: 18px 10px 10px 10px;
            margin-bottom: 20px;
        }
        .shops-area-title {
            font-size: 1.07em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .shop-area-tag {
            background: #234093;
            color: #fff;
            border-radius: 18px;
            padding: 4px 16px 4px 16px;
            display: inline-block;
            margin: 2px 4px;
        }
        .shop-area-tag button {
            background: #c22;
            color: #fff;
            border: none;
            border-radius: 50%;
            margin-right: 4px;
            font-size: 1.1em;
            cursor: pointer;
        }
        .distribution-table th, .distribution-table td {
            text-align: center;
            padding: 7px 6px;
        }
        .distribution-table th {
            background: #234093;
            color: #fff;
        }
        .distribution-table td button {
            background: #c22;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            padding: 4px 10px;
        }
        /* <span lang="hi-IN">المفتش </span>*/
        .section-box {
            background: #f4f6fa;
            border-radius: 14px;
            margin-bottom: 30px;
            box-shadow: 0px 1.5px 6px #23409311;
        }
        .table-title, .stats-title {
            color: #c00;
            font-size: 1.15em;
            font-weight: bold;
            margin: 16px 0 8px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            margin-bottom: 10px;
        }
        th, td {
            border: 1px solid #bbb;
            padding: 12px 6px;
            text-align: center;
            vertical-align: middle;
            font-size: 1.09em;
        }
        th {
            background: #234093;
            color: #fff;
        }
        .shop-btn {
            background: #e5eaff;
            color: #234093;
            border: none;
            border-radius: 7px;
            padding: 6px 16px;
            cursor: pointer;
            font-size: 1em;
            transition: 0.2s;
        }
        .shop-btn:hover {
            background: #b2c5fa;
        }
        .goals-section {
            background: #e5f7ef;
            border: 1px solid #81c6ae;
            border-radius: 14px;
            padding: 16px 12px 10px 12px;
            margin-bottom: 15px;
        }
        .goals-section h3 {
            color: #046a44;
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }
        .goals-section ul {
            margin: 0;
            padding-right: 20px;
        }
        .goals-section li {
            color: #046a44;
            margin-bottom: 4px;
            font-size: 1.01em;
        }
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 8px;
            background: #fff;
            margin-bottom: 12px;
            overflow: hidden;
        }
        .stats-table th, .stats-table td {
            border: 1px solid #234093;
            padding: 10px 6px;
            text-align: center;
            font-size: 1.05em;
        }
        .stats-table th {
            background: #234093;
            color: #fff;
        }
        .stats-table tfoot td {
            background: #e2e6f6;
            font-weight: bold;
        }
        .stats-total-cell {
            color: #c00;
            font-weight: bold;
        }
        .copyright {
            text-align: center;
            color: #234093;
            font-weight: bold;
            margin-top: 20px;
            font-size: 1.08em;
        }
        /* <span lang="hi-IN">نافذة المحلات ونافذة الرقم السري </span>*/
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.36);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: #fff;
            padding: 32px 26px 22px 26px;
            border-radius: 18px;
            box-shadow: 0 2px 16px #0002;
            min-width: 260px;
            max-width: 350px;
            text-align: center;
        }
        .modal-content button {
            background: #234093;
            color: #fff;
            border: none;
            padding: 8px 22px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 10px;
        }
        .modal-content label {
            font-size: 1.08em;
            color: #234093;
            margin-bottom: 16px;
            display: block;
        }
        .modal-content input[type=&quot;password&quot;], .modal-content input[type=&quot;text&quot;] {
            font-size: 1.08em;
            padding: 7px 12px;
            border: 1.5px solid #ccc;
            border-radius: 8px;
            margin-bottom: 14px;
            text-align: center;
        }
        .modal-content .error-msg {
            color: #d32f2f;
            margin-bottom: 8px;
        }
        .modal-token-content input[type=&quot;password&quot;] {
            direction: ltr;
            text-align: left;
        }
        @media (max-width: 900px) {
            .container { padding: 14px 2px 8px 2px; }
            .main-title { font-size: 1.22em; padding: 11px 0; }
            .admin-panel { grid-template-columns: 1fr; gap: 16px; }
            .admin-section, .goal-section, .inspect-section, .section-box { padding: 13px 4px 13px 4px;}
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;!-- <span lang="hi-IN">العنوان الرئيسي </span>--&gt;
        &lt;div class=&quot;main-title&quot;&gt;
            <span lang="hi-IN">خطة التفتيش الشهرية</span>
        &lt;/div&gt;
        &lt;!-- <span lang="hi-IN">شريط الأدوات العلوي </span>--&gt;
        &lt;div class=&quot;top-bar&quot;&gt;
            &lt;div&gt;
                &lt;span class=&quot;user-type-label&quot;&gt;<span lang="hi-IN">نوع المستخدم</span>:&lt;/span&gt;
                &lt;select id=&quot;userTypeSelect&quot; onchange=&quot;handleUserTypeChange()&quot;&gt;
                    &lt;option value=&quot;inspector&quot;&gt;<span lang="hi-IN">مفتش</span>&lt;/option&gt;
                    &lt;option value=&quot;developer&quot;&gt;<span lang="hi-IN">المطور</span>&lt;/option&gt;
                &lt;/select&gt;
                &lt;span id=&quot;inspectorSelectBox&quot; style=&quot;display:inline-block;&quot;&gt;
                    &lt;label for=&quot;inspectorSelect&quot;&gt;<span lang="hi-IN">اسم المفتش</span>:&lt;/label&gt;
                    &lt;select id=&quot;inspectorSelect&quot; onchange=&quot;renderInspectorPage()&quot;&gt;&lt;/select&gt;
                &lt;/span&gt;
                &lt;button onclick=&quot;window.print()&quot;&gt;<span lang="hi-IN">طباعة أو حفظ </span>PDF&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- <span lang="hi-IN">لوحة الإدارة للمطور </span>--&gt;
        &lt;div id=&quot;adminPanel&quot; style=&quot;display:none;&quot;&gt;
            &lt;!-- <span lang="hi-IN">زر تغيير التوكن </span>--&gt;
            &lt;button id=&quot;changeTokenBtn&quot; style=&quot;background:#009688;color:#fff;margin-bottom:10px;display:none;&quot; onclick=&quot;clearToken()&quot;&gt;<span lang="hi-IN">تغيير </span>GitHub Token&lt;/button&gt;
            &lt;div class=&quot;admin-panel&quot;&gt;
                &lt;!-- ... (<span lang="hi-IN">باقي لوحة الإدارة</span>) ... --&gt;
                &lt;!-- <span lang="hi-IN">ضع هنا باقي الكود حسب ملفك الأصلي </span>(<span lang="hi-IN">تم حذف الجزء المكرر للتوضيح فقط</span>) --&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- ... (<span lang="hi-IN">باقي الصفحة كما هو</span>) ... --&gt;
    &lt;/div&gt;
    &lt;!-- <span lang="hi-IN">نافذة إدخال التوكن </span>--&gt;
    &lt;div id=&quot;modalToken&quot; class=&quot;modal-overlay&quot; style=&quot;display:none;&quot;&gt;
        &lt;div class=&quot;modal-content modal-token-content&quot;&gt;
            &lt;label&gt;<span lang="hi-IN">يرجى إدخال </span>GitHub API Token (<span lang="hi-IN">لن يظهر لأحد ويتم حفظه محليًا</span>):&lt;/label&gt;
            &lt;input type=&quot;password&quot; id=&quot;tokenInput&quot; maxlength=&quot;80&quot; autocomplete=&quot;off&quot; /&gt;
            &lt;div class=&quot;error-msg&quot; id=&quot;tokenError&quot; style=&quot;display:none;&quot;&gt;<span lang="hi-IN">الرجاء إدخال توكين صالح </span>(40+ <span lang="hi-IN">حرف</span>).&lt;/div&gt;
            &lt;button onclick=&quot;saveToken()&quot;&gt;<span lang="hi-IN">حفظ</span>&lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;script&gt;
        // (<span lang="hi-IN">كل جافاسكريبت ملفك كما هو</span>)
        // ... <span lang="hi-IN">وضع هنا كل كودك القديم بدون أي حذف </span>...
        // <span lang="hi-IN">أضف في النهاية دعم التوكن</span>:
        // ==== <span lang="hi-IN">دعم التوكن </span>GitHub ====
        function getToken() { return localStorage.getItem('github_token'); }
        function showTokenModal() {
            document.getElementById('modalToken').style.display = '';
            document.getElementById('tokenInput').value = '';
            document.getElementById('tokenError').style.display = 'none';
            setTimeout(()=&gt;document.getElementById('tokenInput').focus(), 200);
        }
        function saveToken() {
            const token = document.getElementById('tokenInput').value.trim();
            if(token.length &lt; 40) {
                document.getElementById('tokenError').style.display = '';
                return;
            }
            localStorage.setItem('github_token', token);
            document.getElementById('modalToken').style.display = 'none';
            alert('<span lang="hi-IN">تم حفظ التوكن بنجاح</span>!');
            document.getElementById('changeTokenBtn').style.display = '';
        }
        function clearToken() {
            localStorage.removeItem('github_token');
            alert('<span lang="hi-IN">تم حذف التوكن، يرجى إدخاله من جديد عند أول رفع</span>.');
        }
        async function uploadDistributionToGitHub() {
            let token = getToken();
            if (!token) {
                showTokenModal();
                return;
            }
            let csv = &quot;<span lang="hi-IN">المفتش</span>,<span lang="hi-IN">اليوم</span>,<span lang="hi-IN">المنطقة</span>,<span lang="hi-IN">المحلات</span>\n&quot;;
            distributionRows.forEach(row=&gt;{
                csv += `${row.inspector},${row.day},${row.area},&quot;${(row.shop||[]).join(' - ')}&quot;\n`;
            });
            let repoOwner = &quot;aliabdelaal-adm&quot;;
            let repoName = &quot;Monthly_inspection_plan&quot;;
            let filePath = &quot;<span lang="hi-IN">جدول</span>_<span lang="hi-IN">توزيع</span>_<span lang="hi-IN">المحلات</span>.csv&quot;;
            let commitMsg = &quot;<span lang="hi-IN">تحديث جدول توزيع المحلات تلقائيًا من الواجهة</span>&quot;;
            let api = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;
            let fileSha = null;
            try {
                let resp = await fetch(api, {headers: {Authorization: &quot;token &quot; + token}});
                if(resp.ok) {
                    let data = await resp.json();
                    fileSha = data.sha;
                }
            } catch {}
            let putResp = await fetch(api, {
                method: &quot;PUT&quot;,
                headers: {
                    &quot;Authorization&quot;: &quot;token &quot; + token,
                    &quot;Content-Type&quot;: &quot;application/json&quot;
                },
                body: JSON.stringify({
                    message: commitMsg,
                    content: btoa(unescape(encodeURIComponent(csv))),
                    sha: fileSha || undefined
                })
            });
            if (putResp.ok) {
                alert(&quot;<span lang="hi-IN">تم رفع الجدول بنجاح إلى </span>GitHub!&quot;);
            } else if (putResp.status === 401) {
                clearToken();
                alert(&quot;<span lang="hi-IN">التوكن غير صالح أو منتهي</span>. <span lang="hi-IN">أدخل توكن صحيح</span>.&quot;);
            } else {
                alert(&quot;<span lang="hi-IN">حدث خطأ أثناء الرفع</span>! <span lang="hi-IN">تحقق من التوكن وصلاحياته</span>.&quot;);
            }
        }
        // <span lang="hi-IN">إظهار زر تغيير التوكن فقط للمطور</span>
        function showChangeTokenIfDeveloper() {
            const btn = document.getElementById('changeTokenBtn');
            if(btn) btn.style.display = '';
        }
        const originalHandleUserTypeChange = handleUserTypeChange;
        handleUserTypeChange = function() {
            originalHandleUserTypeChange();
            const type = document.getElementById('userTypeSelect').value;
            if(type === 'developer') {
                showChangeTokenIfDeveloper();
            } else {
                const btn = document.getElementById('changeTokenBtn');
                if(btn) btn.style.display = 'none';
            }
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
// ==== <span lang="hi-IN">دعم التوكن </span>GitHub ====
function getToken() { return localStorage.getItem('github_token'); }
function showTokenModal() {
    document.getElementById('modalToken').style.display = '';
    document.getElementById('tokenInput').value = '';
    document.getElementById('tokenError').style.display = 'none';
    setTimeout(()=&gt;document.getElementById('tokenInput').focus(), 200);
}
function saveToken() {
    const token = document.getElementById('tokenInput').value.trim();
    if(token.length &lt; 40) {
        document.getElementById('tokenError').style.display = '';
        return;
    }
    localStorage.setItem('github_token', token);
    document.getElementById('modalToken').style.display = 'none';
    alert('<span lang="hi-IN">تم حفظ التوكين بنجاح</span>!');
    document.getElementById('changeTokenBtn').style.display = '';
}
function clearToken() {
    localStorage.removeItem('github_token');
    alert('<span lang="hi-IN">تم حذف التوكن، يرجى إدخاله من جديد عند أول رفع</span>.');
}
async function uploadDistributionToGitHub() {
    let token = getToken();
    if (!token) {
        showTokenModal();
        return;
    }
    let csv = &quot;<span lang="hi-IN">المفتش</span>,<span lang="hi-IN">اليوم</span>,<span lang="hi-IN">المنطقة</span>,<span lang="hi-IN">المحلات</span>\n&quot;;
    distributionRows.forEach(row=&gt;{
        csv += `${row.inspector},${row.day},${row.area},&quot;${(row.shop||[]).join(' - ')}&quot;\n`;
    });
    let repoOwner = &quot;aliabdelaal-adm&quot;;
    let repoName = &quot;Monthly_inspection_plan&quot;;
    let filePath = &quot;<span lang="hi-IN">جدول</span>_<span lang="hi-IN">توزيع</span>_<span lang="hi-IN">المحلات</span>.csv&quot;;
    let commitMsg = &quot;<span lang="hi-IN">تحديث جدول توزيع المحلات تلقائيًا من الواجهة</span>&quot;;
    let api = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;
    let fileSha = null;
    try {
        let resp = await fetch(api, {headers: {Authorization: &quot;token &quot; + token}});
        if(resp.ok) {
            let data = await resp.json();
            fileSha = data.sha;
        }
    } catch {}
    let putResp = await fetch(api, {
        method: &quot;PUT&quot;,
        headers: {
            &quot;Authorization&quot;: &quot;token &quot; + token,
            &quot;Content-Type&quot;: &quot;application/json&quot;
        },
        body: JSON.stringify({
            message: commitMsg,
            content: btoa(unescape(encodeURIComponent(csv))),
            sha: fileSha || undefined
        })
    });
    if (putResp.ok) {
        alert(&quot;<span lang="hi-IN">تم رفع الجدول بنجاح إلى </span>GitHub!&quot;);
    } else if (putResp.status === 401) {
        clearToken();
        alert(&quot;<span lang="hi-IN">التوكن غير صالح أو منتهي</span>. <span lang="hi-IN">أدخل توكن صحيح</span>.&quot;);
    } else {
        alert(&quot;<span lang="hi-IN">حدث خطأ أثناء الرفع</span>! <span lang="hi-IN">تحقق من التوكن وصلاحياته</span>.&quot;);
    }
}
// <span lang="hi-IN">إظهار زر تغيير التوكن فقط للمطور</span>
function showChangeTokenIfDeveloper() {
    const btn = document.getElementById('changeTokenBtn');
    if(btn) btn.style.display = '';
}
const originalHandleUserTypeChange = handleUserTypeChange;
handleUserTypeChange = function() {
    originalHandleUserTypeChange();
    const type = document.getElementById('userTypeSelect').value;
    if(type === 'developer') {
        showChangeTokenIfDeveloper();
    } else {
        const btn = document.getElementById('changeTokenBtn');
        if(btn) btn.style.display = 'none';
    }
}</pre>
</body>
</html>
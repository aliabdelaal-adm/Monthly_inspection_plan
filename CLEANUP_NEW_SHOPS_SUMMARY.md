# ملخص عملية إزالة المحلات الجديدة من النظام

## المشكلة
كان النظام يحتوي على 491 محل في ملف `shops_details.json` بينما يجب أن يحتوي فقط على المحلات القديمة الموجودة في ملف `old-shop-list-updated.xlsx` (126 محل).

## الحل المطبق

### 1. تنظيف ملف shops_details.json
- **قبل التنظيف**: 491 محل (204 محل قديم + 287 محل جديد)
- **بعد التنظيف**: 204 محل قديم فقط
- **تم حذف**: 287 محل جديد

### 2. تنظيف ملفات plan-data*.json
تم تنظيف 9 ملفات plan-data وإزالة المحلات الجديدة منها:

| الملف | قبل | بعد | تم الحذف |
|------|-----|-----|----------|
| plan-data.json | 410 | 22 | 388 |
| plan-data10001.json | 149 | 15 | 134 |
| plan-dataALI.json | 149 | 15 | 134 |
| plan-dataamna.json | 149 | 15 | 134 |
| plan-dataaya.json | 149 | 15 | 134 |
| plan-datafayez.json | 149 | 15 | 134 |
| plan-datahassina.json | 149 | 15 | 134 |
| plan-datahessa.json | 149 | 15 | 134 |
| plan-dataismail.json | 149 | 15 | 134 |

**إجمالي المحلات المحذوفة من ملفات plan-data**: 1,460 محل

### 3. حذف ملفات Excel الخاصة بالمحلات الجديدة
تم حذف الملفات التالية من المستودع:
- `new-shop-list-updated_backup_20251022_214658.xlsx`
- `رخص المحلات الجديدة.xlsx`

### 4. ملفات النسخ الاحتياطي
تم إنشاء نسخ احتياطية من جميع الملفات المعدلة بتاريخ ووقت التعديل:
- `shops_details.json.backup_YYYYMMDD_HHMMSS`
- `plan-data*.json.backup_YYYYMMDD_HHMMSS`

## المعايير المستخدمة لتحديد المحلات القديمة
تم تحديد المحلات القديمة بناءً على مطابقة واحدة أو أكثر من المعايير التالية:
1. **كود ADM Code**: مطابقة كود ADM مع القائمة القديمة
2. **رقم الترخيص LICENSE NO**: مطابقة رقم الترخيص مع القائمة القديمة
3. **الاسم بالعربي**: مطابقة اسم المحل بالعربي مع القائمة القديمة

## الملفات المعدلة
1. `shops_details.json` - تم تنظيفه ليحتوي على 204 محل قديم فقط
2. `plan-data.json` - تم تنظيفه ليحتوي على 22 محل قديم فقط
3. `plan-data10001.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
4. `plan-dataALI.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
5. `plan-dataamna.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
6. `plan-dataaya.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
7. `plan-datafayez.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
8. `plan-datahassina.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
9. `plan-datahessa.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
10. `plan-dataismail.json` - تم تنظيفه ليحتوي على 15 محل قديم فقط
11. `.gitignore` - تم تحديثه لاستبعاد ملفات النسخ الاحتياطي

## الملفات المحذوفة من Git
1. `new-shop-list-updated_backup_20251022_214658.xlsx`
2. `رخص المحلات الجديدة.xlsx`

## التحقق من النتائج
بعد التنظيف، النظام الآن يحتوي فقط على المحلات القديمة:
- ✅ shops_details.json: 204 محل قديم
- ✅ plan-data.json: 22 محل قديم
- ✅ ملفات plan-data الأخرى: 15 محل قديم لكل ملف
- ✅ تم حذف جميع ملفات Excel الخاصة بالمحلات الجديدة

## ملاحظات مهمة
- تم الاحتفاظ بملف `old-shop-list-updated.xlsx` كمرجع للمحلات القديمة
- تم الاحتفاظ بملف `files/documents/قائمة_المحلات.xlsx` لأنه يحتوي على 106 محل من المحلات القديمة فقط
- سكريبتات الدمج مثل `merge_new_shops_from_excel.py` لم يتم حذفها ولكن يجب عدم استخدامها

## تاريخ التنفيذ
التاريخ: 23 أكتوبر 2025
الوقت: 23:41 UTC

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ù…ÙˆØ°Ø¬ ØªÙØªÙŠØ´ Ø§Ù„Ù…Ù„Ø§Ø¬Ù‰Ø¡ - Shelter Inspection Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Cache Prevention -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            direction: rtl;
            overflow-y: auto;
        }
        
        /* Fullscreen Shelter Inspection Modal Styles - Copied from index.html */
        .shelter-inspection-fullscreen-modal {
            width: 100vw;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-y: auto;
            overflow-x: hidden;
            direction: rtl;
        }

        .shelter-inspection-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .shelter-return-home-btn {
            position: absolute;
            top: 50%;
            left: 30px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .shelter-return-home-btn:hover {
            background: white;
            color: #667eea;
            transform: translateY(-50%) scale(1.05);
        }

        .shelter-inspection-title {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .shelter-inspection-subtitle {
            font-size: 1.2em;
            margin: 0;
            opacity: 0.9;
        }

        .shelter-inspection-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        .shelter-details-card,
        .shelter-form-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .shelter-details-card:hover,
        .shelter-form-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .section-header {
            color: #667eea;
            font-size: 1.8em;
            margin: 0 0 25px 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }

        .shelter-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f8ff 100%);
            border-radius: 15px;
        }

        .shelter-details-grid > div {
            font-size: 1.1em;
        }

        .shelter-details-grid strong {
            color: #2336a0;
            font-weight: 700;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group-shelter {
            margin-bottom: 20px;
        }

        .form-label-shelter {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #333;
            font-size: 1.1em;
        }

        .form-input-shelter,
        .form-textarea-shelter {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1em;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }

        .form-input-shelter:focus,
        .form-textarea-shelter:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .form-input-shelter[readonly] {
            background: #f5f5f5;
            cursor: not-allowed;
        }

        .password-toggle-btn {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.3em;
            padding: 5px;
            transition: transform 0.2s ease;
        }

        .password-toggle-btn:hover {
            transform: translateY(-50%) scale(1.2);
        }

        .forgot-password-link {
            background: transparent;
            border: none;
            color: #667eea;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.95em;
            padding: 5px 10px;
            transition: color 0.3s ease;
        }

        .forgot-password-link:hover {
            color: #764ba2;
        }

        .verify-password-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .verify-password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .password-status-success {
            padding: 15px;
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
        }

        .password-status-error {
            padding: 15px;
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
        }

        .change-password-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            margin-top: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(40, 167, 69, 0.3);
        }

        .change-password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .checklist-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }

        .checklist-item-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .checklist-item-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .checklist-item-header {
            font-weight: 700;
            color: #2336a0;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .radio-group-shelter {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .radio-option-shelter {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px 12px;
            border-radius: 10px;
            background: white;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .radio-option-shelter:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .radio-option-shelter input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-left: 8px;
            cursor: pointer;
        }

        .radio-option-shelter input[type="radio"]:checked + .radio-label {
            font-weight: 700;
        }

        .radio-label {
            cursor: pointer;
            font-size: 1em;
        }

        .radio-label.fulfilled {
            color: #28a745;
        }

        .radio-label.unfulfilled {
            color: #dc3545;
        }

        .radio-label.not-inspected {
            color: #6c757d;
        }

        .radio-label.not-applicable {
            color: #ffc107;
        }

        .capture-photo-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .capture-photo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .photos-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .photo-preview-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .photo-preview-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }

        .photo-preview-item .remove-photo-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 1.2em;
            line-height: 1;
            transition: all 0.3s ease;
        }

        .photo-preview-item .remove-photo-btn:hover {
            background: #dc3545;
            transform: scale(1.1);
        }

        .photo-hint {
            margin-top: 15px;
            color: #666;
            font-size: 0.95em;
            text-align: center;
            font-style: italic;
        }

        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.3em;
            box-shadow: 0 6px 20px rgba(40,167,69,0.4);
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(40,167,69,0.5);
        }

        .info-note {
            padding: 20px;
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-radius: 15px;
            border-right: 5px solid #ff9800;
            margin-top: 25px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .info-note > div {
            color: #e65100;
            font-size: 1em;
            line-height: 2;
            font-weight: 500;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .shelter-inspection-header {
                padding: 20px;
            }
            
            .shelter-return-home-btn {
                position: static;
                transform: none;
                margin-bottom: 15px;
                display: block;
            }
            
            .shelter-inspection-title {
                font-size: 1.8em;
            }
            
            .shelter-inspection-subtitle {
                font-size: 1em;
            }
            
            .shelter-inspection-content {
                padding: 20px 15px;
            }
            
            .shelter-details-card,
            .shelter-form-card {
                padding: 20px;
            }
            
            .section-header {
                font-size: 1.4em;
            }
            
            .checklist-container {
                grid-template-columns: 1fr;
            }
            
            .radio-group-shelter {
                grid-template-columns: 1fr;
            }
            
            .submit-btn {
                padding: 15px 40px;
                font-size: 1.1em;
            }
            
            .verify-password-btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="shelter-inspection-fullscreen-modal">
        <!-- Header with Return Button -->
        <div class="shelter-inspection-header">
            <a href="index.html" class="shelter-return-home-btn" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
                â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
            <h1 class="shelter-inspection-title">ğŸ˜ï¸ Ù†Ù…ÙˆØ°Ø¬ ØªÙØªÙŠØ´ Ø§Ù„Ù…Ù„Ø§Ø¬Ø¦</h1>
            <p class="shelter-inspection-subtitle">Shelter Inspection Form</p>
        </div>
        
        <!-- Scrollable Content -->
        <div class="shelter-inspection-content">
            <!-- Success/Error Messages -->
            <div id="successAlert" class="alert alert-success" style="display: none;"></div>
            <div id="errorAlert" class="alert alert-error" style="display: none;"></div>

            <!-- Inspection Details Card -->
            <div class="shelter-details-card">
                <h3 class="section-header">ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø©</h3>
                <div id="shelterInspectionDetails" class="shelter-details-grid">
                    <!-- Will be filled dynamically -->
                </div>
            </div>
            
            <!-- Inspector Authentication Card -->
            <div class="shelter-form-card">
                <h3 class="section-header">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙØªØ´</h3>
                <div class="form-grid">
                    <div class="form-group-shelter">
                        <label class="form-label-shelter">Ø§Ø³Ù… Ø§Ù„Ù…ÙØªØ´</label>
                        <input type="text" id="shelterInspectorUsername" class="form-input-shelter" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙØªØ´" readonly>
                    </div>
                    <div class="form-group-shelter">
                        <label class="form-label-shelter">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <div style="position: relative;">
                            <input type="password" id="shelterInspectorPassword" class="form-input-shelter" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ">
                            <button onclick="togglePasswordVisibility()" class="password-toggle-btn" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">ğŸ‘ï¸</button>
                        </div>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; gap: 15px; flex-wrap: wrap;">
                    <button onclick="verifyPassword()" class="verify-password-btn" title="ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                        âœ… Ø¯Ø®ÙˆÙ„
                    </button>
                    <button onclick="alert('Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø±Ù Ø£Ùˆ Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…')" class="forgot-password-link">
                        ğŸ”‘ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ
                    </button>
                </div>
                <div id="passwordVerificationStatus" style="margin-top: 15px; display: none;"></div>
            </div>
            
            <!-- Detailed Inspection Checklist -->
            <div class="shelter-form-card">
                <h3 class="section-header">âœ… Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</h3>
                <div class="checklist-container">
                    <!-- Cleanliness -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ù„Ø¬Ø£</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cleanliness" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cleanliness" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cleanliness" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cleanliness" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Ventilation -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„ØªÙ‡ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_ventilation" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_ventilation" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_ventilation" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_ventilation" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Lighting -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„ÙƒØ§ÙÙŠØ©</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_lighting" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_lighting" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_lighting" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_lighting" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Food Quality -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¹Ù„Ø§Ù ÙˆØ§Ù„Ø·Ø¹Ø§Ù…</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_food_quality" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_food_quality" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_food_quality" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_food_quality" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Water Availability -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">ØªÙˆÙØ± Ø§Ù„Ù…ÙŠØ§Ù‡ Ø§Ù„Ù†Ø¸ÙŠÙØ©</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_water_availability" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_water_availability" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_water_availability" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_water_availability" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Cage Conditions -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ù‚ÙØ§Øµ ÙˆØ§Ù„Ø­Ø¸Ø§Ø¦Ø±</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cage_conditions" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cage_conditions" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cage_conditions" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_cage_conditions" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Animal Health -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ© Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_animal_health" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_animal_health" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_animal_health" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_animal_health" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Medical Records -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ù…Ø­Ø¯Ø«Ø©</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_medical_records" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_medical_records" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_medical_records" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_medical_records" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Staff Presence -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">ÙˆØ¬ÙˆØ¯ Ø·Ø§Ù‚Ù… Ø¹Ù…Ù„ Ù…Ø¤Ù‡Ù„</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_staff_presence" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_staff_presence" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_staff_presence" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_staff_presence" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Safety Measures -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_safety_measures" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_safety_measures" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_safety_measures" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_safety_measures" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Waste Management -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ÙØ§ÙŠØ§Øª</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_waste_management" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_waste_management" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_waste_management" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_waste_management" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Documentation -->
                    <div class="checklist-item-card">
                        <div class="checklist-item-header">Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„ØªØµØ§Ø±ÙŠØ­</div>
                        <div class="radio-group-shelter">
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_documentation" value="Ù…Ø³ØªÙˆÙÙ‰" required>
                                <span class="radio-label fulfilled">âœ… Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_documentation" value="ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰">
                                <span class="radio-label unfulfilled">âŒ ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_documentation" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´">
                                <span class="radio-label not-inspected">â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´</span>
                            </label>
                            <label class="radio-option-shelter">
                                <input type="radio" name="item_documentation" value="Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚">
                                <span class="radio-label not-applicable">â– Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Additional Notes -->
            <div class="shelter-form-card">
                <h3 class="section-header">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</h3>
                <div class="form-group-shelter">
                    <label class="form-label-shelter">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©</label>
                    <textarea id="shelterNotes" class="form-textarea-shelter" rows="4" placeholder="Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©..."></textarea>
                </div>
                <div class="form-group-shelter">
                    <label class="form-label-shelter">Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ØµÙˆØ¯Ø©</label>
                    <textarea id="shelterViolations" class="form-textarea-shelter" rows="3" placeholder="Ù‚Ù… Ø¨Ø¥Ø¯Ø±Ø§Ø¬ Ø£ÙŠ Ù…Ø®Ø§Ù„ÙØ§Øª ØªÙ… Ø±ØµØ¯Ù‡Ø§..."></textarea>
                </div>
                <div class="form-group-shelter">
                    <label class="form-label-shelter">Ø§Ù„ØªÙˆØµÙŠØ§Øª</label>
                    <textarea id="shelterRecommendations" class="form-textarea-shelter" rows="3" placeholder="Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©..."></textarea>
                </div>
            </div>
            
            <!-- Photo Capture Section -->
            <div class="shelter-form-card">
                <h3 class="section-header">ğŸ“· ØµÙˆØ± Ø§Ù„ØªÙØªÙŠØ´</h3>
                <button onclick="capturePhoto()" class="capture-photo-btn">
                    <span style="font-size: 1.5em;">ğŸ“¸</span>
                    <span>Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</span>
                </button>
                <input type="file" id="shelterPhotoInput" accept="image/*" capture="environment" style="display: none;" onchange="handlePhotoCapture(event)" multiple>
                
                <div id="shelterPhotosPreview" class="photos-preview-grid">
                    <!-- Photos will be displayed here -->
                </div>
                
                <div class="photo-hint">
                    ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙ‚Ø§Ø· Ø¹Ø¯Ø© ØµÙˆØ± Ù„Ù„Ù…Ù„Ø¬Ø£
                </div>
            </div>
            
            <!-- Submit Section -->
            <div class="submit-section">
                <button onclick="submitShelterInspection()" class="submit-btn">
                    ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´
                </button>
                
                <div class="info-note">
                    <div>âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´</div>
                    <div>ğŸ“¸ Ø§Ù„ØµÙˆØ± Ø³ØªÙØ­ÙØ¸ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØªÙŠØ´</div>
                    <div>ğŸ’¾ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let currentInspector = null;
        let shelterInspections = [];
        let inspectors = [];
        let capturedPhotos = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
        
        // Load data from plan-data.json
        async function loadData() {
            try {
                const response = await fetch('./plan-data.json?t=' + Date.now(), {
                    cache: 'no-cache'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Get shelter inspection data
                    if (data.shelterInspectionData) {
                        shelterInspections = data.shelterInspectionData;
                    }
                    
                    // Get inspectors list
                    if (data.inspectionData) {
                        const inspectorSet = new Set();
                        data.inspectionData.forEach(item => {
                            if (item.inspector) {
                                inspectorSet.add(item.inspector);
                            }
                        });
                        inspectors = Array.from(inspectorSet).sort((a, b) => a.localeCompare(b, 'ar'));
                    }
                    
                    // Also add inspectors from shelter data
                    shelterInspections.forEach(item => {
                        if (item.inspectors && Array.isArray(item.inspectors)) {
                            item.inspectors.forEach(inspector => {
                                if (!inspectors.includes(inspector)) {
                                    inspectors.push(inspector);
                                }
                            });
                        }
                    });
                    
                    inspectors.sort((a, b) => a.localeCompare(b, 'ar'));
                    
                    // Show inspection form with first inspector if available
                    if (inspectors.length > 0) {
                        currentInspector = inspectors[0];
                        const today = new Date().toISOString().split('T')[0];
                        
                        // Find the next scheduled inspection for any inspector
                        const upcomingInspections = shelterInspections.filter(item => 
                            item.day >= today
                        ).sort((a, b) => a.day.localeCompare(b.day));
                        
                        if (upcomingInspections.length > 0) {
                            const nextInspection = upcomingInspections[0];
                            showInspectionForm(nextInspection);
                        } else {
                            // No upcoming inspections, show form anyway
                            showInspectionForm({
                                day: today,
                                area: 'Ø§Ù„Ù…Ù„Ø§Ø¬Ù‰Ø¡',
                                shelterName: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                                shift: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                                inspectors: inspectors
                            });
                        }
                    }
                    
                    console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                } else {
                    console.error('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            }
        }
        
        // Show inspection form
        function showInspectionForm(inspectionData) {
            // Fill in inspection details
            const detailsContainer = document.getElementById('shelterInspectionDetails');
            const inspectorsList = inspectionData.inspectors ? 
                (Array.isArray(inspectionData.inspectors) ? inspectionData.inspectors.join('ØŒ ') : inspectionData.inspectors) : 
                (currentInspector || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
            
            detailsContainer.innerHTML = `
                <div><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${inspectionData.day}</div>
                <div><strong>Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©:</strong> ${inspectionData.shift || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</strong> ${inspectionData.area}</div>
                <div><strong>Ø§Ù„Ù…Ù„Ø¬Ø£:</strong> ${inspectionData.shelterName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                <div><strong>Ø§Ù„Ù…ÙØªØ´/Ø§Ù„Ù…ÙØªØ´ÙˆÙ†:</strong> ${inspectorsList}</div>
            `;
            
            // Set inspector username (readonly)
            document.getElementById('shelterInspectorUsername').value = inspectorsList;
        }
        
        // Toggle password visibility
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('shelterInspectorPassword');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
            } else {
                passwordInput.type = 'password';
            }
        }
        
        // Generate default password from username
        function generateDefaultPassword(username) {
            return username.replace(/\s+/g, '').replace(/\./g, '').replace(/ØŒ/g, '');
        }
        
        // Check if password is valid for the given username
        function isValidPassword(password, username) {
            const expectedPassword = generateDefaultPassword(username);
            const passwordData = JSON.parse(localStorage.getItem('inspectorPasswords') || '{}');
            const storedPassword = passwordData[username];
            
            return password === expectedPassword || 
                   password === '12345' || 
                   (storedPassword && password === storedPassword);
        }
        
        // Verify password
        function verifyPassword() {
            const password = document.getElementById('shelterInspectorPassword').value;
            const username = document.getElementById('shelterInspectorUsername').value;
            const statusDiv = document.getElementById('passwordVerificationStatus');
            
            if (!password) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
                statusDiv.style.display = 'block';
                return;
            }
            
            // Validate password using helper function
            if (isValidPassword(password, username)) {
                statusDiv.className = 'password-status-success';
                statusDiv.innerHTML = `
                    âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!<br>
                    <button onclick="showChangePasswordForm()" class="change-password-btn">
                        ğŸ”„ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                    </button>
                `;
                statusDiv.style.display = 'block';
            } else {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                statusDiv.style.display = 'block';
            }
        }
        
        // Show change password form
        function showChangePasswordForm() {
            const statusDiv = document.getElementById('passwordVerificationStatus');
            statusDiv.className = 'password-status-success';
            statusDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</strong>
                </div>
                <div style="margin-bottom: 10px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</label>
                    <input type="password" id="newPassword" class="form-input-shelter" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" style="margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</label>
                    <input type="password" id="confirmNewPassword" class="form-input-shelter" placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
                </div>
                <div style="display: flex; gap: 10px;">
                    <button onclick="changePassword()" class="change-password-btn">
                        ğŸ’¾ Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                    <button onclick="cancelChangePassword()" class="forgot-password-link" style="padding: 10px 20px;">
                        âŒ Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            `;
        }
        
        // Change password
        function changePassword() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;
            const username = document.getElementById('shelterInspectorUsername').value;
            const statusDiv = document.getElementById('passwordVerificationStatus');
            
            if (!newPassword || !confirmPassword) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„';
                statusDiv.style.display = 'block';
                return;
            }
            
            if (newPassword !== confirmPassword) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âŒ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                statusDiv.style.display = 'block';
                return;
            }
            
            // Note: Minimum password length kept at 4 for compatibility with existing system
            if (newPassword.length < 4) {
                statusDiv.className = 'password-status-error';
                statusDiv.innerHTML = 'âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„';
                statusDiv.style.display = 'block';
                return;
            }
            
            // Save new password to localStorage
            // Note: Passwords stored in localStorage for offline functionality
            // In production, consider server-side authentication with proper encryption
            const passwordData = JSON.parse(localStorage.getItem('inspectorPasswords') || '{}');
            passwordData[username] = newPassword;
            localStorage.setItem('inspectorPasswords', JSON.stringify(passwordData));
            
            // Update the password field
            document.getElementById('shelterInspectorPassword').value = newPassword;
            
            // Show success message
            statusDiv.className = 'password-status-success';
            statusDiv.innerHTML = `
                âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!<br>
                <small style="font-size: 0.9em; opacity: 0.9;">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ù†Ø¯ Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´</small>
            `;
            statusDiv.style.display = 'block';
        }
        
        // Cancel change password
        function cancelChangePassword() {
            const statusDiv = document.getElementById('passwordVerificationStatus');
            statusDiv.className = 'password-status-success';
            statusDiv.innerHTML = `
                âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!<br>
                <button onclick="showChangePasswordForm()" class="change-password-btn">
                    ğŸ”„ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                </button>
            `;
        }
        
        // Capture photo
        function capturePhoto() {
            document.getElementById('shelterPhotoInput').click();
        }
        
        // Handle photo capture
        function handlePhotoCapture(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('shelterPhotosPreview');
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const photoData = e.target.result;
                    capturedPhotos.push(photoData);
                    
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-preview-item';
                    photoItem.innerHTML = `
                        <img src="${photoData}" alt="ØµÙˆØ±Ø© Ø§Ù„ØªÙØªÙŠØ´">
                        <button class="remove-photo-btn" onclick="removePhoto(${capturedPhotos.length - 1})">Ã—</button>
                    `;
                    previewContainer.appendChild(photoItem);
                };
                
                reader.readAsDataURL(file);
            }
        }
        
        // Remove photo
        function removePhoto(index) {
            capturedPhotos.splice(index, 1);
            refreshPhotoPreview();
        }
        
        // Refresh photo preview
        function refreshPhotoPreview() {
            const previewContainer = document.getElementById('shelterPhotosPreview');
            previewContainer.innerHTML = '';
            
            capturedPhotos.forEach((photoData, index) => {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-preview-item';
                photoItem.innerHTML = `
                    <img src="${photoData}" alt="ØµÙˆØ±Ø© Ø§Ù„ØªÙØªÙŠØ´">
                    <button class="remove-photo-btn" onclick="removePhoto(${index})">Ã—</button>
                `;
                previewContainer.appendChild(photoItem);
            });
        }
        
        // Submit shelter inspection
        function submitShelterInspection() {
            const password = document.getElementById('shelterInspectorPassword').value;
            const username = document.getElementById('shelterInspectorUsername').value;
            
            if (!password) {
                showError('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }
            
            // Validate password using helper function
            if (!isValidPassword(password, username)) {
                showError('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                return;
            }
            
            // Define item labels for proper display
            const itemLabels = {
                'cleanliness': 'Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ù„Ø¬Ø£',
                'ventilation': 'Ø§Ù„ØªÙ‡ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©',
                'lighting': 'Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„ÙƒØ§ÙÙŠØ©',
                'food_quality': 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¹Ù„Ø§Ù ÙˆØ§Ù„Ø·Ø¹Ø§Ù…',
                'water_availability': 'ØªÙˆÙØ± Ø§Ù„Ù…ÙŠØ§Ù‡ Ø§Ù„Ù†Ø¸ÙŠÙØ©',
                'cage_conditions': 'Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ù‚ÙØ§Øµ ÙˆØ§Ù„Ø­Ø¸Ø§Ø¦Ø±',
                'animal_health': 'Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ© Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª',
                'medical_records': 'Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ù…Ø­Ø¯Ø«Ø©',
                'staff_presence': 'ÙˆØ¬ÙˆØ¯ Ø·Ø§Ù‚Ù… Ø¹Ù…Ù„ Ù…Ø¤Ù‡Ù„',
                'safety_measures': 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†',
                'waste_management': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ÙØ§ÙŠØ§Øª',
                'documentation': 'Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„ØªØµØ§Ø±ÙŠØ­'
            };
            
            // Map status values to internal keys
            const statusMap = {
                'Ù…Ø³ØªÙˆÙÙ‰': 'fulfilled',
                'ØºÙŠØ± Ù…Ø³ØªÙˆÙÙ‰': 'unfulfilled',
                'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙØªÙŠØ´': 'not_inspected',
                'Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚': 'not_applicable'
            };
            
            // Collect inspection data - partial completion is allowed
            // Only filled items are collected, unfilled items are omitted
            const inspectionResults = {};
            const checklistItems = [
                'cleanliness', 'ventilation', 'lighting', 'food_quality',
                'water_availability', 'cage_conditions', 'animal_health',
                'medical_records', 'staff_presence', 'safety_measures',
                'waste_management', 'documentation'
            ];
            
            checklistItems.forEach(item => {
                const selectedRadio = document.querySelector(`input[name="item_${item}"]:checked`);
                if (selectedRadio) {
                    const arabicValue = selectedRadio.value;
                    inspectionResults[item] = {
                        status: statusMap[arabicValue] || 'not_inspected',
                        label: itemLabels[item] || item,
                        value: arabicValue
                    };
                }
            });
            
            const notes = document.getElementById('shelterNotes').value;
            const violations = document.getElementById('shelterViolations').value;
            const recommendations = document.getElementById('shelterRecommendations').value;
            
            // Get inspection details from the display
            const detailsDiv = document.getElementById('shelterInspectionDetails');
            const detailsText = detailsDiv.textContent;
            
            const reportData = {
                inspector: username,
                date: detailsDiv.querySelector('div:nth-child(1)')?.textContent.replace('Ø§Ù„ØªØ§Ø±ÙŠØ®:', '').trim() || new Date().toISOString().split('T')[0],
                shift: detailsDiv.querySelector('div:nth-child(2)')?.textContent.replace('Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©:', '').trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                area: detailsDiv.querySelector('div:nth-child(3)')?.textContent.replace('Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:', '').trim() || 'Ø§Ù„Ù…Ù„Ø§Ø¬Ù‰Ø¡',
                shelter: detailsDiv.querySelector('div:nth-child(4)')?.textContent.replace('Ø§Ù„Ù…Ù„Ø¬Ø£:', '').trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                timestamp: new Date().toISOString(),
                results: inspectionResults,
                notes: notes,
                violations: violations,
                recommendations: recommendations,
                photos: capturedPhotos
            };
            
            // Save to localStorage
            const savedReports = JSON.parse(localStorage.getItem('shelterInspectionReports') || '[]');
            savedReports.push(reportData);
            localStorage.setItem('shelterInspectionReports', JSON.stringify(savedReports));
            
            // Show success message
            showSuccess('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.');
            
            // Reset form after 3 seconds
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
            
            console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙØªÙŠØ´:', reportData);
        }
        
        // Show success message
        function showSuccess(message) {
            const successAlert = document.getElementById('successAlert');
            const errorAlert = document.getElementById('errorAlert');
            
            errorAlert.style.display = 'none';
            successAlert.textContent = message;
            successAlert.style.display = 'block';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Show error message
        function showError(message) {
            const successAlert = document.getElementById('successAlert');
            const errorAlert = document.getElementById('errorAlert');
            
            successAlert.style.display = 'none';
            errorAlert.textContent = message;
            errorAlert.style.display = 'block';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Video Autoplay with Audio Fix</title>
    <style>
        body {
            font-family: 'Cairo', Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            color: #333;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        .test-section h2 {
            color: #667eea;
            margin-top: 0;
            font-size: 1.3em;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            margin: 10px 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }
        button:active {
            transform: translateY(0);
        }
        .log-container {
            background: #2d3748;
            color: #a0aec0;
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 15px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #4a5568;
            padding-left: 10px;
        }
        .log-entry.success { color: #48bb78; border-left-color: #48bb78; }
        .log-entry.error { color: #f56565; border-left-color: #f56565; }
        .log-entry.info { color: #4299e1; border-left-color: #4299e1; }
        .video-container {
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        video {
            width: 100%;
            height: auto;
            display: block;
        }
        .strategy-list {
            list-style: none;
            padding: 0;
        }
        .strategy-list li {
            padding: 10px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        .strategy-list li strong {
            color: #667eea;
        }
        .emoji {
            font-size: 1.5em;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ Ø§Ø®ØªØ¨Ø§Ø± ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ø¹ Ø§Ù„ØµÙˆØª</h1>
        <p class="subtitle">Test Video Autoplay with Audio - PR #719 Fix</p>

        <div class="test-section">
            <h2><span class="emoji">ğŸ“‹</span>ÙˆØµÙ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
            <p>Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØµÙˆØª Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ù†Ù‚Ø± Ø£Ùˆ Ø§Ù„Ù„Ù…Ø³</p>
            <p><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¨Ø¯Ø£ Ø§Ù„ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</p>
        </div>

        <div class="test-section">
            <h2><span class="emoji">ğŸ”§</span>Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©</h2>
            <ul class="strategy-list">
                <li>
                    <strong>Strategy 1:</strong> Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ Ø§Ù„ØµÙˆØª
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÙŠØ­Ø§ÙˆÙ„ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¹ Ø§Ù„ØµÙˆØª Ù…Ø¨Ø§Ø´Ø±Ø©</div>
                </li>
                <li>
                    <strong>Strategy 2:</strong> Ø§Ù„Ø¨Ø¯Ø¡ Ø¨ÙƒØªÙ… Ø§Ù„ØµÙˆØª Ø«Ù… ØªÙØ¹ÙŠÙ„Ù‡ ÙÙˆØ±Ø§Ù‹
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÙŠØ¨Ø¯Ø£ Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…ÙƒØªÙˆÙ…Ø§Ù‹ Ø«Ù… ÙŠÙØ¹Ù„ Ø§Ù„ØµÙˆØª Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„</div>
                </li>
                <li>
                    <strong>Strategy 3:</strong> Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙƒØªÙˆÙ…ØŒ Ø§Ù„Ø¥ÙŠÙ‚Ø§ÙØŒ Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ø¹ Ø§Ù„ØµÙˆØª
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÙŠØ¨Ø¯Ø£ Ù…ÙƒØªÙˆÙ…Ø§Ù‹ØŒ Ø«Ù… ÙŠØ¹ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù…Ø¹ Ø§Ù„ØµÙˆØª</div>
                </li>
                <li>
                    <strong>Strategy 4:</strong> Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙƒØªÙˆÙ… ÙƒØ­Ù„ Ø£Ø®ÙŠØ±
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">Ø¥Ø°Ø§ ÙØ´Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§ØªØŒ ÙŠØ¨Ù‚Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…ÙƒØªÙˆÙ…Ø§Ù‹</div>
                </li>
            </ul>
        </div>

        <div class="test-section">
            <h2><span class="emoji">ğŸ¥</span>Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ</h2>
            <div id="statusMessage" class="status info">
                Ø§Ù†ØªØ¸Ø±... Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...
            </div>
            <div class="video-container">
                <video id="testVideo" style="background: #000;" 
                       autoplay muted playsinline preload="auto">
                    <source src="uae543.mp4" type="video/mp4">
                    Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                </video>
            </div>
            <div>
                <button onclick="testAutoplay()">ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
                <button onclick="manualPlay()">â–¶ï¸ ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ</button>
                <button onclick="toggleMute()">ğŸ”Š ÙƒØªÙ…/ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª</button>
                <button onclick="clearLogs()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</button>
            </div>
        </div>

        <div class="test-section">
            <h2><span class="emoji">ğŸ“Š</span>Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
            <div id="logContainer" class="log-container">
                <div class="log-entry info">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>
            </div>
        </div>

        <div class="test-section">
            <h2><span class="emoji">âœ…</span>Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­</h2>
            <ul style="line-height: 1.8;">
                <li>âœ… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</li>
                <li>âœ… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ØµÙˆØª Ù…ÙØ¹Ù„Ø§Ù‹ (ØºÙŠØ± Ù…ÙƒØªÙˆÙ…)</li>
                <li>âœ… Ù„Ø§ ÙŠØªØ·Ù„Ø¨ Ø£ÙŠ ØªÙØ§Ø¹Ù„ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù†Ù‚Ø± Ø£Ùˆ Ù„Ù…Ø³)</li>
                <li>âœ… ÙŠØ¬Ø¨ Ø£Ù† ØªÙ†Ø¬Ø­ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø£Ø±Ø¨Ø¹Ø©</li>
            </ul>
        </div>
    </div>

    <script>
        const video = document.getElementById('testVideo');
        const statusMessage = document.getElementById('statusMessage');
        const logContainer = document.getElementById('logContainer');

        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString('ar-EG')}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }

        function updateStatus(message, type = 'info') {
            statusMessage.textContent = message;
            statusMessage.className = `status ${type}`;
        }

        // Enhanced four-tier autoplay strategy
        async function attemptAutoplayWithAudio() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...', 'info');
            
            try {
                // Strategy 1: Try direct unmuted playback
                log('Strategy 1: Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ Ø§Ù„ØµÙˆØª...', 'info');
                video.muted = false;
                video.volume = 1.0;
                await video.play();
                log('âœ… Strategy 1 Ù†Ø¬Ø­Øª! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„ØµÙˆØª', 'success');
                updateStatus('âœ… Ù†Ø¬Ø­! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØµÙˆØª (Strategy 1)', 'success');
                return true;
            } catch (err1) {
                log(`âŒ Strategy 1 ÙØ´Ù„Øª: ${err1.message}`, 'error');
                
                try {
                    // Strategy 2: Start muted, then unmute immediately
                    log('Strategy 2: Ø§Ù„Ø¨Ø¯Ø¡ Ù…ÙƒØªÙˆÙ…Ø§Ù‹ Ø«Ù… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª...', 'info');
                    video.muted = true;
                    await video.play();
                    video.muted = false;
                    video.volume = 1.0;
                    log('âœ… Strategy 2 Ù†Ø¬Ø­Øª! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„ØµÙˆØª', 'success');
                    updateStatus('âœ… Ù†Ø¬Ø­! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØµÙˆØª (Strategy 2)', 'success');
                    return true;
                } catch (err2) {
                    log(`âŒ Strategy 2 ÙØ´Ù„Øª: ${err2.message}`, 'error');
                    
                    try {
                        // Strategy 3: Play muted, pause, unmute, then replay
                        log('Strategy 3: Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙƒØªÙˆÙ… Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ø¹ Ø§Ù„ØµÙˆØª...', 'info');
                        video.muted = true;
                        await video.play();
                        video.pause();
                        video.currentTime = 0;
                        video.muted = false;
                        video.volume = 1.0;
                        await video.play();
                        log('âœ… Strategy 3 Ù†Ø¬Ø­Øª! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„ØµÙˆØª', 'success');
                        updateStatus('âœ… Ù†Ø¬Ø­! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØµÙˆØª (Strategy 3)', 'success');
                        return true;
                    } catch (err3) {
                        log(`âŒ Strategy 3 ÙØ´Ù„Øª: ${err3.message}`, 'error');
                        
                        // Strategy 4: Keep playing muted as last resort
                        try {
                            log('Strategy 4: Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙƒØªÙˆÙ… ÙƒØ­Ù„ Ø£Ø®ÙŠØ±...', 'info');
                            video.muted = true;
                            await video.play();
                            log('âš ï¸ Strategy 4 Ù†Ø¬Ø­Øª! Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ Ù…ÙƒØªÙˆÙ…Ø§Ù‹', 'info');
                            updateStatus('âš ï¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ Ù„ÙƒÙ† Ù…ÙƒØªÙˆÙ…Ø§Ù‹ (Strategy 4)', 'warning');
                            return true;
                        } catch (err4) {
                            log(`âŒ Strategy 4 ÙØ´Ù„Øª: ${err4.message}`, 'error');
                            log('âŒ ÙØ´Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª!', 'error');
                            updateStatus('âŒ ÙØ´Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ - Ø¬Ø±Ø¨ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ', 'error');
                            return false;
                        }
                    }
                }
            }
        }

        function testAutoplay() {
            video.pause();
            video.currentTime = 0;
            log('Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...', 'info');
            attemptAutoplayWithAudio();
        }

        function manualPlay() {
            video.muted = false;
            video.volume = 1.0;
            video.play()
                .then(() => {
                    log('âœ… Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù†Ø¬Ø­', 'success');
                    updateStatus('âœ… Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                })
                .catch(err => {
                    log(`âŒ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙØ´Ù„: ${err.message}`, 'error');
                    updateStatus('âŒ ÙØ´Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ', 'error');
                });
        }

        function toggleMute() {
            video.muted = !video.muted;
            log(video.muted ? 'ğŸ”‡ ØªÙ… ÙƒØªÙ… Ø§Ù„ØµÙˆØª' : 'ğŸ”Š ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª', 'info');
        }

        function clearLogs() {
            logContainer.innerHTML = '<div class="log-entry info">ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</div>';
        }

        // Event listeners
        video.addEventListener('play', () => {
            log(`ğŸ¬ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø¯Ø£ Ø§Ù„ØªØ´ØºÙŠÙ„ ${video.muted ? '(Ù…ÙƒØªÙˆÙ…)' : '(Ù…Ø¹ Ø§Ù„ØµÙˆØª)'}`, 'success');
        });

        video.addEventListener('pause', () => {
            log('â¸ï¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…ØªÙˆÙ‚Ù', 'info');
        });

        video.addEventListener('ended', () => {
            log('âœ… Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'success');
            updateStatus('âœ… Ø§Ù†ØªÙ‡Ù‰ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'info');
        });

        video.addEventListener('volumechange', () => {
            log(`ğŸ”Š ØªØºÙŠØ± Ø§Ù„ØµÙˆØª: ${video.muted ? 'Ù…ÙƒØªÙˆÙ…' : `Ù…Ø³ØªÙˆÙ‰ ${Math.round(video.volume * 100)}%`}`, 'info');
        });

        video.addEventListener('loadeddata', () => {
            log('ğŸ“¥ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        });

        // Start autoplay test on page load
        window.addEventListener('load', () => {
            log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© - Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...', 'info');
            setTimeout(() => {
                attemptAutoplayWithAudio();
            }, 500);
        });
    </script>
</body>
</html>

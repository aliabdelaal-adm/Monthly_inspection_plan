<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .test-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 0.9em;
        }
        
        .status-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .status-box.active {
            background: #fff3cd;
            border-color: #ffc107;
        }
        
        .status-box.inactive {
            background: #d4edda;
            border-color: #28a745;
        }
        
        .status-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .status-details {
            color: #666;
            line-height: 1.6;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        button {
            flex: 1;
            min-width: 200px;
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-enable {
            background: #ffc107;
            color: #000;
        }
        
        .btn-disable {
            background: #28a745;
            color: white;
        }
        
        .btn-check {
            background: #007bff;
            color: white;
        }
        
        .btn-toggle-dev {
            background: #6c757d;
            color: white;
        }
        
        .log-box {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .dev-status {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .dev-status.is-dev {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }
        
        .dev-status.not-dev {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }
        
        .note {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ›¡ï¸ Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†</h1>
        <p class="subtitle">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ²Ø§Ù…Ù† Ø¹Ø¨Ø± GitHub Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆØ§Ù„Ù…ØªØµÙØ­Ø§Øª</p>
        
        <div class="dev-status not-dev" id="devStatus">
            Ø§Ù„Ø­Ø§Ù„Ø©: Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ ğŸ‘¤
        </div>
        
        <div class="status-box" id="statusBox">
            <div class="status-title">Ø­Ø§Ù„Ø© ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</div>
            <div class="status-details" id="statusDetails">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
        
        <div class="button-group">
            <button class="btn-toggle-dev" onclick="toggleDevMode()">ğŸ‘¨â€ğŸ’» ØªØ¨Ø¯ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±</button>
            <button class="btn-check" onclick="checkStatus()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
        </div>
        
        <div class="button-group">
            <button class="btn-enable" onclick="enableMaintenance()">ğŸ”’ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</button>
            <button class="btn-disable" onclick="disableMaintenance()">âœ… Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</button>
        </div>
        
        <div class="note">
            <strong>ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</strong>
            <ul style="margin-top: 10px; padding-right: 20px; line-height: 1.8;">
                <li>Ø§ÙØªØ­ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ÙÙŠ Ù…ØªØµÙØ­Ø§Øª/Ø£Ø¬Ù‡Ø²Ø© Ù…Ø®ØªÙ„ÙØ©</li>
                <li>Ù‚Ù… Ø¨ØªØ¨Ø¯ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª</li>
                <li>Ù‚Ù… Ø¨ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø£ÙˆÙ„</li>
                <li>Ø§Ù†ØªØ¸Ø± 10 Ø«ÙˆØ§Ù† Ø£Ùˆ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø¢Ø®Ø±</li>
                <li>ÙŠØ¬Ø¨ Ø£Ù† ØªØ¸Ù‡Ø± Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª</li>
            </ul>
        </div>
        
        <h3 style="margin-top: 30px; margin-bottom: 10px;">ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:</h3>
        <div class="log-box" id="logBox">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...</div>
    </div>

    <script>
        let isDev = false;
        let checkInterval = null;
        
        function log(message) {
            const logBox = document.getElementById('logBox');
            const timestamp = new Date().toLocaleTimeString('ar-EG');
            logBox.textContent += `[${timestamp}] ${message}\n`;
            logBox.scrollTop = logBox.scrollHeight;
            console.log(message);
        }
        
        function updateDevStatus() {
            const statusDiv = document.getElementById('devStatus');
            if (isDev) {
                statusDiv.textContent = 'Ø§Ù„Ø­Ø§Ù„Ø©: Ù…Ø·ÙˆØ± ğŸ‘¨â€ğŸ’» (ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©)';
                statusDiv.classList.remove('not-dev');
                statusDiv.classList.add('is-dev');
            } else {
                statusDiv.textContent = 'Ø§Ù„Ø­Ø§Ù„Ø©: Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ ğŸ‘¤ (Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©)';
                statusDiv.classList.remove('is-dev');
                statusDiv.classList.add('not-dev');
            }
        }
        
        function toggleDevMode() {
            isDev = !isDev;
            updateDevStatus();
            log(isDev ? 'âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±' : 'âš ï¸ ØªÙ… ØªØ¹Ø·ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±');
        }
        
        async function loadMaintenanceStatus() {
            try {
                log('ğŸ“¥ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ù† GitHub...');
                const response = await fetch(`https://raw.githubusercontent.com/aliabdelaal-adm/Monthly_inspection_plan/main/maintenance-status.json?t=${Date.now()}`);
                
                if (!response.ok) {
                    log(`âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© (${response.status})`);
                    return null;
                }
                
                const status = await response.json();
                log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­');
                return status;
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©: ${error.message}`);
                return null;
            }
        }
        
        async function saveMaintenanceStatus(isEnabled, messages = []) {
            if (!isDev) {
                log('âŒ ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ø£ÙˆÙ„Ø§Ù‹');
                alert('âŒ ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ø£ÙˆÙ„Ø§Ù‹');
                return false;
            }
            
            const repo = "aliabdelaal-adm/Monthly_inspection_plan";
            const token = "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";
            
            try {
                log(`ğŸ’¾ Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ø¥Ù„Ù‰ GitHub (${isEnabled ? 'Ù…ÙØ¹Ù‘Ù„' : 'Ù…Ø¹Ø·Ù‘Ù„'})...`);
                
                const status = {
                    isMaintenanceMode: isEnabled,
                    lastUpdated: new Date().toISOString(),
                    updatedBy: "Ø§Ù„Ù…Ø·ÙˆØ± (Ø§Ø®ØªØ¨Ø§Ø±)",
                    messages: messages
                };
                
                // Get current file SHA
                const getResponse = await fetch(`https://api.github.com/repos/${repo}/contents/maintenance-status.json`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    }
                });
                
                let sha = null;
                if (getResponse.ok) {
                    const fileData = await getResponse.json();
                    sha = fileData.sha;
                    log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯');
                } else {
                    log('ğŸ“ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯');
                }
                
                // Create or update the file
                const content = btoa(unescape(encodeURIComponent(JSON.stringify(status, null, 2))));
                const body = {
                    message: isEnabled ? 'ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ (Ø§Ø®ØªØ¨Ø§Ø±)' : 'Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ (Ø§Ø®ØªØ¨Ø§Ø±)',
                    content: content
                };
                
                if (sha) {
                    body.sha = sha;
                }
                
                const updateResponse = await fetch(`https://api.github.com/repos/${repo}/contents/maintenance-status.json`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(body)
                });
                
                if (!updateResponse.ok) {
                    const errorData = await updateResponse.json();
                    log(`âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: ${updateResponse.status} - ${errorData.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`);
                    return false;
                }
                
                log('âœ… ØªÙ… Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­ Ø¹Ù„Ù‰ GitHub');
                log('â³ Ø§Ù†ØªØ¸Ø± 10-30 Ø«Ø§Ù†ÙŠØ© Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ GitHub CDN');
                return true;
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©: ${error.message}`);
                return false;
            }
        }
        
        async function checkStatus() {
            const status = await loadMaintenanceStatus();
            const statusBox = document.getElementById('statusBox');
            const statusDetails = document.getElementById('statusDetails');
            
            if (status) {
                if (status.isMaintenanceMode) {
                    statusBox.classList.remove('inactive');
                    statusBox.classList.add('active');
                    let details = `ğŸ”’ <strong>ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…ÙØ¹Ù‘Ù„</strong><br><br>`;
                    details += `â° Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date(status.lastUpdated).toLocaleString('ar-EG')}<br>`;
                    details += `ğŸ‘¤ ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØ§Ø³Ø·Ø©: ${status.updatedBy}<br><br>`;
                    if (status.messages && status.messages.length > 0) {
                        details += `ğŸ“ <strong>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„:</strong><br>`;
                        details += `<ul style="margin: 5px 0; padding-right: 20px;">`;
                        status.messages.forEach(msg => {
                            details += `<li>${msg}</li>`;
                        });
                        details += `</ul>`;
                    }
                    statusDetails.innerHTML = details;
                    log('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…ÙØ¹Ù‘Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹');
                } else {
                    statusBox.classList.remove('active');
                    statusBox.classList.add('inactive');
                    let details = `âœ… <strong>ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„</strong><br><br>`;
                    details += `â° Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date(status.lastUpdated).toLocaleString('ar-EG')}<br>`;
                    details += `ğŸ‘¤ ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØ§Ø³Ø·Ø©: ${status.updatedBy}`;
                    statusDetails.innerHTML = details;
                    log('âœ… ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹');
                }
            } else {
                statusBox.classList.remove('active', 'inactive');
                statusDetails.innerHTML = 'â“ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©<br>Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø¹Ø¯';
                log('â“ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©');
            }
        }
        
        async function enableMaintenance() {
            const messages = [
                'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…',
                'ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø·ÙˆØ± Ø¨Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¹Ø¯ÙŠÙ„Ø§Øª',
                'Ø´ÙƒØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'
            ];
            
            const success = await saveMaintenanceStatus(true, messages);
            if (success) {
                alert('âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹\n\nØ§Ù†ØªØ¸Ø± 10-30 Ø«Ø§Ù†ÙŠØ© Ø«Ù… Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰');
                await checkStatus();
            } else {
                alert('âŒ ÙØ´Ù„ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©\nØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„');
            }
        }
        
        async function disableMaintenance() {
            const success = await saveMaintenanceStatus(false, []);
            if (success) {
                alert('âœ… ØªÙ… Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹\n\nØ§Ù†ØªØ¸Ø± 10-30 Ø«Ø§Ù†ÙŠØ© Ø«Ù… Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰');
                await checkStatus();
            } else {
                alert('âŒ ÙØ´Ù„ Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©\nØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„');
            }
        }
        
        // Initialize
        log('ğŸš€ ØªÙ… ØªÙ‡ÙŠØ¦Ø© ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±');
        log('ğŸ“ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†');
        updateDevStatus();
        checkStatus();
        
        // Auto-check every 10 seconds
        checkInterval = setInterval(() => {
            log('ğŸ”„ ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø§Ù„Ø©...');
            checkStatus();
        }, 10000);
        
        log('â° ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙØ­Øµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†');
    </script>
</body>
</html>

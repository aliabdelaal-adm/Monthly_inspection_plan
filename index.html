<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>خطة التفتيش الشهرية</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Cairo', Arial, sans-serif; background: #f7f9fc; margin:0;}
        .main-container {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 16px #dadce0;
            padding: 36px 18px 24px 18px;
            max-width: 900px;
            min-width:320px;
            margin: 64px auto 0 auto;
            display: flex; flex-direction: column; align-items: center;
            position: relative;
        }
        .bell-notification {
            position: absolute;
            top: 20px;
            right: 27px;
            z-index: 2;
        }
        .bell-notification .bell {
            font-size:2.2em;
            color:#ffbe27;
            background: #fff;
            border-radius:50%;
            box-shadow:0 2px 7px #e5e7f1;
            padding:4px 12px 0 12px;
            cursor:pointer;
            transition:background 0.2s;
            border:2px solid #ffe9b8;
        }
        .bell-notification .bell:hover {
            background: #fff7e0;
        }
        .last-update-bar {
            position: absolute;
            top: 27px;
            left: 30px;
            font-size:0.94em;
            color:#234085;
            font-weight: normal;
            text-align:left;
            direction:ltr;
            letter-spacing: 0.3px;
            z-index:2;
        }
        .title-bar {
            width:100%;
            display:flex;
            justify-content:center;
            align-items:center;
            margin-top: 18px;
            margin-bottom: 24px;
        }
        .main-title-box {
            background:#234085;
            color:#fff;
            padding:28px 0 28px 0;
            border-radius:14px;
            width: 96%;
            max-width: 600px;
            min-height: 56px;
            font-size:2.12em;
            text-align:center;
            font-weight: bold;
            letter-spacing: 1px;
            margin:0 auto;
            box-shadow:0 2px 14px #e0e2f5;
        }
        .top-controls {width:100%;display:flex;flex-direction:column;align-items:center;gap:14px;margin-bottom:10px;}
        .user-row {display:flex;align-items:center;gap:9px;}
        .user-row label {font-weight:bold;font-size:1.06em;}
        .user-row select {min-width:120px;}
        .plan-table-container {width:100%;margin:18px 0; overflow:visible;}
        .plan-table {width:100%;border-collapse:collapse;border-radius:13px;overflow:visible;box-shadow:0 2px 14px #eee;}
        .plan-table th,.plan-table td {padding:10px 8px;text-align:center;}
        .plan-table th {
            background:#234085;
            color:#fff;
            font-weight:bold;
            font-size:1.12em;
        }
        .plan-table tr:nth-child(even) {background:#f5f7fb;}
        .plan-table td { border-bottom:1px solid #d7dcef; font-size:1em; vertical-align:middle;}
        .inspector-name-cell {
            background: #ffd6ef !important;
            color: #a9004d !important;
            font-weight: bold;
            border-radius:8px;
            box-shadow:0 1px 6px #ffe7f6 inset;
            letter-spacing: 0.5px;
            direction:rtl;
            text-align:right;
        }
        .shops-cell {
            background: #ffd6ef !important;
            color: #a9004d;
            font-weight: bold;
            border-radius:8px;
            box-shadow:0 1px 6px #ffe7f6 inset;
            letter-spacing: 0.5px;
            direction:rtl;
            text-align:right;
        }
        .dropdown-shops-btn {
            background:#234085;
            color:#fff;
            border:none;
            border-radius:6px;
            padding:6px 18px;
            cursor:pointer;
            font-size:0.98em;
            min-width:90px;
        }
        .shops-dropdown-list {
            display:none;
            position:absolute;
            background:#fff;
            border:1px solid #23408577;
            border-radius:9px;
            bottom:100%;
            margin-bottom:8px;
            min-width:130px;
            max-width:220px;
            box-shadow:0 2px 14px #eaeaea;
            z-index:1002;
            text-align:right;
            overflow-y:auto;
            right:0;
            left:auto;
            animation: slideUp .15s;
        }
        @keyframes slideUp {
            from { transform: translateY(40px); opacity:0; }
            to { transform: translateY(0); opacity:1; }
        }
        .shops-dropdown-list ul {
            list-style: none;
            margin:0; padding:7px 5px;
        }
        .shops-dropdown-list ul li {
            padding:3px 0 3px 0;
            border-bottom:1px solid #eee;
            font-size:0.97em;
        }
        .shops-dropdown-list ul li:last-child {border-bottom:none;}
        .shops-dropdown-wrap {position:relative; display:inline-block;}
        .actions-row {
            width:100%;display:flex;justify-content:center;align-items:center;gap:18px;margin:20px 0 18px;
        }
        .save-box, .report-box {display:flex;gap:12px;}
        .save-box button, .report-box button {padding:10px 28px;border-radius:8px;border:none;cursor:pointer;font-size:1em;}
        .pdf-btn {background:#d63384;color:#fff;}
        .excel-btn {background:#198754;color:#fff;}
        .inspector-report-btn {background:#234085;color:#fff;}
        .monthly-report-btn {background:#ff9800;color:#fff;}
        .inspector-report-div {margin:16px 0 0 0;background:#f7f9fc;border-radius:10px;padding:18px 12px;width:100%;color:#234085;font-size:1.1em;box-shadow:0 1px 5px #e2e2e2;}
        .footer {text-align:center;margin-top:22px;color:#234085;font-size:0.85em;}
        .report-table {border-collapse: collapse; width: 100%; margin-top: 8px; background: #fff;}
        .report-table th, .report-table td { border: 1px solid #ccc; padding: 8px; text-align: center;}
        .report-table th {background: #234085; color: #fff;}
        .report-table-caption {text-align:right; font-weight:bold; font-size:1.09em; margin-bottom:8px;}
        @media (max-width:600px) {
            .main-container {padding:10px 1vw 7px 1vw;}
            .main-title-box {font-size:1em;padding:16px 0;}
            .last-update-bar { font-size:0.83em; left:8px; top:10px;}
            .bell-notification { top:10px; right:10px;}
            .plan-table th, .plan-table td {padding:7px 2px;font-size:0.94em;}
            .dropdown-shops-btn {padding:4px 8px;font-size:0.91em;}
            .footer {font-size:0.74em;}
        }
    </style>
<!-- ... باقي الصفحة ... -->
<script>
// ... باقي سكريبت الصفحة (نفس الكود السابق الذي أرسلته لك) ...
</script>
</head>
<body>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø¸Ù‡ÙˆØ± Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³ Ø§Ù„ÙÙˆØ±ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        
        .header h1 {
            color: #2d3561;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #6c757d;
            font-size: 1.1em;
        }
        
        .test-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .test-section h2 {
            color: #2d3561;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .test-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 5px solid #6c757d;
        }
        
        .test-item.passed {
            border-left-color: #28a745;
        }
        
        .test-item.failed {
            border-left-color: #dc3545;
        }
        
        .test-item h3 {
            color: #495057;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-item p {
            color: #6c757d;
            line-height: 1.6;
            margin-top: 5px;
        }
        
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .status.pass {
            background: #d4edda;
            color: #155724;
        }
        
        .status.fail {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status.pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .code-block {
            background: #2d3561;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin-top: 10px;
        }
        
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }
        
        .summary h2 {
            margin-bottom: 15px;
            font-size: 2em;
        }
        
        .summary .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .summary .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 30px;
            border-radius: 10px;
        }
        
        .summary .stat .number {
            font-size: 2.5em;
            font-weight: 700;
            display: block;
        }
        
        .summary .stat .label {
            font-size: 1.1em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”” Ø§Ø®ØªØ¨Ø§Ø± Ø¸Ù‡ÙˆØ± Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³ Ø§Ù„ÙÙˆØ±ÙŠØ©</h1>
            <p>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³ ØªØ¸Ù‡Ø± Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© index.html</p>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</h2>
            <div class="test-item">
                <h3>Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</h3>
                <p>Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³ Ù„Ø§ ØªØ¸Ù‡Ø± Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© index.html Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ«Ù‡Ø§ ÙÙŠ GitHub</p>
                <p><strong>Ø§Ù„Ø³Ø¨Ø¨:</strong> Ø¯Ø§Ù„Ø© detectDataChanges() Ù„Ù… ØªÙƒÙ† ØªØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙŠØ±Ø§Øª Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³</p>
            </div>
            
            <div class="test-item">
                <h3>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚</h3>
                <p>Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙŠØ±Ø§Øª Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø±Ø³ ÙÙŠ Ø¯Ø§Ù„Ø© detectDataChanges()</p>
                <p><strong>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</strong> Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø®Ù„Ø§Ù„ 10 Ø«ÙˆØ§Ù†Ù (ÙØªØ±Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ)</p>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ¸ÙŠÙØ© detectDataChanges()</h2>
            <div id="testResults"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¶Ø§Ù</h2>
            <div class="code-block">
// Check for bell notification changes
if (newData.bellNotes && oldData.bellNotes) {
    const newNotifications = newData.bellNotes.notifications || [];
    const oldNotifications = oldData.bellNotes.notifications || [];
    
    if (newNotifications.length > oldNotifications.length) {
        const diff = newNotifications.length - oldNotifications.length;
        changes.push(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${diff} Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯`);
    } else if (newNotifications.length < oldNotifications.length) {
        const diff = oldNotifications.length - newNotifications.length;
        changes.push(`ØªÙ… Ø­Ø°Ù ${diff} Ø¥Ø´Ø¹Ø§Ø±`);
    } else if (newNotifications.length > 0 && oldNotifications.length > 0) {
        // Check if notification content changed
        const newFirstTimestamp = newNotifications[0].timestamp;
        const oldFirstTimestamp = oldNotifications[0].timestamp;
        
        if (newFirstTimestamp !== oldFirstTimestamp) {
            changes.push('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');
        }
    }
} else if (newData.bellNotes && (!oldData.bellNotes || !oldData.bellNotes.notifications)) {
    // New bell notifications added when there were none before
    const newNotifications = newData.bellNotes.notifications || [];
    if (newNotifications.length > 0) {
        changes.push(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${newNotifications.length} Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯`);
    }
}
            </div>
        </div>

        <div id="summary" class="summary" style="display:none;">
            <h2>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
            <div class="stats">
                <div class="stat">
                    <span class="number" id="passCount">0</span>
                    <span class="label">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø§Ø¬Ø­Ø©</span>
                </div>
                <div class="stat">
                    <span class="number" id="failCount">0</span>
                    <span class="label">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙØ§Ø´Ù„Ø©</span>
                </div>
                <div class="stat">
                    <span class="number" id="totalCount">0</span>
                    <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulate the detectDataChanges function from index.html
        function detectDataChanges(oldData, newData) {
            const changes = [];
            
            if (!oldData || !oldData.inspectionData) {
                return ['Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù…ØªØ§Ø­Ø©'];
            }
            
            try {
                // Check for new inspections
                if (newData.inspectionData && oldData.inspectionData) {
                    const newCount = newData.inspectionData.length;
                    const oldCount = oldData.inspectionData.length;
                    
                    if (newCount > oldCount) {
                        const diff = newCount - oldCount;
                        changes.push(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${diff} ØªÙØªÙŠØ´ Ø¬Ø¯ÙŠØ¯`);
                    } else if (newCount < oldCount) {
                        const diff = oldCount - newCount;
                        changes.push(`ØªÙ… Ø­Ø°Ù ${diff} ØªÙØªÙŠØ´`);
                    }
                }
                
                // Check for bell notification changes (NEW CODE)
                if (newData.bellNotes && oldData.bellNotes) {
                    const newNotifications = newData.bellNotes.notifications || [];
                    const oldNotifications = oldData.bellNotes.notifications || [];
                    
                    if (newNotifications.length > oldNotifications.length) {
                        const diff = newNotifications.length - oldNotifications.length;
                        changes.push(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${diff} Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯`);
                    } else if (newNotifications.length < oldNotifications.length) {
                        const diff = oldNotifications.length - newNotifications.length;
                        changes.push(`ØªÙ… Ø­Ø°Ù ${diff} Ø¥Ø´Ø¹Ø§Ø±`);
                    } else if (newNotifications.length > 0 && oldNotifications.length > 0) {
                        // Check if notification content changed
                        const newFirstTimestamp = newNotifications[0].timestamp;
                        const oldFirstTimestamp = oldNotifications[0].timestamp;
                        
                        if (newFirstTimestamp !== oldFirstTimestamp) {
                            changes.push('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');
                        }
                    }
                } else if (newData.bellNotes && (!oldData.bellNotes || !oldData.bellNotes.notifications)) {
                    // New bell notifications added when there were none before
                    const newNotifications = newData.bellNotes.notifications || [];
                    if (newNotifications.length > 0) {
                        changes.push(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${newNotifications.length} Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯`);
                    }
                }
                
                // If no specific changes detected, just say data updated
                if (changes.length === 0) {
                    changes.push('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
            } catch (e) {
                console.error('Error detecting changes:', e);
                changes.push('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
            
            return changes;
        }

        // Test cases
        const tests = [
            {
                name: 'Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªØ´Ø§Ù Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§Ø­Ø¯',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¯ÙŠÙ…', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '2', text: 'Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯', timestamp: '2025-10-02T00:00:00Z' },
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¯ÙŠÙ…', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© 1 Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯'
            },
            {
                name: 'Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªØ´Ø§Ù Ø¥Ø¶Ø§ÙØ© 3 Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¯ÙŠÙ…', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '4', text: 'Ø¥Ø´Ø¹Ø§Ø± 4', timestamp: '2025-10-04T00:00:00Z' },
                            { id: '3', text: 'Ø¥Ø´Ø¹Ø§Ø± 3', timestamp: '2025-10-03T00:00:00Z' },
                            { id: '2', text: 'Ø¥Ø´Ø¹Ø§Ø± 2', timestamp: '2025-10-02T00:00:00Z' },
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¯ÙŠÙ…', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© 3 Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯'
            },
            {
                name: 'Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªØ´Ø§Ù Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '2', text: 'Ø¥Ø´Ø¹Ø§Ø± 2', timestamp: '2025-10-02T00:00:00Z' },
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± 1', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± 1', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ… Ø­Ø°Ù 1 Ø¥Ø´Ø¹Ø§Ø±'
            },
            {
                name: 'ØªØ­Ø¯ÙŠØ« Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªØ´Ø§Ù ØªØ¹Ø¯ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙˆÙ„',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¯ÙŠÙ…', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± Ù…Ø­Ø¯Ø«', timestamp: '2025-10-02T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª'
            },
            {
                name: 'Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªØ´Ø§Ù Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø³Ø§Ø¨Ù‚Ø§Ù‹',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: []
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '2', text: 'Ø¥Ø´Ø¹Ø§Ø± 2', timestamp: '2025-10-02T00:00:00Z' },
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø± 1', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© 2 Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯'
            },
            {
                name: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª',
                description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø§ÙƒØªØ´Ø§Ù ØªØºÙŠÙŠØ± Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…ØªØ·Ø§Ø¨Ù‚Ø©',
                oldData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø±', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                newData: {
                    inspectionData: [],
                    bellNotes: {
                        notifications: [
                            { id: '1', text: 'Ø¥Ø´Ø¹Ø§Ø±', timestamp: '2025-10-01T00:00:00Z' }
                        ]
                    }
                },
                expectedChange: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
            }
        ];

        // Run tests
        let passCount = 0;
        let failCount = 0;
        const resultsDiv = document.getElementById('testResults');

        tests.forEach((test, index) => {
            const changes = detectDataChanges(test.oldData, test.newData);
            const passed = changes.includes(test.expectedChange);
            
            if (passed) passCount++;
            else failCount++;

            const testDiv = document.createElement('div');
            testDiv.className = `test-item ${passed ? 'passed' : 'failed'}`;
            testDiv.innerHTML = `
                <h3>
                    <span class="status ${passed ? 'pass' : 'fail'}">${passed ? 'âœ“ Ù†Ø¬Ø­' : 'âœ— ÙØ´Ù„'}</span>
                    ${test.name}
                </h3>
                <p><strong>Ø§Ù„ÙˆØµÙ:</strong> ${test.description}</p>
                <p><strong>Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> ${test.expectedChange}</p>
                <p><strong>Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©:</strong> ${changes.join(', ')}</p>
            `;
            resultsDiv.appendChild(testDiv);
        });

        // Update summary
        document.getElementById('passCount').textContent = passCount;
        document.getElementById('failCount').textContent = failCount;
        document.getElementById('totalCount').textContent = tests.length;
        document.getElementById('summary').style.display = 'block';

        // Log results to console
        console.log('Test Results:', {
            passed: passCount,
            failed: failCount,
            total: tests.length,
            success: failCount === 0
        });
    </script>
</body>
</html>

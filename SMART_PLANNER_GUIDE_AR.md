# 🎯 دليل أداة التخطيط الذكية للتفتيش الشهري

## 📋 نظرة عامة

أداة التخطيط الذكية هي حل برمجي متقدم ومبتكر يمكن المطور من:
- ✅ **تحديث فوري ومباشر** على خطة التفتيش الشهرية
- ✅ **توزيع ذكي** للمحلات على المفتشين
- ✅ **فلترة تلقائية** للمحلات حسب الأولوية
- ✅ **منع التكرار** للمحلات في نفس اليوم
- ✅ **فترة انتظار** أسبوع واحد قبل إعادة التفتيش

## 🚀 المميزات الرئيسية

### 1. التحديث الفوري (Real-Time Updates)
- لا حاجة لرفع وتحميل ملفات JSON يدوياً
- التحديثات تتم مباشرة على GitHub من خلال API
- التغييرات تظهر فوراً في الموقع الرئيسي (index.html)

### 2. نظام الأولوية الذكي
الأداة تصنف المحلات حسب:

#### 🔴 أولوية عالية (High Priority)
- المحلات التي لم يتم تفتيشها أبداً
- المحلات التي مر عليها أكثر من 30 يوم منذ آخر تفتيش
- المحلات التي تتطلب نشاطات خاصة (يجب تسجيلها)

#### 🟡 أولوية متوسطة (Medium Priority)
- المحلات التي مر عليها 14-30 يوم منذ آخر تفتيش

#### 🟢 أولوية منخفضة (Low Priority)
- المحلات التي مر عليها أقل من 14 يوم منذ آخر تفتيش

### 3. الفلترة الذكية (Smart Filtering)

الأداة تقوم تلقائياً بفلترة المحلات وتستبعد:

#### ❌ القاعدة الأولى: منع التكرار في نفس اليوم
- لا يمكن جدولة محل لمفتش آخر في نفس اليوم
- يضمن عدم تضارب التفتيشات

#### ❌ القاعدة الثانية: فترة الانتظار (7 أيام)
- لا يمكن لنفس المفتش إعادة تفتيش نفس المحل قبل مرور أسبوع
- يضمن توزيع عادل للمحلات على المفتشين

## 📱 كيفية الاستخدام

### الخطوة 1: تسجيل الدخول
1. افتح الأداة من خلال الموقع الرئيسي: **إدارة خدمات النظام → إدارة البيانات → أداة التخطيط الذكية**
2. أدخل **GitHub Token** الخاص بك
3. اضغط على **تسجيل الدخول**

### الخطوة 2: تحديد بيانات التفتيش
1. اختر **المفتش** من القائمة المنسدلة
2. حدد **التاريخ** المطلوب
3. اختر **المناوبة** (صباحية/مسائية)
4. اختر **المنطقة** المراد تفتيشها

### الخطوة 3: اختيار المحلات
- ستظهر لك قائمة المحلات المتاحة **مرتبة حسب الأولوية**
- كل محل يحتوي على:
  - 🏷️ **شارة الأولوية** (عالية/متوسطة/منخفضة)
  - 📊 **النقاط** (Score)
  - 📝 **السبب** (لماذا هذه الأولوية)
  - 📅 **آخر تفتيش** (التاريخ)

- اضغط على المحلات لاختيارها (يمكن اختيار عدة محلات)
- المحلات المختارة ستظهر في قسم **المحلات المختارة للتفتيش**

### الخطوة 4: معاينة وحفظ
1. راجع **معاينة التفتيش** للتأكد من البيانات
2. اضغط على **حفظ التفتيش فوراً** 💾
3. التفتيش سيُحفظ مباشرة على GitHub
4. التحديثات ستظهر فوراً في index.html

## 📊 الإحصائيات المعروضة

الأداة توفر إحصائيات مباشرة أثناء العمل:

- **إجمالي المحلات**: عدد جميع المحلات في المنطقة المختارة
- **المحلات المتاحة**: عدد المحلات بعد الفلترة الذكية
- **أولوية عالية**: عدد المحلات ذات الأولوية العالية
- **المحلات المختارة**: عدد المحلات التي اخترتها

## 🎨 الواجهة البصرية

### ألوان الأولوية
- 🔴 **أحمر**: حدود يسرى حمراء للمحلات ذات الأولوية العالية
- 🟡 **أصفر**: حدود يسرى صفراء للمحلات ذات الأولوية المتوسطة
- 🟢 **أخضر**: حدود يسرى خضراء للمحلات ذات الأولوية المنخفضة

### التفاعل
- **Hover**: عند التمرير على المحل يتحول اللون ويرتفع قليلاً
- **Selected**: المحلات المختارة تظهر بخلفية خضراء فاتحة

## 🔧 التفاصيل التقنية

### API Integration
- استخدام **GitHub REST API v3**
- التحديثات المباشرة على ملف `plan-data.json`
- التحقق التلقائي من SHA للملف

### خوارزمية الأولوية
```javascript
الأولوية = نقاط التاريخ + نقاط النشاط

نقاط التاريخ:
- لم يتم التفتيش: +100
- > 30 يوم: +80
- 21-30 يوم: +60
- 14-21 يوم: +40
- < 14 يوم: +20

نقاط النشاط:
- يجب تسجيلها: +30
```

### خوارزمية الفلترة
```javascript
محل متاح = !مكرر_في_نفس_اليوم && !تم_تفتيشه_مؤخراً

مكرر_في_نفس_اليوم:
- التحقق من جميع المفتشين في نفس التاريخ

تم_تفتيشه_مؤخراً:
- التحقق من نفس المفتش في آخر 7 أيام
```

## 🔐 الأمان

- ✅ التوكن يُحفظ محلياً في `localStorage`
- ✅ جميع الطلبات مشفرة عبر HTTPS
- ✅ التحقق من الصلاحيات قبل أي عملية حفظ
- ✅ رسائل تأكيد قبل الحفظ النهائي

## 🆘 استكشاف الأخطاء

### المشكلة: لا يتم عرض المحلات
**الحل:**
- تأكد من اختيار المفتش والتاريخ والمنطقة
- تحقق من اتصال الإنترنت
- تأكد من صحة GitHub Token

### المشكلة: جميع المحلات مفلترة
**الحل:**
- قد تكون جميع المحلات مكررة في هذا التاريخ
- جرب تاريخ آخر
- تحقق من التفتيشات السابقة لنفس المفتش

### المشكلة: فشل الحفظ
**الحل:**
- تأكد من صلاحيات GitHub Token (يجب أن يحتوي على `repo` permissions)
- تحقق من صحة البيانات المدخلة
- جرب إعادة تسجيل الدخول

## 📞 الدعم الفني

للمساعدة أو الإبلاغ عن مشاكل:
- 📧 Email: support@example.com
- 💬 GitHub Issues: [فتح مشكلة جديدة](https://github.com/aliabdelaal-adm/Monthly_inspection_plan/issues)

## 🎉 الخلاصة

أداة التخطيط الذكية توفر:
- ⚡ **سرعة**: تحديثات فورية بدون رفع ملفات
- 🎯 **دقة**: فلترة ذكية تمنع الأخطاء
- 🧠 **ذكاء**: ترتيب تلقائي حسب الأولوية
- 💪 **قوة**: تكامل مباشر مع GitHub
- 😊 **سهولة**: واجهة بسيطة وسهلة الاستخدام

---

**تم التطوير بواسطة:** د. علي عبدالعال  
**التاريخ:** أكتوبر 2025  
**الإصدار:** 1.0.0
